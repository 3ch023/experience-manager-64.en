<?xml version="1.1" encoding="UTF-8" standalone="yes"?> 
<html> 
 <head> 
  <meta content="carlino" name="cq:lastModifiedBy" /> 
  <meta content="2019-01-12T17:12:56.361-0500" name="acrolinxDate" /> 
  <meta content="2017-10-31T16:35:20.909-0400" name="firstPublishExternalDate" /> 
  <meta content="mix:versionable" name="jcr:mixinTypes" /> 
  <meta content="/etc/designs/help" name="cq:designPath" /> 
  <meta content="cmajumda@adobe.com" name="lr_lastReplicatedBy" /> 
  <meta content="2759" name="acrolinxWords" /> 
  <meta content="8e0986c9-e532-4c03-8d05-6c9f7326a401" name="jcr:predecessors" /> 
  <meta content="false" name="isReadyForLocalization" /> 
  <meta content="Best practices to determine efficient metrics for estimating the infrastructure and resources required for deploying AEM Assets. " name="seoDescription" /> 
  <meta content="" name="jcr:versionHistory" /> 
  <meta content="161" name="acrolinxSentences" /> 
  <meta content="/apps/help/templates/article-3" name="cq:template" /> 
  <meta content="yellow" name="acrolinxPageStatus" /> 
  <meta content="2018-04-03T08:04:08.401-0400" name="cq:lastReplicated" /> 
  <meta content="admin" name="jcr:createdBy" /> 
  <meta content="asgupta" name="acrolinxLastCheckedBy" /> 
  <meta content="products:SG_EXPERIENCEMANAGER/6.4/ASSETS" name="primaryProductTag" /> 
  <meta content="" name="jcr:primaryType" /> 
  <meta content="carlino" name="cq:lastReplicatedBy" /> 
  <meta content="true" name="jcr:isCheckedOut" /> 
  <meta content="2017-11-22T10:50:09.604-0500" name="lastPublishExternalDate" /> 
  <meta content="/content/help/en/experience-manager/6-4/assets/morehelp/administering;/content/help/en/experience-manager/6-4/assets/morehelp/administering" name="moreHelpPaths" /> 
  <meta content="2017-10-12T21:46:58.665-0400" name="mwpw_migration_script_version" /> 
  <meta content="products:SG_EXPERIENCEMANAGER/6.4/ASSETS;topic_tags:administering;content_type:reference" name="cq:tags" /> 
  <meta content="2018-04-24T11:59:32.162-0400" name="locHandOffDate" /> 
  <meta content="2018-04-24T11:59:32.162-0400" name="cq:lastModified" /> 
  <meta content="http://acrolinx.corp.adobe.com:8031/output/en/assets_sizing_guide_krs_workflow_f3c2f2ccebf6138e_98_report.xml" name="acrolinxReportURL" /> 
  <meta content="Activate" name="cq:lastReplicationAction" /> 
  <meta content="2017-11-22T10:50:09.604-0500" name="topicBrowsingSortDate" /> 
  <meta content="en_us" name="jcr:language" /> 
  <meta content="Assets Sizing Guide" name="seoTitle" /> 
  <meta content="/content/docs/en/aem/6-3/administer/content/assets/best-practices-for-assets/assets-sizing-guide" name="qaNotes" /> 
  <meta content="help/components/pages/article-3" name="sling:resourceType" /> 
  <meta content="Chiradeep Majumdar" name="contentOwner" /> 
  <meta content="2017-11-22T10:50:09.604-0500" name="publishExternalDate" /> 
  <meta content="https://helpx.adobe.com/experience-manager/6-3/assets/using/assets-sizing-guide.html" name="publishExternalURL" /> 
  <meta content="Assets Sizing Guide" name="jcr:title" /> 
  <meta content="709a595a-e483-47fe-a25c-dd0c1bf393de" name="jcr:uuid" /> 
  <meta content="2017-12-01T19:07:12.173-0500" name="jcr:created" /> 
  <meta content="checked_not_improved" name="acrolinxStatus" /> 
  <meta content="2017-10-12T21:46:00.000-0400" name="qaDate" /> 
  <meta content="" name="jcr:baseVersion" /> 
 </head> 
 <body> 
  <p>When sizing the environment for an Adobe Experience Manager (AEM) Assets implementation, it is important to ensure that there are sufficient resources available in terms of disk, CPU, memory, IO, and network throughput. Sizing many of these resources requires an understanding of how many assets are being loaded into the system. If a better metric is not available, you can divide the size of the existing library by the age of the library to find the rate at which assets are created.</p> 
  <h2>Disk</h2> 
  <h3>DataStore</h3> 
  <p>A common mistake made when sizing the required disk space for an Assets implementation is to base the calculations on the size of the raw images to be ingested into the system. By default, AEM creates three renditions in addition to the original image for use in rendering the AEM UI elements. In previous implementations, these renditions have been observed to assume twice the size of the assets that are ingested.</p> 
  <p>Most users define custom renditions in addition to the out-of-the-box renditions. In addition to the renditions, AEM Assets lets you extract sub-assets from common file types, such as InDesign and Illustrator.</p> 
  <p>Finally, AEM’s versioning capabilities store duplicates of the assets in the version history. You can configure the versions to be purged often. However, many users choose to retain versions in the system for a long time, which consumes additional storage space.</p> 
  <p>Considering these factors, you require a methodology to calculate an acceptably accurate storage space to store user assets.</p> 
  <ol> 
   <li><p>Determine the size and number of assets that will be loaded into the system.</p> </li> 
   <li><p>Get a representative sample of the assets to be uploaded into AEM. For instance, if you plan to load PSD, JPG, AI and PDF files into the system, you require multiple sample images of each file format. In addition, these samples should be representative of the different file sizes and complexities of images.</p> </li> 
   <li><p>Define the renditions to be used.</p> </li> 
   <li><p>Create the renditions in AEM using ImageMagick or Adobe’s Creative Cloud applications. In addition to the renditions that the users specify, create out-of-the-box renditions. For users who implement Scene7, you can use the IC binary to generate the PTIFF renditions to be stored in AEM.</p> </li> 
   <li><p>If you plan to use subassets, generate them for the appropriate file types. See online documentation on how to generate subasset pages from InDesign files or PNG/PDF files from Illustrator layers.</p> </li> 
   <li><p>Compare the size of the output images, renditions, and subassets with the original images. It allows you to generate an expected growth factor when the system is loaded. For example, if you generate renditions and subassets with a combined size of 3GB after processing 1GB of assets, the rendition growth factor is 3.</p> </li> 
   <li><p>Determine the maximum time for which asset versions are to be maintained in the system.</p> </li> 
   <li><p>Determine how often existing assets are modified in the system. If AEM is used as a collaboration hub in creative workflows, the amount of changes are high. If only finished assets are uploaded to the system, this number is much lower.</p> </li> 
   <li><p>Determine how many assets are loaded into the system each month. If you are unsure, ascertain the number of assets that are currently available, and divide the number by the age of the oldest asset to calculate an approximate number.</p> </li> 
  </ol> 
  <p>Performing steps 1-9 helps you determine the following:</p> 
  <ul> 
   <li>Raw size of assets to be loaded</li> 
   <li>Number of assets to be loaded</li> 
   <li>Rendition growth factor</li> 
   <li>Number of asset modifications made per month</li> 
   <li>Number of months to maintain asset versions</li> 
   <li>Number of new assets loaded each month</li> 
   <li>Years of growth to allocate space for</li> 
  </ul> 
  <p>You can specify these numbers in the Network Sizing spreadsheet to determine the total space required for your datastore. It is also a useful tool to determine the impact of maintaining asset versions or modifying assets in AEM on disk growth.</p> 
  <p>The example data populated in the tool demonstrates how important it is to perform the steps mentioned. If you size the datastore based solely on the raw images being loaded (1TB), you may have underestimated the repository size by a factor of 15.</p> 
  <div> 
   <p></p> 
   <p><a alt="Disk Sizing Tool.xlsx" href="assets/disk_sizing_tool.xlsx">Get File</a></p> 
  </div> 
  <h3>Shared Datastores</h3> 
  <p>For large datastores, you can implement a shared datastore either through a shared file datastore on a network attached drive or through an S3 datastore. In this case, individual instances need not maintain a copy of the binaries. In addition, a shared datastore facilitates binary-less replication and helps reduce the bandwidth used to replicate assets to publish environments or offloading instances.</p> 
  <h4>Use Cases</h4> 
  <p>The datastore can be shared between a primary and standby author instance to minimize the amount of time that it takes to update the standby instance with changes made in the primary instance. Adobe recommends sharing the datastore between a primary author instance and offload author instances to reduce overheads in workflow offloading. You can also share the datastore between the author and publish instances to minimize the traffic during replication.</p> 
  <h4>Drawbacks</h4> 
  <p>Owing to some pitfalls, sharing a datastore is not recommended in all cases.</p> 
  <h4>Single Point of Failure</h4> 
  <p>Having a shared datastore, introduces a single point of failure in an infrastructure. Consider a scenario where your system has one author and two publish instances, each with their own datastore. If any one of them crashes, the other two still can continue running. However, if the datastore is shared, a single disk failure can take down the entire infrastructure. Therefore, ensure that you maintain a backup of the shared datastore from where you can restored the datastore quickly.</p> 
  <p>Deploying the AWS S3 service for shared datastores is preferred because it significantly reduces the probability of failure compared to normal disk architectures.</p> 
  <h4>Increased Complexity</h4> 
  <p>Shared datastores also increase the complexity of operations, such as garbage collection. Normally, garbage collection for a standalone datastore can be initiated with a single click. However, shared datastores require mark sweep operations on each member that uses the datastore, in addition to running the actual collection on a single node.</p> 
  <p>For AWS operations, implementing a single central location (via S3), rather than building a RAID array of EBS volumes, can significantly offset the complexity and operational risks on the system.</p> 
  <h4>Performance Concerns</h4> 
  <p>A shared datastore requires the binaries to be stored on a network-mounted drive that is shared between all instances. Because these binaries are accessed over a network, the system performance is adversely impacted. You can partially mitigate the impact by using a fast network connection to a fast array of disks. However, this is an expensive proposition. In the case of AWS operations, all disks are remote and require network connectivity. Ephemeral volumes lose data when the instance starts or stops.</p> 
  <h4>Latency</h4> 
  <p>Latency in S3 implementations is introduced by the background writing threads. Backup procedures must take into account this latency and any offloading procedures. The S3 asset may not be present in S3 when an offloading job starts. In addition, Lucene indexes may remain incomplete when making a backup. It applies to any time-sensitive file written to S3 datastore and accessed from another instance.</p> 
  <h3>Node Store/Document Store</h3> 
  <p>It is difficult to arrive at precise sizing figures for a NodeStore or DocumentStore because of the resources consumed by the following:</p> 
  <ul> 
   <li>Asset metadata</li> 
   <li>Asset versions</li> 
   <li>Audit logs</li> 
   <li>Archived and active workflows</li> 
  </ul> 
  <p>Because the binaries are be stored in the datastore, each binary occupies some space. Most repositories are below 100GB in size. However, there may be larger repositories upto 1TB in size. Additionally, to perform offline compaction, you require enough free space on the volume to rewrite the compacted repository alongside the pre-compacted version. A good rule-of-thumb is to size the disk to 1.5 times the size expected for the repository.</p> 
  <p>For the repository, use SSDs or disks with an IOPS level greater than 3Kilobyte. To eliminate chances of IOPS introducing performance bottlenecks, monitor CPU IO Wait levels for early signs of issues.</p>     
  <div> 
   <p></p> 
   <p><a alt="AEM Environment Sizing Tool.xlsx" href="assets/aem_environment_sizingtool.xlsx">Get File</a></p> 
  </div>       
  <h2>Network</h2> 
  <p>AEM Assets has a number of use cases that make network performance more important than on many of our AEM projects. A customer can have a fast server, but if the network connection is not large enough to support the load of the users who are uploading and downloading assets from the system, then it will still appear to be slow. There is a good methodology for determining the choke point in a user's network connection to AEM at <a href="../../assets/using/assets-network-considerations.md">AEM Asset considerations for user experience, instance sizing, workflow evaluation, and network topology</a>.</p> 
  <h2>WebDAV</h2> 
  <p>If you add the AEM Desktop app to the mix, network issues become more severe due to inefficiencies in the WebDAV protocol.</p> 
  <p>To illustrate these inefficiencies, Adobe tested the system performance using WebDAV on OS X. A 3.5MB InDesign file was opened, edited, and the changes saved. The following observations were made:</p> 
  <ul> 
   <li>Total of around 100 HTTP requests were generated to complete the operation</li> 
   <li>The file was uploaded four times over HTTP</li> 
   <li>The file was downloaded once over HTTP</li> 
   <li>The entire operation took 42 seconds to complete</li> 
   <li>A total of 18MB data was transferred</li> 
  </ul> 
  <p>While analyzing the average save time for files over WebDAV, it was found that performance increases dramatically as bandwidth increases up until the 5-10Mbps level. Therefore, Adobe recommends that each user concurrently accessing the system should have at least 10Mbps of upload speed and 5-10Mbps of bandwidth.</p> 
  <p>For more information, see <a href="https://helpx.adobe.com/experience-manager/kb/troubleshooting-companion-app.html">Troubleshooting AEM Desktop app</a>.</p> 
  <h2>Limitations</h2> 
  <p>When sizing an implementation, it is important to keep system limitations in mind. If the proposed implementation exceeds these limitations, employ creative strategies, such as partitioning the assets across multiple Assets implementations.</p> 
  <p>File size is not the only factor that contributes to out of memory (OOM) issues. It also depends on dimensions of the image. You can avoid OOM issues by providing a higher heap size when you start AEM. </p> 
  <p>In addition, you can edit the threshold size property of the <span class="code">com.day.cq.dam.commons.handler.StandardImageHandler</span> component in Configuration Manager to use intermediate temporary file greater than zero.</p> 
  <h2>Maximum Number of Assets</h2> 
  <p>Currently, Adobe has not tested the system for loading greater than 8 million assets. There are limitations both on the number of documents that can exist in an Oak repository and the number of files that can exist in a datastore.</p> 
  <p>While the limit for the number of nodes in a repository has not been determined, assuming each asset generates roughly 30 nodes, putting the 8 million asset test at 240 million nodes from the assets alone. This does not include audit logs, archived workflows, or versions.</p> 
  <p>The limit to the number of files that can exist in a datastore can be 2.1 billion due to filesystem limitations. It is likely that the repository encounters problems due to large number of nodes long before reaching the datastore limit.</p> 
  <p>If the renditions are incorrectly generated, use the Camera Raw library. However, in this case, the longest side of the image should not be greater than 65000 pixels. In addition, the image should not contain more than 512 MP (512 * 1024 * 1024 pixels)'.<i> </i>The size of the asset is inconsequential.</p> 
  <p>It is difficult to accurately estimate the size of the TIFF file supported out-of-the-box (OOTB) with a specific heap for AEM because additional factors, such as pixel size influence processing. It is possible that AEM can process a file of size of 255 MB OOTB, but cannot process a file size of 18 MB bacause the latter comprises of an unusually higher number pixels compared to the former.</p> 
  <h2>Size of Assets</h2> 
  <p>AEM currently lets you upload up to 2 GB of assets at a time. For more information on configuring maximum file upload sizes, see <a href="../../assets/using/managing-assets-touch-ui.md">Managing Assets</a>.</p> 
 </body> 
</html>