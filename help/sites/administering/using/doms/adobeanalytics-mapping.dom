<?xml version="1.1" encoding="UTF-8" standalone="yes"?> 
<html> 
 <head> 
  <meta content="false" name="isReadyForLocalization" /> 
  <meta content="Mapping Component Data with Adobe Analytics Properties" name="jcr:title" /> 
  <meta content="audience:administering" name="primaryAudienceTag" /> 
  <meta content="products:SG_EXPERIENCEMANAGER/6.4/SITES" name="primaryProductTag" /> 
  <meta content="Mapping Component Data with Adobe Analytics Properties" name="seoTitle" /> 
  <meta content="2018-02-21T08:02:35.032-0500" name="jcr:created" /> 
  <meta content="en_us" name="jcr:language" /> 
  <meta content="Mapping Component Data with Adobe Analytics Properties" name="navTitle" /> 
  <meta content="2019-01-28T04:26:48.480-0500" name="cq:lastReplicated" /> 
  <meta content="products:SG_EXPERIENCEMANAGER/6.4/SITES;topic_tags:integration;content_type:reference" name="cq:tags" /> 
  <meta content="Activate" name="cq:lastReplicationAction" /> 
  <meta content="remove-legacypath-6-1" name="jcr:lastModifiedBy" /> 
  <meta content="2019-01-28T04:26:48.389-0500" name="publishExternalDate" /> 
  <meta content="mix:versionable" name="jcr:mixinTypes" /> 
  <meta content="2017-10-31T16:25:54.483-0400" name="firstPublishExternalDate" /> 
  <meta content="/etc/designs/help" name="cq:designPath" /> 
  <meta content="dfe2b558-aaf5-45d4-b227-c40ca8a33285" name="jcr:uuid" /> 
  <meta content="2017-10-12T21:46:58.665-0400" name="qaDate" /> 
  <meta content="User" name="contentOwner" /> 
  <meta content="edb8adad-539d-43a8-bd83-0a5581aedb2f" name="jcr:predecessors" /> 
  <meta content="aheimoz" name="cq:lastModifiedBy" /> 
  <meta content="dist5" name="distType" /> 
  <meta content="" name="jcr:versionHistory" /> 
  <meta content="aheimoz@adobe.com" name="lr_lastReplicatedBy" /> 
  <meta content="Learn how to map component data with SiteCatalyst properties." name="seoDescription" /> 
  <meta content="2018-04-26T10:14:10.224-0400" name="locHandOffDate" /> 
  <meta content="2019-01-28T04:26:48.389-0500" name="topicBrowsingSortDate" /> 
  <meta content="https://helpx.adobe.com/experience-manager/6-4/sites/administering/using/adobeanalytics-mapping.html" name="publishExternalURL" /> 
  <meta content="" name="jcr:baseVersion" /> 
  <meta content="2019-01-28T04:26:48.405-0500" name="cq:lastModified" /> 
  <meta content="admin" name="jcr:createdBy" /> 
  <meta content="help/components/pages/article-3" name="sling:resourceType" /> 
  <meta content="/apps/help/templates/article-3" name="cq:template" /> 
  <meta content="2017-10-12T21:46:58.665-0400" name="mwpw_migration_script_version" /> 
  <meta content="aheimoz" name="cq:lastReplicatedBy" /> 
  <meta content="2019-01-28T04:26:48.389-0500" name="lastPublishExternalDate" /> 
  <meta content="light" name="gnavTheme" /> 
  <meta content="/content/docs/en/aem/6-3/administer/integration/marketing-cloud/sitecatalyst/sc-mapping" name="qaNotes" /> 
  <meta content="" name="jcr:primaryType" /> 
  <meta content="/content/help/en/experience-manager/6-4/sites/administering/morehelp/integration;/content/help/en/experience-manager/6-4/sites/administering/morehelp/integration" name="moreHelpPaths" /> 
  <meta content="true" name="jcr:isCheckedOut" /> 
 </head> 
 <body> 
  <p>Add components to the framework that gather the data to send to Adobe Analytics. Components that are designed to gather analytics data store the data in the appropriate <strong>CQ variable</strong>. When you add such a component to a framework, the framework displays the list of CQ variables so that you can each to the appropriate <strong>Analytics variable</strong>.</p> 
  <img imageRotate="0" src="assets/aa-11.png" /> 
  <p>When the <strong>AEM view</strong> is open the Analytics variables appear in the content finder. </p> 
  <img imageRotate="0" src="assets/aa-12.png" /> 
  <p>You can map the same <strong>Analytics variable</strong> with multiple CQ variables. You can also map multiple Analytics variables with the same <strong>CQ variable</strong>.</p> 
  <img imageRotate="0" src="assets/chlimage_1-194.png" /> 
  <p>The mapped data is sent to Adobe Analytics when the page loads and the following conditions are met:</p> 
  <ul> 
   <li>The page is associated with the framework.</li> 
   <li>The page uses the components that are added to the framework.</li> 
  </ul> 
  <p>Use the following procedure to map CQ component variables with Adobe Analytics report properties.</p> 
  <ol> 
   <li><p>In the <strong>AEM view</strong>, drag a tracking component from sidekick onto the framework. For example, drag the <strong>Page</strong> component component from the <strong>General</strong> category. </p> <img imageRotate="0" src="assets/aa-13.png" /><p>There are several default component groups: <strong>General</strong>, <strong>Commerce</strong>, <strong>Communities</strong>, <strong>Search&amp;Promote</strong>, and <strong>Other</strong>. Your AEM instance may be configured to display different groups and components.<br /> </p> </li> 
   <li><p>To map Adobe Analytics variables with variables that are defined in the component, drag an <strong>Analytics variable</strong> from the content finder onto a field on the tracking component. For example, drag <span class="code">Page Name (pageName)</span> to <span class="code">pagedata.title</span>.</p> <img imageRotate="0" src="assets/aa-14.png" /> 
    <note> 
     <p>The Report Suite ID (RSID) that is selected for the framework determines the Adobe Analytics variables that appear in the content finder.</p> 
    </note></li> 
   <li><p>Repeat the previous two steps for other components and variables.</p> 
    <note> 
     <p>You can map multiple Analytics variables (e.g. <span class="code">props</span>, <span class="code">eVars</span>, <span class="code">events</span>) to the same CQ variable (e.g. <span class="code">pagedata.title</span>)</p> 
    </note> 
    <note> 
     <p>It is highly recommended that:</p> 
     <ul> 
      <li> <span class="code">eVars</span> and <span class="code">props</span> are mapped to CQ variables beginning with either<strong> </strong><span class="code">pagedata.X</span><strong> </strong>or <span class="code">eventdata.X</span> <br /> </li> 
      <li>whereas events should be mapped to variables starting with <span class="code">eventdata.events.X</span></li> 
     </ul> 
    </note></li> 
   <li><p>To make the framework available on the publish instance of your site, open the <strong>Page </strong>tab of sidekick, and click <strong>Activate Framework.</strong></p> </li> 
  </ol> 
  <h3>Mapping Product-Related Variables</h3> 
  <p>AEM uses a convention for naming product-related variables and events that are meant to be mapped to Adobe Analytics product-related properties:</p> 
  <table border="1" cellpadding="1" cellspacing="0" width="100%"> 
   <tbody> 
    <tr> 
     <th>CQ Variable</th> 
     <th>Analytics Variable</th> 
     <th>Description</th> 
    </tr> 
    <tr> 
     <td><span class="code">product.category</span></td> 
     <td><span class="code">product.categor</span>y (conversion variable)</td> 
     <td>The product category.</td> 
    </tr> 
    <tr> 
     <td><span class="code">product.sku</span></td> 
     <td><span class="code">product.sku</span> (conversion variable)</td> 
     <td>The product sku.</td> 
    </tr> 
    <tr> 
     <td><span class="code">product.quantity</span></td> 
     <td><span class="code">product.quantity</span> (conversion variable)</td> 
     <td>The number of products being purchased.</td> 
    </tr> 
    <tr> 
     <td><span class="code">product.price</span></td> 
     <td><span class="code">product.price</span> (conversion variable)</td> 
     <td>The product price.</td> 
    </tr> 
    <tr> 
     <td><span class="code">product.events.<em>eventName</em></span></td> 
     <td>The success event(s) to associate with the product in your report.</td> 
     <td><span class="code">product.events</span> is the prefix for events named <em>eventName.</em></td> 
    </tr> 
    <tr> 
     <td><span class="code">product.evars.<em>eVarName</em></span></td> 
     <td>The conversion variable(s) (<span class="code">eVar</span>) to associate with the product.</td> 
     <td><span class="code">product.evars</span> is the prefix for eVar variables named <em>eVarName.</em></td> 
    </tr> 
   </tbody> 
  </table> 
  <p>Several AEM Commerce components use these variable names.</p> 
  <note> 
   <p>Do not map the Adobe Analytics Products property to a CQ variable. Configuring product-related mappings as described in the table is effectively equivalent to mapping the Products variable. </p> 
  </note> 
  <h3>Checking reports on Adobe Analytics</h3> 
  <ol> 
   <li>Login to the Adobe Analytics website using the same credentials provided to AEM.</li> 
   <li>Make sure the RSID selected is the one used in the previous steps.</li> 
   <li>In <strong>Reports</strong> (on the left side of the page) select <strong>Custom Conversion</strong>, then <strong>Custom Conversion 1-10</strong> and select the variable coresponding to <span class="code">eVar7</span></li> 
   <li>Depending on the version of Adobe Analytics that you are using, you need to wait on average 45 minutes for the report to be updated with the search term used; e.g. aubergine in the example </li> 
  </ol> 
  <h2>Using the Content Finder (cf#) with Adobe Analytics frameworks</h2> 
  <p>Initially, when you open an Adobe Analytics framework the content finder contains predefined Analytics variables under:<br /> </p> 
  <ul> 
   <li>Traffic<span class="code"></span><br /> </li> 
   <li>Conversion<span class="code"></span><br /> </li> 
   <li>Events<span class="code"></span></li> 
  </ul> 
  <p>When an RSID is selected all the variables belonging to that RSID get added to the list.<br /> The <span class="code">cf#</span> is needed in order to map Analytics variables to the CQ variables present on the different tracking components. See Setting Up a Framework for Basic Tracking.</p> 
  <p>Depending on the view selected for the framework, the content finder will be populated by either Analytics variables (in AEM view) or CQ variables (in Analytics view).</p> 
  <p>The list can be manipulated in the following ways:</p> 
  <ol> 
   <li><p>When in <strong>AEM view</strong>, the list can be filtered depending on what variable type is selected using the 3 filter buttons:</p> 
    <ul> 
     <li>If<em> no button</em> is selected, the list shows the full list.</li> 
     <li>If the <strong>Traffic</strong><em> <strong>button</strong></em> is selected, the list will only show the variables belonging to the Traffic section</li> 
     <li>If the <strong>Conversion</strong><em> <strong>button</strong></em> is selected, the list will only show the variables belonging to the Conversion section. </li> 
     <li>If the <strong>Events</strong> button is selected, the list will only show the variables belonging to the Events section.</li> 
    </ul> 
    <note> 
     <p>Only one filter button can be active at once.</p> 
    </note> 
    <note> 
     <p>Search&amp;Promote variables belong to the Conversion section as well.</p> 
    </note> 
    <ol> 
     <li type="disc">The list also has a search feature, which filters the elements according to the text entered in the search field.</li> 
     <li type="disc">If a filter option is activated while searching for elements in the list, the results displayed will be filtered according to the active button as well.</li> 
     <li type="disc">The list can be reloaded at any time using the swirly-arrows button.</li> 
     <li type="disc">If multiple RSIDs are selected on the framework, all variables in the list will be displayed using all labels used within the RSIDs selected.</li> 
    </ol> </li> 
   <li><p>When in Adobe Analytics view, the Content Finder displays all CQ variables belonging to the tracking components dragged in CQ view.</p> 
    <ul> 
     <li>e.g. in case the <strong>Download component </strong>is the <em>only one dragged</em> in CQ view (which has two mappable variables <em>eventdata.downloadLink</em> and <em>eventdata.events.startDownload</em>), the Content Finder wil look like this when switching to Adobe Analytics view:</li> 
    </ul> <img imageRotate="0" src="assets/aa-22.png" /> 
    <ul> 
     <li>The variables can be dragged&amp;dropped onto any Adobe Analytics variable belonging to either one of the 3 variable sections (<strong>Traffic</strong>, <strong>Conversion </strong>and <strong>Events</strong>).</li> 
     <li>When dragging a new tracking component onto the framework in CQ view, the CQ variables belonging to the component get automatically added to the Content Finder(cf#) in Adobe Analytics view.</li> 
    </ul> 
    <note> 
     <p>Only one CQ variable can be mapped to a Adobe Analytics variable at once</p> 
    </note></li> 
  </ol> 
  <h2>Using AEM view and Analytics view</h2> 
  <p>At any given time, users have the option to switch between 2 ways of viewing the Adobe Analytics mappings when on a framework page. The 2 views provide a better overview of the mappings within the framework, from 2 distinct perspectives.</p> 
  <h3>AEM View</h3> 
  <img imageRotate="0" src="assets/aa-23.png" /> 
  <p>Taking the above image as an example, the <strong>AEM view</strong> has the following properties:</p> 
  <ol> 
   <li>This is the default view when the framework opens.</li> 
   <li>Left side: the content finder(cf#) is populated by Adobe Analytics variables based on the RSID(s) selected.</li> 
   <li>Tab headers (<strong>AEM view</strong> and <strong>Analytics view</strong>): use these to switch between the two views.</li> 
   <li><strong>AEM view</strong>:<br /> 
    <ol> 
     <li>If the framework has components that are inherited from its parent, they will be listed here, along with the variables mapped to the components. 
      <ol> 
       <li>Inherited components are locked.</li> 
       <li>To unlock an inherited component, just double-click on the padlock next to the component's name</li> 
       <li>In order to revert the inheritance you must delete the unlocked component; after which it will regain its locked status.</li> 
      </ol> </li> 
     <li><strong>Drag components here to include them in the analytics framework</strong>: Components can be dragged from the Sidekick and dropped here.</li> 
     <li>You can find all of the components that are currently included in the analytics framework: 
      <ol> 
       <li>To add a component drag one from the sidekick's Components tab</li> 
       <li>To delete a component and all of its mappings, select Delete from the component's context menu then accept the deletion on the confirmation dialogue.</li> 
       <li>Keep in mind that a component can only be deleted from the framework it was created in, and cannot be deleted from child frameworks in the traditional sense (they can only be overwritten).</li> 
      </ol> </li> 
    </ol> </li> 
  </ol> 
  <h3>Analytics View</h3> 
  <img imageRotate="0" src="assets/aa-24.png" /> 
  <ol> 
   <li>This view can be accessed by switching to the <strong>Analytics view</strong> tab on the framework. </li> 
   <li>Left side: Content Finder (cf#) populated by CQ variables based on the components dragged onto the framework in CQ view.</li> 
   <li>Tab headers (<strong>AEM view</strong> and <strong>Analytics view</strong>): use these to switch between the two views.</li> 
   <li>The three tables (Traffic, Conversion, Event) list all available Adobe Analytics variables. belonging to the RSID(s) selected. The mappings shown here should be the same as in the AEM view: 
    <ul> 
     <li><strong>Traffic</strong>: 
      <ul> 
       <li>Traffic variable (<span class="code">prop1</span>) mapped to a CQ variable (<span class="code">eventdata.downloadLink</span>)</li> 
       <li>When the component has a Padlock next to it, this means it is inherited from a parent framework and thus cannot be edited</li> 
      </ul> </li> 
     <li><strong>Conversion</strong>: 
      <ul> 
       <li>Conversion variable (<span class="code">eVar1</span>) mapped to a CQ variable (<span class="code">pagedata.title</span>)</li> 
       <li>Conversion variable (<span class="code">eVar3</span>) mapped to a javascript expression added inline by double-clicking on the CQ variable field and entering the code manually</li> 
      </ul> </li> 
     <li><strong>Event</strong>: <br /> 
      <ul> 
       <li>Event variable (<span class="code">event1</span>) mapped to a CQ event (<span class="code">eventdata.events.pageView</span>)</li> 
      </ul> </li> 
    </ul> </li> 
  </ol> 
  <p> </p> 
  <note> 
   <p>The CQ variable column of any table can be filled inline as well, by double-clicking on the field and adding text to it. These fields accept javascript as an input.</p> 
   <ul> 
    <li>e.g. next to <span class="code">prop3</span> you can add<br /> <em><span class="code">'</span></em><span class="code">Adobe:'+pagedata.title+':'+pagedata.sitesection</span><br /> to send the <em>title</em> of a page concatenated with its <em>sitesection</em> using <em>:</em> (colon) and prefixed with <em>Adobe</em> as <span class="code">prop3</span></li> 
   </ul> 
  </note> 
  <note> 
   <p>Only one CQ variable can be mapped to a Adobe Analytics variable at any given time.</p> 
  </note> 
 </body> 
</html>