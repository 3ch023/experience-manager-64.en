<?xml version="1.1" encoding="UTF-8" standalone="yes"?> 
<html> 
 <head> 
  <meta content="MSM Rollout Conflicts" name="jcr:title" /> 
  <meta content="" name="jcr:versionHistory" /> 
  <meta content="Guillaume Carlino" name="contentOwner" /> 
  <meta content="2018-04-03T07:04:56.042-0400" name="publishExternalDate" /> 
  <meta content="en_us" name="jcr:language" /> 
  <meta content="products:SG_EXPERIENCEMANAGER/6.4/SITES" name="primaryProductTag" /> 
  <meta content="2018-04-03T07:04:56.546-0400" name="cq:lastReplicated" /> 
  <meta content="mix:versionable" name="jcr:mixinTypes" /> 
  <meta content="https://helpx.adobe.com/experience-manager/6-4/sites/administering/using/msm-rollout-conflicts.html" name="publishExternalURL" /> 
  <meta content="MSM Rollout Conflicts" name="navTitle" /> 
  <meta content="2018-04-03T07:04:56.042-0400" name="topicBrowsingSortDate" /> 
  <meta content="MSM Rollout Conflicts" name="seoTitle" /> 
  <meta content="/etc/designs/help" name="cq:designPath" /> 
  <meta content="" name="jcr:primaryType" /> 
  <meta content="/content/docs/en/aem/6-3/administer/sites/msm/msm-rollout-conflicts" name="qaNotes" /> 
  <meta content="carlino" name="cq:lastReplicatedBy" /> 
  <meta content="624195ad-f662-46a4-a688-18c0af2f6f57" name="jcr:predecessors" /> 
  <meta content="2018-04-26T10:12:32.575-0400" name="locHandOffDate" /> 
  <meta content="help/components/pages/article-3" name="sling:resourceType" /> 
  <meta content="Activate" name="cq:lastReplicationAction" /> 
  <meta content="Learn how to deal with Multi Site Manager rollout conflicts." name="seoDescription" /> 
  <meta content="true" name="jcr:isCheckedOut" /> 
  <meta content="audience:administering" name="primaryAudienceTag" /> 
  <meta content="2018-04-26T10:12:32.576-0400" name="cq:lastModified" /> 
  <meta content="2017-10-31T16:24:38.648-0400" name="firstPublishExternalDate" /> 
  <meta content="admin" name="jcr:createdBy" /> 
  <meta content="carlino" name="cq:lastModifiedBy" /> 
  <meta content="products:SG_EXPERIENCEMANAGER/6.4/SITES;topic_tags:site-features;content_type:reference" name="cq:tags" /> 
  <meta content="/apps/help/templates/article-3" name="cq:template" /> 
  <meta content="2017-10-12T21:46:58.665-0400" name="qaDate" /> 
  <meta content="" name="jcr:baseVersion" /> 
  <meta content="/content/help/en/experience-manager/6-4/sites/administering/morehelp/site-features;/content/help/en/experience-manager/6-4/sites/administering/morehelp/site-features" name="moreHelpPaths" /> 
  <meta content="false" name="isReadyForLocalization" /> 
  <meta content="3057703d-bd04-48e9-a302-0ea022b5ea40" name="jcr:uuid" /> 
  <meta content="2017-10-12T21:46:58.665-0400" name="mwpw_migration_script_version" /> 
  <meta content="2018-04-03T07:04:56.042-0400" name="lastPublishExternalDate" /> 
  <meta content="carlino@adobe.com" name="lr_lastReplicatedBy" /> 
  <meta content="2017-12-01T19:05:57.456-0500" name="jcr:created" /> 
 </head> 
 <body> 
  <p>Conflicts can occur if new pages with the same page name are created in both the blueprint branch and a dependent live copy branch. </p> 
  <p>Such conflicts need to be handled and resolved upon rollout.</p> 
  <h2>Conflict Handling</h2> 
  <p>When conflicting pages do exist (in the blueprint and live copy branches), MSM allows you to define how (or even if) they should be handled.</p> 
  <p>To ensure that the rollout is not blocked, possible definitions can include:</p> 
  <ul> 
   <li>which page (blueprint or live copy) will have priority during rollout,</li> 
   <li>which pages will be renamed (and how),<br /> </li> 
   <li>how this will affect any published content.<br /> The default behavior of AEM (out-of-the-box) is that published content will not be impacted. So if a page that was manually created in the live copy branch has been published, that content will still be published after the conflict handling and rollout.</li> 
  </ul> 
  <p>In addition to the standard functionality, customized conflict handlers can be added to implement different rules. These can also allow publishing actions as an individual process.</p> 
  <h3>Example Scenario</h3> 
  <p>In the following sections we use the example of a new page <span class="code">b</span>, created in both the blueprint and the live copy branch (created manually), to illustrate the various methods of conflict resolution:</p> 
  <ul> 
   <li>blueprint: <span class="code">/b</span><br /> A master page; with 1 child page, bp-level-1.<br /> </li> 
   <li>live copy: <span class="code">/b</span><br /> A page manually created in the live copy branch; with 1 child page, <span class="code">lc-level-1</span>.<br /> 
    <ul> 
     <li>Activated on publish as <span class="code">/b</span>, together with the child page.</li> 
    </ul> </li> 
  </ul> 
  <table border="1" cellpadding="1" cellspacing="0" height="159" width="533"> 
   <caption>
     Before Rollout 
   </caption> 
   <tbody> 
    <tr> 
     <td width="30%"><strong>blueprint before rollout</strong></td> 
     <td width="30%"><strong>live copy before rollout</strong></td> 
     <td width="40%"><strong>publish before rollout</strong></td> 
    </tr> 
    <tr> 
     <td><span class="code">b</span><br /> <br /> (created in blueprint branch, ready for rollout)<br /> </td> 
     <td><span class="code">b</span><br /> <br /> (manually created in live copy branch)<br /> </td> 
     <td><span class="code">b</span><br /> <br /> (contains the content of the page b that was manually created in the live copy branch)</td> 
    </tr> 
    <tr> 
     <td><code class="code"> /bp-level-1
       <discoiqbr /> 
       <discoiqbr /> 
       <discoiqbr /> 
       <discoiqbr /> </code></td> 
     <td><span class="code"> /lc-level-1</span><br /> <br /> (manually created in live copy branch)<br /> </td> 
     <td><span class="code"> /lc-level-1</span><br /> <br /> (contains the content of the page<br /> child-level-1 that was manually created in the live copy branch)</td> 
    </tr> 
   </tbody> 
  </table> 
  <h2>Rollout Manager and Conflict Handling</h2> 
  <p>The rollout manager allows you to activate or deactivate conflict management.</p> 
  <p>This is done using <a href="../../../sites/deploying/using/configuring-osgi.md">OSGi configuration</a> of <strong>Day CQ WCM Rollout Manager</strong>:</p> 
  <ul> 
   <li><strong>Handle conflict with manually created Pages</strong>:<br /> (<span class="code">rolloutmgr.conflicthandling.enabled</span>)<br /> Set to true if the rollout manager should handle conflicts from a page created in the live copy with a name that exists in the blueprint.</li> 
  </ul> 
  <p>AEM has <a href="#behaviorwhenconflicthandlingdeactivated">predefined behavior when conflict management has been deactivated</a>.<br /> </p> 
  <h2>Conflict Handlers</h2> 
  <p>AEM uses conflict handlers to resolve any page conflicts that exist when rolling out content from a blueprint to a live copy. Renaming pages is one (the usual) method of resolving such conflicts. More than one conflict handler can be operational to allow for a selection of different behaviors.</p> 
  <p>AEM provides:</p> 
  <ul> 
   <li>The <a href="#defaultconflicthandler">default conflict handler</a>: 
    <ul> 
     <li><span class="code">ResourceNameRolloutConflictHandler</span></li> 
    </ul> </li> 
   <li>The possibility to implement a <a href="#customizedhandlers">customized handler</a>.</li> 
   <li>The service ranking mechanism that allows you to set the priority of each individual handler. The service with the highest ranking is used.<br /> </li> 
  </ul> 
  <h3>Default Conflict Handler</h3> 
  <p>The default conflict handler:</p> 
  <ul> 
   <li>Is called <span class="code">ResourceNameRolloutConflictHandler</span><br /> </li> 
   <li>With this handler the blueprint page is given precedence.</li> 
   <li>The service ranking for this handler is set low (<span class="code"></span>i.e. below the default value for the <span class="code">service.ranking</span> property) as the assumption is that customized handlers will need a higher ranking. However, the ranking is not the absolute minimum to ensure flexibility when required.</li> 
  </ul> 
  <p>This conflict handler gives precedence to the blueprint. The live copy page <span class="code">/b</span> is moved (within the live copy branch) to <span class="code">/b_msm_moved</span>.</p> 
  <ul> 
   <li>live copy: <span class="code">/b</span><br /> Is moved (within the live copy) to <span class="code">/b_msm_moved</span>. This acts as a backup and ensures that no content is lost. 
    <ul> 
     <li><span class="code">lc-level-1</span> is not moved.</li> 
    </ul> </li> 
   <li>blueprint: <span class="code">/b</span><br /> Is rolled out to the live copy page <span class="code">/b</span>. 
    <ul> 
     <li><span class="code">bp-level-1</span> is rolled out to the livecopy.<br /> </li> 
    </ul> </li> 
  </ul> 
  <table border="1" cellpadding="1" cellspacing="0" width="700"> 
   <caption>
     After Rollout 
   </caption> 
   <tbody> 
    <tr> 
     <td style="text-align: left;" valign="top"><strong>blueprint after rollout</strong></td> 
     <td colspan="2" style="text-align: left;" valign="top" width="30%"><strong>live copy after rollout</strong><br /> </td> 
     <td style="text-align: left;" valign="top" width="30%"><strong>live copy after rollout</strong><br /> <br /> <br /> </td> 
     <td style="text-align: left;" valign="top" width="30%"><strong>publish after rollout</strong><br /> <br /> </td> 
    </tr> 
    <tr> 
     <td style="text-align: left;" valign="top"><span class="code">b</span></td> 
     <td colspan="2" style="text-align: left;" valign="top"><span class="code">b</span><br /> <br /> (has the content of the blueprint page b that was rolled out)<br /> </td> 
     <td style="text-align: left;" valign="top"><span class="code">b_msm_moved</span><br /> <br /> (has the content of the page b that was manually created in the live copy branch)</td> 
     <td style="text-align: left;" valign="top"><span class="code">b</span><br /> <br /> (no change; contains the content of the original page b that was manually created in the live copy branch and is now called b_msm_moved)<br /> </td> 
    </tr> 
    <tr> 
     <td style="text-align: left;" valign="top"><span class="code"> /bp-level-1</span></td> 
     <td style="text-align: left;" valign="top"><code class="code"> /bp-level-1
       <discoiqbr /> 
       <discoiqbr /> </code></td> 
     <td style="text-align: left;" valign="top"><span class="code"> /lc-level-1</span><br /> <br /> (no change)</td> 
     <td style="text-align: left;" valign="top"><span class="code"> </span></td> 
     <td style="text-align: left;" valign="top"><span class="code"> /lc-level-1</span><br /> <br /> (no change)</td> 
    </tr> 
   </tbody> 
  </table> 
  <h3>Customized Handlers</h3> 
  <p>Customized conflict handlers allow you to implement your own rules. Using the service ranking mechanism you can also define how they interact with other handlers.</p> 
  <p>Customized conflict handlers can:</p> 
  <ul> 
   <li>Be named according to your requirements.<span class="code"></span></li> 
   <li>Be developed/configured according to your requirements; for example, you can develop a handler so that the live copy page is given precedence.</li> 
   <li>Can be designed to be configured using the <a href="../../../sites/deploying/using/configuring-osgi.md">OSGi configuration</a>; in particular the: 
    <ul> 
     <li><strong>Service Ranking</strong>:<br /> Defines the order related to other conflict handlers (<span class="code">service.ranking</span>).<br /> The default value is 0.<br /> </li> 
    </ul> </li> 
  </ul> 
  <h3>Behavior When Conflict Handling Deactivated</h3> 
  <p>If you manually <a href="#rolloutmanagerandconflicthandling">deactivate conflict handling</a> then AEM takes no action on any conflicting pages (non-conflicting pages are rolled out as expected).</p> 
  <note> 
   <p>AEM does not give any indication that conflicts are being ignored as this behavior must be explicitly configured, so it is assumed that it is the required behavior.</p> 
  </note> 
  <p>In this case the live copy effectively takes precedence. The blueprint page <span class="code">/b</span> is not copied and the live copy page <span class="code">/b</span> is left untouched.</p> 
  <ul> 
   <li>blueprint: <span class="code">/b</span><br /> Is not copied at all, but is ignored.</li> 
   <li>live copy: <span class="code">/b</span><br /> Stays the same.</li> 
  </ul> 
  <table border="1" cellpadding="1" cellspacing="0" width="100%"> 
   <caption>
     After Rollout 
   </caption> 
   <tbody> 
    <tr> 
     <td style="text-align: left;" valign="top"><strong>blueprint after rollout</strong></td> 
     <td style="text-align: left;" valign="top" width="40%"><strong>live copy after rollout</strong><br /> <br /> <br /> </td> 
     <td style="text-align: left;" valign="top" width="40%"><strong>publish after rollout</strong><br /> <br /> </td> 
    </tr> 
    <tr> 
     <td style="text-align: left;" valign="top"><span class="code">b</span></td> 
     <td style="text-align: left;" valign="top"><span class="code">b</span><br /> <br /> (no change; has the content of the page b that was manually created in the live copy branch)</td> 
     <td style="text-align: left;" valign="top"><span class="code">b</span><br /> <br /> (no change; contains the content of the page b that was manually created in the live copy branch)<br /> </td> 
    </tr> 
    <tr> 
     <td style="text-align: left;" valign="top"><span class="code"> /bp-level-1</span><br /> </td> 
     <td style="text-align: left;" valign="top"><span class="code"> /lc-level-1</span><br /> <br /> (no change)</td> 
     <td style="text-align: left;" valign="top"><span class="code"> /lc-level-1</span><br /> <br /> (no change)</td> 
    </tr> 
   </tbody> 
  </table> 
  <h3>Service Rankings</h3> 
  <p>The <a href="https://www.osgi.org/">OSGi</a> service ranking can be used to define the priority of individual conflict handlers.</p> 
 </body> 
</html>