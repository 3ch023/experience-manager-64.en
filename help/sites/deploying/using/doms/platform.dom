<?xml version="1.1" encoding="UTF-8" standalone="yes"?>
<html>
 <head>
  <meta content="carlino@adobe.com" name="lr_lastReplicatedBy" />
  <meta content="audience:deploying" name="primaryAudienceTag" />
  <meta content="2018-04-30T03:27:22.536-0400" name="locHandOffDate" />
  <meta content="Introduction to the AEM Platform" name="jcr:title" />
  <meta content="false" name="isReadyForLocalization" />
  <meta content="" name="jcr:versionHistory" />
  <meta content="/apps/help/templates/article-3" name="cq:template" />
  <meta content="true" name="jcr:isCheckedOut" />
  <meta content="products:SG_EXPERIENCEMANAGER/6.4/SITES;topic_tags:platform;content_type:reference" name="cq:tags" />
  <meta content="/content/docs/en/aem/6-3/deploy/platform" name="qaNotes" />
  <meta content="Introduction to the AEM Platform" name="navTitle" />
  <meta content="2018-04-03T08:43:01.428-0400" name="publishExternalDate" />
  <meta content="en_us" name="jcr:language" />
  <meta content="Introduction to the AEM Platform" name="seoTitle" />
  <meta content="/etc/designs/help" name="cq:designPath" />
  <meta content="d9a100ad-6814-4ed4-9b0e-d408405b9337" name="jcr:predecessors" />
  <meta content="carlino" name="cq:lastReplicatedBy" />
  <meta content="2017-10-12T21:46:58.665-0400" name="mwpw_migration_script_version" />
  <meta content="mix:versionable" name="jcr:mixinTypes" />
  <meta content="791159b8-40da-45b0-9fe0-93542fb5e511" name="jcr:uuid" />
  <meta content="2018-04-03T08:43:01.428-0400" name="topicBrowsingSortDate" />
  <meta content="Guillaume Carlino" name="contentOwner" />
  <meta content="products:SG_EXPERIENCEMANAGER/6.4/SITES" name="primaryProductTag" />
  <meta content="2017-10-31T16:17:47.896-0400" name="firstPublishExternalDate" />
  <meta content="This article provides a general overview of the AEM platform and its most important components." name="seoDescription" />
  <meta content="help/components/pages/article-3" name="sling:resourceType" />
  <meta content="2018-04-03T08:43:01.428-0400" name="lastPublishExternalDate" />
  <meta content="/content/docs/en/aem/6-0/deploy/upgrade/introduction-to-oak" name="legacyPath" />
  <meta content="" name="jcr:primaryType" />
  <meta content="https://helpx.adobe.com/experience-manager/6-4/sites/deploying/using/platform.html" name="publishExternalURL" />
  <meta content="" name="jcr:baseVersion" />
  <meta content="2018-04-03T08:43:02.426-0400" name="cq:lastReplicated" />
  <meta content="admin" name="jcr:createdBy" />
  <meta content="Activate" name="cq:lastReplicationAction" />
  <meta content="2018-04-30T03:27:22.537-0400" name="cq:lastModified" />
  <meta content="2018-01-05T19:01:42.436-0500" name="jcr:created" />
  <meta content="/content/help/en/experience-manager/6-4/sites/deploying/morehelp/platform;/content/help/en/experience-manager/6-4/sites/deploying/morehelp/platform" name="moreHelpPaths" />
  <meta content="msm-service" name="cq:lastModifiedBy" />
  <meta content="2017-10-12T21:46:00.000-0400" name="qaDate" />
 </head>
 <body>
  <p>The AEM platform in AEM 6 is based on Apache Jackrabbit Oak.<br /> </p> 
  <p>Apache Jackrabbit Oak is an effort to implement a scalable and performant hierarchical content repository for use as the foundation of modern world-class web sites and other demanding content applications.</p> 
  <p>It is the successor to Jackrabbit 2 and is used by AEM 6 as the default backend for its content repository, CRX.</p> 
  <h2>Design principles and goals</h2>
  <p>Oak implements the <a href="http://www.day.com/day/en/products/jcr/jsr-283.html">JSR-283</a> (JCR 2.0) spec. Its principal design objectives are:</p> 
  <ul> 
   <li>Better support for big repositories</li> 
   <li>Multiple distributed cluster nodes for high availability</li> 
   <li>Better performance</li> 
   <li>Support for many child nodes and Access Control Levels<br /> </li> 
  </ul> 
  <h2>Architecture Concept</h2>
  <img imageRotate="0" src="assets/chlimage_1-84.png" />
  <h4>Storage</h4>
  <p>The purpose of the Storage layer is to:</p> 
  <ul> 
   <li>Implement a tree model</li> 
   <li>Make storage pluggable</li> 
   <li>Provide a clustering mechanism</li> 
  </ul> 
  <h4>Oak Core</h4>
  <p>The Oak Core adds several layers to the storage layer:</p> 
  <ul> 
   <li>Access Level Controls</li> 
   <li>Search and Indexing</li> 
   <li>Observation</li> 
  </ul> 
  <h4>Oak JCR</h4>
  <p>The main objective of the Oak JCR is to transform JCR semantics into tree operations. It is also responsible for:<br /> </p> 
  <ul> 
   <li>Implementing the JCR API</li> 
   <li>Containing commit hooks that implement JCR constraints</li> 
  </ul> 
  <p>In addition, non-Java implementations are now possible and part of the Oak JCR concept.<br /> </p> 
  <h2>Storage overview</h2>
  <p>The Oak storage layer provides an abstraction layer for the actual storage of the content.</p> 
  <p>Currently, there are two storage implementations available in AEM6: <strong>Tar Storage</strong> and <strong>MongoDB Storage</strong>.</p> 
  <h4>Tar Storage</h4>
  <p>The Tar storage uses tar files. It stores the content as various types of records within larger segments. Journals are used to track the latest state of the repository.</p> 
  <p>There are several key design principles it was build around:</p> 
  <ul> 
   <li><strong>Immutable Segments</strong></li> 
  </ul> 
  <p>The content is stored in segments that can be up to 256KiB in size. They are immutable, which makes it easy to cache frequently accessed segments and reduce system errors that may corrupt the repository. </p> 
  <p>Each segment is identified by a unique identifier (UUID) and contains a continuous subset of the content tree. In addition, segments can reference other content. Each segment keeps a list of UUIDs of other referenced segments.<br /> </p> 
  <ul> 
   <li><strong>Locality</strong></li> 
  </ul> 
  <p>Related records like a node and its immediate children are usually stored in the same segment. This makes searching the repository very fast and avoids most cache misses for typical clients that access more than one related node per session.</p> 
  <ul> 
   <li><strong>Compactness</strong></li> 
  </ul> 
  <p>The formatting of records is optimized for size to reduce IO costs and to fit as much content in caches as possible.</p> 
  <h4>Mongo Storage</h4>
  <p>The MongoDB storage leverages MongoDB for sharding and clustering. The repository tree is kept in one MongoDB database where each node is a separate document.</p> 
  <p>It has several particularities:</p> 
  <ul> 
   <li>Revisions</li> 
  </ul> 
  <p>For each update (commit) of the content, a new revision is created. A revision is basically a string that consists of three elements:</p> 
  <ol> 
   <li>A timestamp derived from the system time of the machine it was generated on</li> 
   <li>A counter to distinguish revisions created with the same timestamp</li> 
   <li>The cluster node id where the revision was created</li> 
  </ol> 
  <ul> 
   <li>Branches</li> 
  </ul> 
  <p>Branches are supported, which allows client to stage multiple changes and make them visible with a single merge call.</p> 
  <ul> 
   <li>Previous documents</li> 
  </ul> 
  <p>MongoDB storage adds data to a document with every modification. However, it only deletes data if a cleanup is explicitly triggered. Old data is moved when a certain threshold is met. Previous documents only contain immutable data, which means they only contain committed and merged revisions.</p> 
  <ul> 
   <li>Cluster node metadata</li> 
  </ul> 
  <p>Data about active and inactive cluster nodes is kept in the database in order to facilitate cluster operations.</p> 
  <p> </p> 
  <p>A typical AEM cluster setup with MongoDB storage:</p> 
  <img imageRotate="0" src="assets/chlimage_1-85.png" />
  <h2>What is different from Jackrabbit 2?</h2>
  <p>Because Oak is designed to be backwards compatible with the JCR 1.0 standard, there will be almost no changes on the user level. However, there are some noticeable differences that you need to take into account when setting up an Oak based AEM installation:</p> 
  <p> </p> 
  <ul> 
   <li>Oak does not create indexes automatically. Because of this, custom indexes will need to be created when necessary.<br /> </li> 
   <li>Unlike Jackrabbit 2 where sessions always reflect the latest state of the repository, with Oak a session reflects a stable view of the repository from the time the session was acquired. This is due to the MVCC model on which Oak is based on.</li> 
   <li>Same name siblings (SNS) are not supported in Oak.<br /> </li> 
  </ul> 
  <h2>Other Platform Related Documentation</h2>
  <p>For more information regarding the AEM platform, also check the articles below:</p> 
  <ul> 
   <li><a href="../../../sites/deploying/using/data-store-config.md">Configuring Node Stores and Data Stores in AEM 6</a></li> 
   <li><a href="../../../sites/deploying/using/queries-and-indexing.md">Oak Queries and Indexing</a></li> 
   <li><a href="../../../sites/deploying/using/storage-elements-in-aem-6.md">Storage Elements in AEM 6</a></li> 
   <li><a href="../../../sites/deploying/using/aem-with-mongodb.md">AEM with MongoDB</a><br /> </li> 
  </ul> 
 </body>
</html>