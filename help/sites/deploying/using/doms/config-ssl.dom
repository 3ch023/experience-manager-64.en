<?xml version="1.1" encoding="UTF-8" standalone="yes"?> 
<html> 
 <head> 
  <meta content="remove-legacypath-6-1" name="jcr:lastModifiedBy" /> 
  <meta content="" name="jcr:versionHistory" /> 
  <meta content="dist5" name="distType" /> 
  <meta content="2017-10-31T16:18:13.796-0400" name="firstPublishExternalDate" /> 
  <meta content="carlino" name="cq:lastReplicatedBy" /> 
  <meta content="light" name="gnavTheme" /> 
  <meta content="2018-02-07T08:01:35.441-0500" name="jcr:created" /> 
  <meta content="false" name="isReadyForLocalization" /> 
  <meta content="2017-10-12T21:46:00.000-0400" name="qaDate" /> 
  <meta content="9b9ecb96-e3a4-4a5f-b272-adf20811e013" name="jcr:uuid" /> 
  <meta content="2018-04-03T08:39:48.622-0400" name="publishExternalDate" /> 
  <meta content="Enabling HTTP Over SSL" name="seoTitle" /> 
  <meta content="/content/help/en/experience-manager/6-4/sites/deploying/morehelp/configuring;/content/help/en/experience-manager/6-4/sites/deploying/morehelp/configuring" name="moreHelpPaths" /> 
  <meta content="products:SG_EXPERIENCEMANAGER/6.4/SITES" name="primaryProductTag" /> 
  <meta content="Learn how to enable and configure HTTP over SSL in AEM." name="seoDescription" /> 
  <meta content="" name="jcr:baseVersion" /> 
  <meta content="/apps/help/templates/article-3" name="cq:template" /> 
  <meta content="true" name="noIndex" /> 
  <meta content="en_us" name="jcr:language" /> 
  <meta content="msm-service" name="cq:lastModifiedBy" /> 
  <meta content="Activate" name="cq:lastReplicationAction" /> 
  <meta content="/etc/designs/help" name="cq:designPath" /> 
  <meta content="true" name="jcr:isCheckedOut" /> 
  <meta content="2018-04-03T08:39:48.622-0400" name="lastPublishExternalDate" /> 
  <meta content="products:SG_EXPERIENCEMANAGER/6.4/SITES;content_type:reference" name="cq:tags" /> 
  <meta content="/content/help/en/experience-manager/6-4/sites/administering/using/ssl-by-default" name="redirectTarget" /> 
  <meta content="2018-04-30T03:26:52.735-0400" name="locHandOffDate" /> 
  <meta content="deb0538d-0b34-4497-868f-6d25134b2b63" name="jcr:predecessors" /> 
  <meta content="help/components/pages/article-3" name="sling:resourceType" /> 
  <meta content="audience:deploying" name="primaryAudienceTag" /> 
  <meta content="2018-04-03T08:39:48.622-0400" name="topicBrowsingSortDate" /> 
  <meta content="Enabling HTTP Over SSL" name="jcr:title" /> 
  <meta content="mix:versionable" name="jcr:mixinTypes" /> 
  <meta content="" name="jcr:primaryType" /> 
  <meta content="User" name="contentOwner" /> 
  <meta content="Enabling HTTP Over SSL" name="navTitle" /> 
  <meta content="2018-04-03T08:39:49.803-0400" name="cq:lastReplicated" /> 
  <meta content="https://helpx.adobe.com/experience-manager/6-4/sites/deploying/using/config-ssl.html" name="publishExternalURL" /> 
  <meta content="2017-10-12T21:46:58.665-0400" name="mwpw_migration_script_version" /> 
  <meta content="admin" name="jcr:createdBy" /> 
  <meta content="2018-04-30T03:26:52.736-0400" name="cq:lastModified" /> 
  <meta content="/content/docs/en/aem/6-3/deploy/configuring/config-ssl" name="qaNotes" /> 
  <meta content="carlino@adobe.com" name="lr_lastReplicatedBy" /> 
 </head> 
 <body> 
  <p> </p> 
  <p>Enable HTTP over SSL to employ more secure connections to your servers. Configure the following items in your environment according to the connections that you wish to secure:</p> 
  <ul> 
   <li><strong>Author instance:</strong> Secure client connections to the author instance.</li> 
   <li><strong>Publish instance:</strong> Secure client connections to the publish instance.</li> 
   <li><strong>Replication agents on author:</strong> Secure connections from the author instance to the publish. instance.</li> 
   <li><strong>Web server that hosts Dispatcher:</strong> Secure client connections to the web server (and, indirectly, to the publish instance)</li> 
  </ul> 
  <div>
    For information about connecting replication agents to the publish instance using MSSL, see 
   <a href="../../../sites/deploying/using/mssl-replication.md">Replicating Using Mutual SSL</a>. 
  </div> 
  <h2>Obtain or Create the Credential</h2> 
  <p>Create or obtain the credential that the server uses to sign HTTP messages:</p> 
  <ul> 
   <li>For development environments, a self-signed certificate is adequate. When self-signed certificates are used for SSL, the web browser requires you to manually trust the certificate when opening a web page.</li> 
   <li>For production environments, use a certificate that is signed by a certificate authority (CA). When the public certificate of the CA is imported in the web browser, your certificate is automatically trusted.</li> 
  </ul> 
  <p></p> 
  <h3>Create a Credential for Development</h3> 
  <p>Use the Java keytool to create a self-signed credential and to store it in a keystore file. The following procedure uses a single command that includes all of the information needed to create the keystore. For complete information about the command, see the <a href="http://docs.oracle.com/javase/6/docs/technotes/tools/solaris/keytool.html">Oracle Java SE Documentation</a>.</p> 
  <ol> 
   <li><p>Create a directory named ssl in the directory where the quickstart JAR file is located.</p> </li> 
   <li><p>In the command prompt, type the following command to create the credential and keystore:</p> 
    <codeblock class="syntax shell">
      keytool&amp;nbsp;-genkeypair&amp;nbsp;-keyalg&amp;nbsp;RSA&amp;nbsp;-validity&amp;nbsp;3650&amp;nbsp;-alias&amp;nbsp;cqse&amp;nbsp;-keystore&amp;nbsp;[quickstart_dir]/ssl/keystorename.keystore&amp;nbsp;&amp;nbsp;-keypass&amp;nbsp;key_password&amp;nbsp;-storepass&amp;nbsp;&amp;nbsp;storepassword&amp;nbsp;-dname&amp;nbsp;"CN=Host&amp;nbsp;Name,&amp;nbsp;OU=Group&amp;nbsp;Name,&amp;nbsp;O=Company&amp;nbsp;Name,L=City&amp;nbsp;Name,&amp;nbsp;S=State,&amp;nbsp;C=Country_&amp;nbsp;Code" 
    </codeblock></li> 
  </ol> 
  <p>The following example generates a private/public key pair with the following properties:</p> 
  <ul> 
   <li>alias: cqse</li> 
   <li>keystore file: cqkeystore.keystore</li> 
   <li>key password: password</li> 
   <li>keystore password: password</li> 
  </ul> 
  <codeblock class="syntax shell">
    keytool&amp;nbsp;-genkeypair&amp;nbsp;-keyalg&amp;nbsp;RSA&amp;nbsp;-validity&amp;nbsp;3650&amp;nbsp;-alias&amp;nbsp;cqse&amp;nbsp;-keystore&amp;nbsp;~/Applications/cq5.5/author/ssl/cqkeystore.keystore&amp;nbsp;-keypass&amp;nbsp;password&amp;nbsp;-storepass&amp;nbsp;password&amp;nbsp;-dname&amp;nbsp;"CN=sbroders-w7,&amp;nbsp;OU=CQ,&amp;nbsp;O=Adobe,&amp;nbsp;L=Ottawa,&amp;nbsp;S=Ontario,&amp;nbsp;C=CA" 
  </codeblock> 
  <h3>Obtain a Credential for Use in Production</h3> 
  <p>In production environments you should use a certificate that is signed from a trusted certificate authority (CA). Use the Java keytool to generate a certificate signing request, and when obtained import it to your keystore.</p> 
  <h4>Generate a Certificate Signing Request (CSR)</h4> 
  <ol> 
   <li><p>Use keytool to generate the public/private key pair and add it to a keystore (See <a href="#createacredentialfordevelopment">Create a Credential for Development</a>).</p> </li> 
   <li><p>Type the following command to generate a certificate request:<br /> </p> 
    <codeblock class="syntax shell">
      keytool&amp;nbsp;-certreq&amp;nbsp;-alias&amp;nbsp;"LC&amp;nbsp;Cert"&amp;nbsp;-keystorekeystorename.keystore&amp;nbsp;-file&amp;nbsp;LCcertRequest.csr 
    </codeblock></li> 
   <li><p>When you recieve the signed certificate from the CA, complete the next procedure.</p> </li> 
  </ol> 
  <h4>Use a Credential Obtained from a CA to Enable SSL</h4> 
  <ol> 
   <li><p>In a command prompt, type the following command to import the trusted certificate of the CA into your keystore:</p> 
    <codeblock class="syntax shell">
      keytool&amp;nbsp;-importcert&amp;nbsp;-trustcacerts&amp;nbsp;-file&amp;nbsp;rootcert.pem&amp;nbsp;-keystorekeystorename.keystore&amp;nbsp;-alias&amp;nbsp;root 
    </codeblock><p>You must configure the project and path.</p> </li> 
   <li><p>Type the following command to import your signed credential into the keystore:</p> 
    <codeblock class="syntax shell">
      keytool&amp;nbsp;-importcert&amp;nbsp;-trustcacerts&amp;nbsp;-file&amp;nbsp;CACertificateName.crt&amp;nbsp;-keystore&amp;nbsp;keystorename.keystore 
    </codeblock> 
    <note> 
     <p>In version 6 of Java SE, the <span class="code">-import</span> command is renamed to <span class="code">-importcert</span>. </p> 
    </note></li> 
  </ol> 
  <h2>Enable SSL on the Author Instance</h2> 
  <p>Configure the Apache Felix Jetty-based HTTP service to use SSL, employing your certificate.</p> 
  <ol> 
   <li><p>Open CRXDE Lite and select the <span class="code">/apps</span> folder. Click <strong>Create</strong> &amp;gt; <strong>Create Folder</strong> to create a folder named <span class="code">system</span> (<a href="http://localhost:4502/crx/de">http://localhost:4502/crx/de</a>).</p> </li> 
   <li><p>Below the system folder create a folder named <span class="code">config.author</span>.</p> </li> 
   <li><p>Select the <span class="code">/apps/system/config.author</span> node.</p> </li> 
   <li><p>Click <strong>Create </strong>&amp;gt; <strong>Create Node</strong> and enter the following properties:</p> 
    <ul> 
     <li><strong>Name</strong>: <span class="code">org.apache.felix.http</span></li> 
     <li><strong>Type</strong>: <span class="code">sling:OsgiConfig</span></li> 
    </ul> </li> 
   <li><p>Add properties to the node according to the following table:</p> 
    <table border="1" cellpadding="1" cellspacing="0" width="100%"> 
     <tbody> 
      <tr> 
       <th>Name</th> 
       <th>Type</th> 
       <th>Value</th> 
      </tr> 
      <tr> 
       <td><span class="code">org.apache.felix.https.enable</span></td> 
       <td><span class="code">Boolean</span></td> 
       <td><span class="code">true</span></td> 
      </tr> 
      <tr> 
       <td><span class="code">org.osgi.service.http.port.secure</span></td> 
       <td><span class="code">Long</span></td> 
       <td><span class="code">5433</span></td> 
      </tr> 
      <tr> 
       <td><span class="code">org.apache.felix.https.nio</span></td> 
       <td><span class="code">Boolean</span></td> 
       <td><span class="code">true</span></td> 
      </tr> 
      <tr> 
       <td><span class="code">org.apache.felix.https.keystore</span></td> 
       <td><span class="code">String</span></td> 
       <td><span class="code"><i>[quickstart_dir]</i>/ssl/cqkeystore.keystore</span></td> 
      </tr> 
      <tr> 
       <td><span class="code">org.apache.felix.https.keystore.password</span></td> 
       <td><span class="code">String</span></td> 
       <td>The password.</td> 
      </tr> 
      <tr> 
       <td><span class="code">org.apache.felix.https.keystore.key</span></td> 
       <td><span class="code">String</span></td> 
       <td>alias e.g. <span class="code">cqse</span></td> 
      </tr> 
      <tr> 
       <td><span class="code">org.apache.felix.https.keystore.key.password</span></td> 
       <td><span class="code">String</span></td> 
       <td>The password.</td> 
      </tr> 
      <tr> 
       <td><span class="code">org.apache.felix.https.truststore</span></td> 
       <td>String</td> 
       <td>Path to truststore</td> 
      </tr> 
      <tr> 
       <td><span class="code">org.apache.felix.https.truststore.password</span></td> 
       <td>String</td> 
       <td>Truststore password.</td> 
      </tr> 
      <tr> 
       <td><span class="code">(Optional) org.apache.felix.https.clientcertificate</span></td> 
       <td>String</td> 
       <td>Defaults to none</td> 
      </tr> 
     </tbody> 
    </table> </li> 
   <li><p>Click <strong>Save All</strong>.</p> </li> 
  </ol> 
  <h2>Enable SSL on the Publish Instance</h2> 
  <p></p> 
  <p>Enable HTTP over SSL on the publsih instance to secure connections with web clients and with replication agents. (Secure connections with replication agents also require changes to the agent configurations, which is described in the next section.)</p> 
  <p>Follow the same procedure as for configuring the author instance, with the following differences:</p> 
  <ul> 
   <li>Create the org.apache.felix.http node below /apps/system/config.publish on the publish instance (<a href="http://localhost:4503/crx/de">http://localhost:4503/crx/de</a>).</li> 
   <li>If your author and publish instances are on the same computer, use a different port for the <span class="code">org.osgi.service.http.port.secure </span>property.</li> 
  </ul> 
  <p></p> 
  <p></p> 
  <h2>Configure Replication Agents to Use Secure URLs</h2> 
  <p>If you want content replication to occur using HTTP over SSL, configure replication agents to use the HTTPS protocol and the port that the publish instance uses for SSL.</p> 
  <p>The following procedure configures the publish agent on the author instance. Perform the procedure for all replication agents that you want to communicate over SSL.</p> 
  <ol> 
   <li><p>Open the Tools page (<a href="http://localhost:4502/miscadmin">http://localhost:4502/miscadmin</a>).</p> </li> 
   <li><p>Click the <strong>Tools/Replication/Agents</strong> on author folder.</p> </li> 
   <li><p>In the right-hand frame, right-click <strong>Default Agent </strong>and click <strong>Open</strong>.</p> </li> 
   <li><p>Click <strong>Edit</strong> (below the <strong>Test Connection</strong> link) and then click the <strong>Transport</strong> tab.</p> </li> 
   <li><p>In the URI box, change the URL so that it uses the HTTPS protocol and the port that you configured for SSL on the publish instance.</p> </li> 
   <li><p>If you used a self-signed certificate to enable SSL on publish, select <strong>Enable Relaxed SSL</strong>.</p> </li> 
   <li><p>Click <strong>OK</strong>.</p> </li> 
   <li><p>Click<strong> Test Connection</strong>.</p> </li> 
  </ol> 
  <h2>Forcing the Use of the SSL Port</h2> 
  <p>If you want all users to connect over SSL, redirect traffic to the URL that uses HTTP over SSL.</p> 
  <note> 
   <p>The steps presented below do not force the use of the SSL port for HTTP requests to CRXDE Lite, Package Manager or Content Explorer. The requests going to these administrative consoles do not go through the Sling request pipeline. For these scenarios, you should utilize Dispatcher to redirect the requests by using the Apache Web Server. For further details, see the <a href="https://docs.adobe.com/content/docs/en/dispatcher/disp-install.html#Apache Web Server - Add the Dispatcher Module">Dispatcher</a> and the <a href="https://httpd.apache.org/docs/2.4/rewrite/avoid.html#redirect">official Apache</a> documentation.</p> 
  </note> 
  <p>The following example redirects traffic to <span class="code">localhost:4502</span> to <span class="code">https://localhost:5433</span>. To configure the redirect, create a <span class="code">sling:mapping</span> node. Use a node name that matches requested URL. Add a <span class="code">sling:redirect</span> property to specify the URL for redirection.</p> 
  <ol> 
   <li><p>Open CRXDE Lite in your web browser (<a href="http://localhost:4502/crx/de">http://localhost:4502/crx/de</a>).</p> </li> 
   <li><p>Click the <span class="code">/etc/map/http</span><strong> </strong>folder and click <strong>Create </strong>&amp;gt; <strong>Create Node</strong>:</p> 
    <ul> 
     <li><strong>Name</strong>: <span class="code">localhost.4502</span></li> 
     <li><strong>Type</strong>: <span class="code">sling:mapping</span></li> 
    </ul> </li> 
   <li><p>Create the following property for this node:</p> 
    <ul> 
     <li><strong>Name</strong>: <span class="code">sling:redirect</span></li> 
     <li><strong>Type</strong>: <span class="code">String</span></li> 
     <li><strong>Value</strong>: <span class="code">https://localhost:5433</span></li> 
    </ul> </li> 
   <li><p>Click <strong>Save All</strong>.</p> </li> 
  </ol> 
  <p>Alternatively, you can specify the text for matching the requested URL as a <span class="code">sling:match</span> property (See <a href="http://sling.apache.org/site/mappings-for-resource-resolution.html">Mappings for Resource Resolution</a> in the Apache Sling documentation).</p> 
  <h2>Configuring SSL When Using a Dispatcher</h2> 
  <p>When client requests target a dispatcher before reaching an author or publish instance, decide which requests are transmitted over SSL:</p> 
  <ul> 
   <li>From users to the web server.</li> 
   <li>From the author instance to the dispatcher via the flush replication agent.</li> 
  </ul> 
  <p>This section assumes that you have already installed and configured Dispatcher on your web server (See <a href="https://docs.adobe.com/content/docs/en/dispatcher.html">Dispatcher</a>).</p> 
  <p>For information about configuring Dispatcher to use SSL connections with the publish instance, see <a href="https://docs.adobe.com/content/docs/en/dispatcher/disp-ssl.html">Using SSL with Dispatcher</a>.</p> 
  <h3>Configure the Web Server</h3> 
  <p>Configure the web server to use SSL to secure connections between web clients and the web server. For information about enabling SSL for the web server, see the documentation for your web server.</p> 
  <ul> 
   <li>Apache HTTP Server: <a href="http://httpd.apache.org/docs/2.0/ssl/ssl_howto.html">http://httpd.apache.org/docs/2.0/ssl/ssl_howto.html</a></li> 
   <li>Microsoft IIS: <a href="http://learn.iis.net/page.aspx/144/how-to-set-up-ssl-on-iis/">http://learn.iis.net/page.aspx/144/how-to-set-up-ssl-on-iis/</a></li> 
   <li>Oracle iPlanet Web Server: <a href="http://docs.oracle.com/cd/E19146-01/821-1828/gbthq/index.html">http://docs.oracle.com/cd/E19146-01/821-1828/gbthq/index.html</a></li> 
  </ul> 
  <p>Enabling separate caches for secure and unsecure connection types is beyond the scope of this article. However, you could investigate the following strategies:</p> 
  <ul> 
   <li>Route all SSL connections to a separate Apache web server and Dispatcher on a different subdomain.</li> 
   <li>Use URL redirection rules (for example mod_rewrite directives on Apache) to cache content to different locations below DocumentRoot.</li> 
  </ul> 
  <h3>Send Flush Requests over SSL</h3> 
  <p>If you want to send flush requests to the dispatcher over SSL, configure the Dispatcher Flush replication agent.</p> 
  <p>Follow the procedure in <a href="#configurereplicationagents">Configure Replication Agents</a>, using the SSL port that is confgured for the web server (typically 443).</p> 
 </body> 
</html>