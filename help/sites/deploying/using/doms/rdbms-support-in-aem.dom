<?xml version="1.1" encoding="UTF-8" standalone="yes"?> 
<html> 
 <head> 
  <meta content="/content/help/en/experience-manager/6-4/sites/deploying/morehelp/deploying;/content/help/en/experience-manager/6-4/sites/deploying/morehelp/deploying" name="moreHelpPaths" /> 
  <meta content="RDBMS Support in AEM 6.4" name="jcr:title" /> 
  <meta content="help/components/pages/article-3" name="sling:resourceType" /> 
  <meta content="2018-04-30T03:27:58.850-0400" name="cq:lastModified" /> 
  <meta content="2018-04-05T12:32:40.253-0400" name="lastPublishExternalDate" /> 
  <meta content="2018-04-30T03:27:58.849-0400" name="locHandOffDate" /> 
  <meta content="User" name="contentOwner" /> 
  <meta content="trushton" name="cq:lastReplicatedBy" /> 
  <meta content="Learn about the relational database persistence support in AEM 6.4 and the available configuration options." name="seoDescription" /> 
  <meta content="admin" name="jcr:createdBy" /> 
  <meta content="true" name="jcr:isCheckedOut" /> 
  <meta content="en_us" name="jcr:language" /> 
  <meta content="2017-10-31T16:17:42.923-0400" name="firstPublishExternalDate" /> 
  <meta content="" name="jcr:versionHistory" /> 
  <meta content="2017-10-12T21:46:00.000-0400" name="qaDate" /> 
  <meta content="https://helpx.adobe.com/experience-manager/6-4/sites/deploying/using/rdbms-support-in-aem.html" name="publishExternalURL" /> 
  <meta content="RDBMS Support in AEM 6.4" name="navTitle" /> 
  <meta content="audience:deploying" name="primaryAudienceTag" /> 
  <meta content="/etc/designs/help" name="cq:designPath" /> 
  <meta content="2018-04-05T12:32:40.270-0400" name="cq:lastReplicated" /> 
  <meta content="" name="jcr:baseVersion" /> 
  <meta content="Activate" name="cq:lastReplicationAction" /> 
  <meta content="" name="jcr:primaryType" /> 
  <meta content="false" name="isReadyForLocalization" /> 
  <meta content="a8113ba6-6bdd-4868-850d-40ac32385a4a" name="jcr:predecessors" /> 
  <meta content="trushton" name="cq:lastModifiedBy" /> 
  <meta content="2018-04-05T12:32:40.253-0400" name="topicBrowsingSortDate" /> 
  <meta content="/content/docs/en/aem/6-3/deploy/platform/rdbms-support-in-aem" name="qaNotes" /> 
  <meta content="products:SG_EXPERIENCEMANAGER/6.4/SITES;content_type:reference;topic_tags:deploying" name="cq:tags" /> 
  <meta content="e95fda80-c067-4def-af8e-a30cb62a8e9f" name="jcr:uuid" /> 
  <meta content="2018-04-05T12:32:40.253-0400" name="publishExternalDate" /> 
  <meta content="mix:versionable" name="jcr:mixinTypes" /> 
  <meta content="/apps/help/templates/article-3" name="cq:template" /> 
  <meta content="trushton@adobe.com" name="lr_lastReplicatedBy" /> 
  <meta content="RDBMS Support in AEM 6.4" name="seoTitle" /> 
  <meta content="2017-10-12T21:46:58.665-0400" name="mwpw_migration_script_version" /> 
  <meta content="2018-02-09T08:01:19.226-0500" name="jcr:created" /> 
  <meta content="products:SG_EXPERIENCEMANAGER/6.4/SITES" name="primaryProductTag" /> 
 </head> 
 <body> 
  <h2>Overview</h2> 
  <p>Support for relational database persistence in AEM is implemented using the Document Microkernel. The Document Microkernel is the basis that is also used for implementing MongoDB persistence.</p> 
  <p>It consists of a Java API that is based on the Mongo Java API. An implementation of a BlobStore API is also provided. By default, blobs are stored in the database.</p> 
  <p>For more information on the implementation details, please see the <a href="http://jackrabbit.apache.org/oak/docs/apidocs/org/apache/jackrabbit/oak/plugins/document/rdb/RDBDocumentStore.html">RDBDocumentStore</a> and <a href="http://jackrabbit.apache.org/oak/docs/apidocs/org/apache/jackrabbit/oak/plugins/document/rdb/RDBBlobStore.html">RDBBlobStore</a> documentation.</p> 
  <note> 
   <p>Support for <strong>PostgreSQL 9.4</strong> is also provided, but only for demo purposes. It will not be available for production environments.</p> 
  </note> 
  <h2>Supported Databases</h2> 
  <p>For more information on the level of Relational Database support in AEM, please see the <a href="../../../sites/deploying/using/technical-requirements.md" target="_blank">Technical Requirements page</a>.<br /> </p> 
  <h2>Configuration Steps</h2> 
  <p>The repository is created by configuring the <span class="code">DocumentNodeStoreService</span> OSGi service. It has been extended to support relational database persistence in addition to MongoDB.</p> 
  <p>In order for it to work, a data source needs to be configured with AEM. This is done via the <span class="code">org.apache.sling.datasource.DataSourceFactory.config</span> file. The JDBC drivers for the respective database need to be provided separately as OSGi bundles inside the local configuration.</p> 
  <p>For steps on creating OSGi bundles for JDBC drivers, please see this <a href="https://sling.apache.org/documentation/bundles/datasource-providers.html#convert-driver-jars-to-bundle">documentation</a> on the Apache Sling website.</p> 
  <p>Once the bundles are in place, follow the below steps in order to configure AEM with RDB persistence:</p> 
  <ol> 
   <li><p>Make sure the database daemon is started and that you have an active database for use with AEM. </p> </li> 
   <li><p>Copy the AEM 6.3 jar into the installation directory.</p> </li> 
   <li><p>Create a folder called <span class="code">crx-quickstart\install</span> in the installation directory.</p> </li> 
   <li><p>Configure the document node store by creating a configuration file with the following name in the <span class="code">crx-quickstart\install</span> directory:</p> 
    <ul> 
     <li><span class="code">org.apache.jackrabbit.oak.plugins.document.DocumentNodeStoreService.config</span></li> 
    </ul> </li> 
   <li><p>Configure the data source and the JDBC parameters by creating another configuration file with the following name in the <span class="code">crx-quickstart\install</span> folder:</p> 
    <ul> 
     <li><span class="code">org.apache.sling.datasource.DataSourceFactory-oak.config</span></li> 
    </ul> 
    <note> 
     <p>For detailed information on the data source configuration for each supported database, see <a href="../../../sites/deploying/using/rdbms-support-in-aem.md#main-pars-title-2">Data Source Configuration Options</a>.<br /> </p> 
    </note></li> 
   <li><p>Next, prepare the JDBC OSGi bundles to be used with AEM:</p> 
    <ol> 
     <li>In the <span class="code">crx-quickstart/install</span> folder, create a folder named <span class="code">9</span>.</li> 
     <li>Place the JDBC jar in the new folder.</li> 
    </ol> </li> 
   <li><p>Finally, start AEM with the <span class="code">crx3</span> and <span class="code">crx3rdb</span> runmodes:<br /> </p> 
    <codeblock gutter="true" class="syntax java">
      java&amp;nbsp;-jar&amp;nbsp;quickstart.jar&amp;nbsp;-r&amp;nbsp;crx3,crx3rdb 
    </codeblock></li> 
  </ol> 
  <h2>Data Source Configuration Options</h2> 
  <p>The <span class="code">org.apache.sling.datasource.DataSourceFactory-oak.config</span> OSGi configuration is used to configure the parameters needed for communication between AEM and the database persistence layer.</p> 
  <p>The following configuration options are available:<br /> </p> 
  <ul> 
   <li><span class="code">datasource.name:</span> The data source name. The default is <span class="code">oak</span>.</li> 
   <li><span class="code">url:</span> The URL string of the database that needs to be used with JDBC. Each database type has its own URL string format. For more info, see <a href="../../../sites/deploying/using/rdbms-support-in-aem.md#main-pars-title-4">URL String Formats</a> below.<br /> </li> 
   <li><span class="code">driverClassName:</span> The JDBC driver class name. This will differ depending on the database you want to use and subsequently, the driver that is needed to connect to it. Below are the class names for all the databases supported by AEM:<br /> 
    <ul> 
     <li><span class="code">org.postgresql.Driver</span> for PostgreSQL;</li> 
     <li><span class="code">com.ibm.db2.jcc.DB2Driver</span> for DB2;</li> 
     <li><span class="code">oracle.jdbc.OracleDriver</span> for Oracle;</li> 
     <li><span class="code">com.mysql.jdbc.Driver</span> for MySQL and MariaDB (experimental);</li> 
     <li>c<span class="code">om.microsoft.sqlserver.jdbc.SQLServerDriver</span> for Microsoft SQL Server (experimental).</li> 
    </ul> </li> 
   <li><span class="code">username:</span> The username the database runs under.<br /> </li> 
   <li><span class="code">password:</span> The database password.</li> 
  </ul> 
  <h4>URL String Formats</h4> 
  <p>A different URL string format is used in the data source configuration depending on the database type that needs to be used. Below is a list of formats for the databases that AEM currently supports:</p> 
  <ul> 
   <li><span class="code">jdbc:postgresql:databasename</span> for PostgreSQL;<br /> </li> 
   <li><span class="code">jdbc:db2://localhost:port/databasename</span> for DB2;</li> 
   <li><span class="code">jdbc:oracle:thin:localhost:port:SID</span> for Oracle;</li> 
   <li><span class="code">jdbc:mysql://localhost:3306/databasename</span> for MySQL and MariaDB (experimental);<br /> </li> 
   <li><span class="code">jdbc:sqlserver://localhost:1453;databaseName=name</span> for Microsoft SQL Server (experimental).</li> 
  </ul> 
  <h2>Known Limitations</h2> 
  <p>While concurrent use of multiple AEM instances with a single database is supported by RDBMS persistence, concurrent installations are not.</p> 
  <p>In order work around this, make sure you run the installation with a single member first, and add the other ones after the first has finished installing.<br /> </p> 
  <p> </p> 
 </body> 
</html>