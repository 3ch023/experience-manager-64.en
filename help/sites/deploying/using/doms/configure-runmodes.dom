<?xml version="1.1" encoding="UTF-8" standalone="yes"?> 
<html> 
 <head> 
  <meta content="2017-10-12T21:46:00.000-0400" name="qaDate" /> 
  <meta content="2018-04-03T08:40:26.884-0400" name="cq:lastReplicated" /> 
  <meta content="mix:versionable" name="jcr:mixinTypes" /> 
  <meta content="audience:deploying" name="primaryAudienceTag" /> 
  <meta content="2018-04-03T08:40:25.509-0400" name="lastPublishExternalDate" /> 
  <meta content="d18d156f-5281-4178-ad34-b077476e636e" name="jcr:uuid" /> 
  <meta content="remove-legacypath-6-1" name="jcr:lastModifiedBy" /> 
  <meta content="carlino@adobe.com" name="lr_lastReplicatedBy" /> 
  <meta content="/content/help/en/experience-manager/6-4/sites/deploying/morehelp/configuring;/content/help/en/experience-manager/6-4/sites/deploying/morehelp/configuring" name="moreHelpPaths" /> 
  <meta content="2018-04-03T08:40:25.509-0400" name="publishExternalDate" /> 
  <meta content="/etc/designs/help" name="cq:designPath" /> 
  <meta content="carlino" name="cq:lastReplicatedBy" /> 
  <meta content="b60d0fbd-9f44-4d00-9324-2c29831947c3" name="jcr:predecessors" /> 
  <meta content="" name="jcr:baseVersion" /> 
  <meta content="Run Modes" name="navTitle" /> 
  <meta content="https://helpx.adobe.com/experience-manager/6-4/sites/deploying/using/configure-runmodes.html" name="publishExternalURL" /> 
  <meta content="2018-04-03T08:40:25.509-0400" name="topicBrowsingSortDate" /> 
  <meta content="User" name="contentOwner" /> 
  <meta content="2018-04-30T03:29:07.970-0400" name="cq:lastModified" /> 
  <meta content="2017-10-31T16:18:13.334-0400" name="firstPublishExternalDate" /> 
  <meta content="true" name="jcr:isCheckedOut" /> 
  <meta content="Run Modes" name="jcr:title" /> 
  <meta content="Activate" name="cq:lastReplicationAction" /> 
  <meta content="Run Modes" name="seoTitle" /> 
  <meta content="en_us" name="jcr:language" /> 
  <meta content="2017-12-01T19:05:21.369-0500" name="jcr:created" /> 
  <meta content="false" name="isReadyForLocalization" /> 
  <meta content="2017-10-12T21:46:58.665-0400" name="mwpw_migration_script_version" /> 
  <meta content="help/components/pages/article-3" name="sling:resourceType" /> 
  <meta content="/content/docs/en/aem/6-3/deploy/configuring/configure-runmodes" name="qaNotes" /> 
  <meta content="carlino" name="cq:lastModifiedBy" /> 
  <meta content="Learn how to tune your AEM instance for specific purposes by using run modes." name="seoDescription" /> 
  <meta content="products:SG_EXPERIENCEMANAGER/6.4/SITES;topic_tags:configuring;content_type:reference" name="cq:tags" /> 
  <meta content="products:SG_EXPERIENCEMANAGER/6.4/SITES" name="primaryProductTag" /> 
  <meta content="2018-04-30T03:29:07.969-0400" name="locHandOffDate" /> 
  <meta content="admin" name="jcr:createdBy" /> 
  <meta content="" name="jcr:primaryType" /> 
  <meta content="" name="jcr:versionHistory" /> 
  <meta content="/apps/help/templates/article-3" name="cq:template" /> 
 </head> 
 <body> 
  <p>Run modes allow you to tune your AEM instance for a specific purpose; for example author or publish, test, development, intranet or others.</p> 
  <p>You can:</p> 
  <ul> 
   <li><a href="#definingconfigurationpropertiesforarunmode">Define collections of configuration parameters for each run mode</a>.<br /> A basic set of configuration parameters is applied for all run modes, you can then tune additional sets to the purpose of your specific environment. These are applied as required.</li> 
   <li><a href="#definingadditionalbundlestobeinstalledforarunmode">Define additional bundles to be installed for a particular mode</a>.</li> 
  </ul> 
  <p>All settings and definitions are stored in the one repository and activated by setting the <strong>Run Mode</strong>.<br /> </p> 
  <h3>Installation Run Modes</h3> 
  <p>Installation (or fixed) run modes are used at installation time and then fixed for the entire lifetime of the instance, they cannot be changed.<br /> </p> 
  <p>Installation run modes are provided out-of-the-box:</p> 
  <ul> 
   <li><span class="code">author</span></li> 
   <li><span class="code">publish</span></li> 
  </ul> 
  <ul> 
   <li><span class="code">samplecontent</span></li> 
   <li><span class="code">nosamplecontent</span></li> 
  </ul> 
  <p>These are two pairs of mutually exclusive run modes; for example, you can:</p> 
  <ul> 
   <li>define either <span class="code">author</span> or <span class="code">publish</span>, not both at the same time<br /> </li> 
   <li>combine <span class="code">author</span> with either <span class="code">samplecontent</span> or <span class="code">nosamplecontent</span> (but not both)<br /> </li> 
  </ul> 
  <note> 
   <p>When using one of the above run modes (author, publish, samplecontent, nosamplecontent), the value used at installation time defines the run mode for the <i>entire lifetime</i> of that installation. </p> 
   <p>For these run modes you <i>cannot</i> change them after installation.</p> 
  </note> 
  <h3>Customized Run Modes</h3> 
  <p>You can also create your own, customized, run modes. These can be combined to cover scenarios such as:</p> 
  <ul> 
   <li><span class="code">author</span> + <span class="code">development</span></li> 
   <li><span class="code">publish</span> + <span class="code">test</span></li> 
   <li><code class="code">publish + test + golive
     <discoiqbr /> </code></li> 
   <li><span class="code">publish</span> + <span class="code">intranet</span></li> 
   <li>as required . . .</li> 
  </ul> 
  <p>Customized run modes can also be selected at each startup.<br /> </p> 
  <h2>Using samplecontent and nosamplecontent</h2>  
  <p>These modes allow you to control the use of sample content. The sample content is defined before the quickstart is built and can include packages, configurations, etc:</p> 
  <ul> 
   <li>The <span class="code">samplecontent</span> run mode will install this content (the default mode).<br /> </li> 
   <li>The <span class="code">nosamplecontent</span> mode will not install the sample content.</li> 
  </ul> 
  <p>The nosamplecontent run mode is designed for production installations.</p> 
  <h2>Defining configuration properties for a run mode</h2> 
  <p>A collection of values for configuration properties, used for a particular run mode, can be saved in the repository. </p> 
  <p>The run mode is indicated by a suffix on the folder name. This allows you to store all configurations in one repository as. For example:<br /> </p> 
  <ul> 
   <li><span class="code">config</span><br /> Applicable for all run modes<br /> </li> 
   <li><span class="code">config.author</span><br /> Used for author run mode<br /> </li> 
   <li><span class="code">config.publish</span><br /> Used for publish run mode<br /> </li> 
   <li><span class="code">config.&amp;lt;<i>run-mode</i>&amp;gt;</span><br /> Used for the applicable run mode; for example, config</li> 
  </ul> 
  <p>See <a href="/sites/deploying/using/configuring-osgi.html?cq_ck=1368002864971#OSGiConfigurationintheRepository">OSGi Configuration in the Repository</a> for further details on defining the individual configuration nodes within these folders and for creating configurations for combinations of multiple run modes.</p> 
  <note> 
   <p>For <a href="#installationrunmodes">Installation Run Modes</a> (e.g. author) the run mode cannot be changed after installation. However, changes to the individual configuration properties will take effect upon restart.</p> 
  </note> 
  <h2>Defining additional bundles to be installed for a run mode</h2> 
  <p>Additional bundles that should be installed for a particular run mode can also be specified. For these definititions, install folders are used to hold the bundles. Again the run mode is indicated by a prefix:</p> 
  <ul> 
   <li><span class="code">install.author</span></li> 
   <li><span class="code">install.publish</span></li> 
  </ul> 
  <p>These folders are of type <span class="code">nt:folder</span> and should contain the appropriate bundle.</p> 
  <h2>Starting CQ with a specific run mode</h2> 
  <p>If you have defined configurations for multiple run modes then you need to define which is to be used upon startup. There are several methods for specifying which run mode to use; the order of resolution is:</p> 
  <ol> 
   <li><a href="#usingtheslingpropertiesfile"><span class="code">sling.properties</span> file</a></li> 
   <li><a href="#usingtheroption"><span class="code">-r</span> option</a></li> 
   <li><a href="#usingasystemproperty">system properties (<span class="code">-D</span>)</a><br /> </li> 
   <li><a href="#filenamedetectionrenamingthejarfile">Filename detection</a></li> 
  </ol> 
  <p>When you are using an application server you can also <a href="#definingtherunmodeinwebxmlwithapplicationserver">define the run mode in <span class="code">web.xml</span></a>.</p> 
  <h3>Using the sling.properties file</h3> 
  <p>The <span class="code">sling.properties</span> file can be used to define the required run mode:</p> 
  <ol> 
   <li>Edit the configuration file:<br /> <span class="code">&amp;lt;<i>cq-installation-dir</i>&amp;gt;/crx-quickstart/conf/sling.properties</span></li> 
   <li>Add the following properties; the following example is for author:<br /> <span class="code">sling.run.modes=author</span></li> 
  </ol> 
  <h3>Using the -r option</h3> 
  <p>A custom run mode can be activated by using the <span class="code">-r</span> option when launching the quickstart. For example, use the following command to launch a AEM instance with run mode set to dev.<span class="code"></span></p> 
  <codeblock class="syntax shell">
    java&amp;nbsp;-jar&amp;nbsp;cq-56-p4545.jar&amp;nbsp;-r&amp;nbsp;dev 
  </codeblock> 
  <h3>Using a system property in the start script</h3> 
  <p>A system property in the start script can be used to specify the run mode. <br /> </p> 
  <ul> 
   <li>For example use the following to launch an instance as a production publish instance located in the US:<br /> <span class="code">-Dsling.run.modes=publish,prod,us</span> </li> 
  </ul> 
  <h3>Filename detection - renaming the jar file</h3> 
  <p>The following two installation run modes can be activated by renaming the installation jar file before installation:</p> 
  <ul> 
   <li>publish</li> 
   <li>author</li> 
  </ul> 
  <p>The jar file must use the naming convention:</p> 
  <p> <span class="code">cq5-&amp;lt;<i>run-mode</i>&amp;gt;-p&amp;lt;<i>port-number</i>&amp;gt;</span></p> 
  <p>For example, set the <span class="code">publish</span> run mode by naming the jar file:</p> 
  <p> <span class="code">cq5-publish-p4503</span></p> 
  <h3>Defining the run mode in web.xml (with Application Server)</h3> 
  <p>When you are using an application server you can also configure the property:</p> 
  <p style="margin-left: 40px;"><span class="code">sling.run.modes</span> </p> 
  <p>in the file:</p> 
  <p style="margin-left: 40px;"><span class="code">WEB-INF/web.xml</span> </p> 
  <p>This is in the AEM <span class="code">war</span> file and should be updated before deployment.</p> 
  <p>See <a href="../../../sites/deploying/using/application-server-install.md">Installing AEM with an Application Server</a> for further details.</p> 
 </body> 
</html>