<?xml version="1.1" encoding="UTF-8" standalone="yes"?>
<html>
 <head>
  <meta content="/content/help/en/experience-manager/6-4/sites/deploying/morehelp/upgrading;/content/help/en/experience-manager/6-4/sites/deploying/morehelp/upgrading" name="moreHelpPaths" />
  <meta content="2018-04-03T08:53:43.721-0400" name="lastPublishExternalDate" />
  <meta content="2018-04-30T03:27:24.032-0400" name="locHandOffDate" />
  <meta content="audience:deploying" name="primaryAudienceTag" />
  <meta content="help/components/pages/article-3" name="sling:resourceType" />
  <meta content="2018-04-30T03:27:24.033-0400" name="cq:lastModified" />
  <meta content="en_us" name="jcr:language" />
  <meta content="Lazy Content Migration" name="jcr:title" />
  <meta content="bc256f1d-e431-4436-8038-1eef0fee7d37" name="jcr:uuid" />
  <meta content="" name="jcr:primaryType" />
  <meta content="admin" name="jcr:createdBy" />
  <meta content="sarchiz" name="contentOwner" />
  <meta content="en" name="pageCreatedAt" />
  <meta content="https://helpx.adobe.com/experience-manager/6-4/sites/deploying/using/lazy-content-migration.html" name="publishExternalURL" />
  <meta content="false" name="isReadyForLocalization" />
  <meta content="/etc/designs/help" name="cq:designPath" />
  <meta content="" name="publishInternalURL" />
  <meta content="2018-04-03T08:53:43.721-0400" name="topicBrowsingSortDate" />
  <meta content="2018-04-03T08:53:43.721-0400" name="firstPublishExternalDate" />
  <meta content="" name="jcr:versionHistory" />
  <meta content="carlino@adobe.com" name="lr_lastReplicatedBy" />
  <meta content="ae945eca-bbe2-435e-a8fe-9ee1185e8f04" name="jcr:predecessors" />
  <meta content="" name="jcr:baseVersion" />
  <meta content="/apps/help/templates/article-3" name="cq:template" />
  <meta content="2018-04-03T08:53:43.737-0400" name="cq:lastReplicated" />
  <meta content="Learn about Lazy Content Migration in AEM 6.4." name="seoDescription" />
  <meta content="products:SG_EXPERIENCEMANAGER/6.4/SITES;content_type:reference;topic_tags:upgrading" name="cq:tags" />
  <meta content="true" name="jcr:isCheckedOut" />
  <meta content="products:SG_EXPERIENCEMANAGER/6.4/SITES" name="primaryProductTag" />
  <meta content="2018-03-23T07:28:51.511-0400" name="jcr:created" />
  <meta content="2018-03-30T04:56:09.608-0400" name="unpublishInternalDate" />
  <meta content="carlino" name="cq:lastReplicatedBy" />
  <meta content="Activate" name="cq:lastReplicationAction" />
  <meta content="mix:versionable" name="jcr:mixinTypes" />
  <meta content="2018-04-03T08:53:43.721-0400" name="publishExternalDate" />
  <meta content="dgonzale" name="cq:lastModifiedBy" />
 </head>
 <body>
  <p>For the sake of backwards compatibility, content and configuration in <strong>/etc</strong> and <strong>/content</strong> starting with AEM 6.3 will not be touched or transformed immediately with the upgrade. This is done in order to ensure that dependencies of customer applications on those structures stay intact. The functionality relating to these content structures is still the same even though the content in an out of the box AEM 6.4 would be hosted in another place.</p> 
  <p>While not all of those locations may be transformed automatically, there are a few delayed <span class="code">CodeUpgradeTasks</span> also refered to as Lazy Content Migration. This allows customers to trigger those automatic transformations by restarting the instance with this system property: </p> 
  <codeblock gutter="true" class="syntax shell">
   -Dcom.adobe.upgrade.forcemigration=true
  </codeblock>
  <p>This will cause the <span class="code">CodeUpgradeTasks</span> to be executed during the migration.</p> 
  <p>While the aim is an efficient execution, this upgrade process is synchronous and therefore comes with a downtime depending on the amount of the content that needs to be processed. It is recommended to evaluate the execution times on a stage environment ahead of a production system to plan an according maintenance window.</p> 
  <p>As this typically also requires adjusting application this activity should be performed along with the corresponding application deployment.</p> 
  <p>Below is the full list of <span class="code">CodeUpgradeTasks</span> introduced in 6.4:</p> 
  <table border="1" cellpadding="1" cellspacing="0" width="100%"> 
   <tbody>
    <tr>
     <td><strong>Name</strong></td> 
     <td><strong>Relevant</strong> <strong>for AEM versions prior to</strong></td> 
     <td><strong>Migration</strong> <strong>Type</strong></td> 
     <td><strong>Details</strong></td> 
    </tr>
    <tr>
     <td><span class="code">Cq561ProjectContentUpgrade</span></td> 
     <td>&lt; 5.6.1</td> 
     <td>Immediate</td> 
     <td> </td> 
    </tr>
    <tr>
     <td><span class="code">Cq60MSMContentUpgrade</span></td> 
     <td>&lt; 6.0</td> 
     <td>Immediate</td> 
     <td>Detects all <span class="code">LiveRelationShips</span> from <span class="code">VersionStorage</span> that have been deleted and add exclusion property to parent</td> 
    </tr>
    <tr>
     <td><span class="code">Cq61CloudServicesContentUpgrade</span></td> 
     <td>&lt; 6.1</td> 
     <td>Immediate</td> 
     <td>Restructures cloudservices for secure by default setup</td> 
    </tr>
    <tr>
     <td><span class="code">Cq62ConfContentUpgrade</span></td> 
     <td>&lt; 6.2</td> 
     <td>Immediate</td> 
     <td>Removes property based linking from <strong>/content</strong> to <strong>/conf</strong> (replaced by the OSGi mechanism), generates corresponding OSGi configuration</td> 
    </tr>
    <tr>
     <td><span class="code">Cq62FormsContentUpgrade</span></td> 
     <td>&lt; 6.2</td> 
     <td>Immediate</td> 
     <td>Due to merge_preserve handling the secure by default deny rule overrides given permissions leading to the need to reorder on upgrade</td> 
    </tr>
    <tr>
     <td><span class="code">CQ62Html5SmartFileUpgrade</span></td> 
     <td>&lt; 6.2</td> 
     <td>Immediate</td> 
     <td>Detects components utilizing the Html5SmartFile widget, searches for usages of the component in the content and restructures persistence, effectively moving the binary a level down and not store it on component level.</td> 
    </tr>
    <tr>
     <td><span class="code">Cq62ProjectsCodeUpgrade</span></td> 
     <td>&lt; 6.2</td> 
     <td>Immediate</td> 
     <td>Moves old style projects from <strong>/etc/projects</strong> to <strong>/content/projects</strong></td> 
    </tr>
    <tr>
     <td><span class="code">Cq62TargetCampaignsContentUpgrade</span></td> 
     <td>&lt; 6.2</td> 
     <td>Immediate</td> 
     <td>Introduces a container layer to hierarchy (Areas) and adjusts references.</td> 
    </tr>
    <tr>
     <td><span class="code">Cq62TargetContentUpgrade</span></td> 
     <td>&lt; 6.2</td> 
     <td>Immediate</td> 
     <td>Sets fixed location names to target components.</td> 
    </tr>
    <tr>
     <td><span class="code">Cq62WorkflowContentUpgrade</span></td> 
     <td>&lt; 6.2</td> 
     <td>Immediate</td> 
     <td>Complex transformation of workflow models predating 6.2 structures, instances, notifications, then merging back from the backup location from <strong>/var/backup</strong></td> 
    </tr>
    <tr>
     <td><span class="code">CQ63AssetsMetadataFormsUpdate</span></td> 
     <td>&lt; 6.3</td> 
     <td>Immediate</td> 
     <td>Moves assets, custom metadata schemas and processing profiles from <strong>/apps</strong> to <strong>/conf</strong> and translates the metadata schema and metadata profiles forms from coral2 to coral3.</td> 
    </tr>
    <tr>
     <td><span class="code">CQ63AssetsSearchFacetsUpdate</span></td> 
     <td>&lt; 6.3</td> 
     <td>Immediate</td> 
     <td>Moves assets and custom search facets from <strong>/apps</strong> to <strong>/conf</strong> and translates the metadata schema and metadata profiles forms from coral2 to coral3.</td> 
    </tr>
    <tr>
     <td><span class="code">CQ63InboxItemsUpgrade</span></td> 
     <td>&lt; 6.3</td> 
     <td>Immediate</td> 
     <td>Updates InboxItems for ordering of inbox items (adjusting metadata for efficient sorting)</td> 
    </tr>
    <tr>
     <td><span class="code">CQ63MetadataSchemaConfigUpdate</span></td> 
     <td>&lt; 6.3</td> 
     <td>Immediate</td> 
     <td>Adjusts the metadataSchema property on folder by replacing relative paths to <strong>/conf</strong> in place of <strong>/apps</strong></td> 
    </tr>
    <tr>
     <td><span class="code">CQ63MobileAppsNavUpgrade</span></td> 
     <td>&lt; 6.3</td> 
     <td>Immediate</td> 
     <td>Adjusting navigation structure</td> 
    </tr>
    <tr>
     <td><span class="code">CQ63MonitoringDashboardsConfigUpdate</span></td> 
     <td>&lt; 6.3</td> 
     <td>Immediate</td> 
     <td>Moves custom configurations for the monitoring dashboards from <strong>/libs</strong> and <strong>/apps</strong></td> 
    </tr>
    <tr>
     <td><span class="code">CQ63ProcessingProfileConfigUpdate</span></td> 
     <td>&lt; 6.3</td> 
     <td>Immediate</td> 
     <td>Translates the processingProfile property (used until 6.1) in Assets in order to match the 6.3 and later structure. Also adjusts the profile's relative paths to <strong>/conf</strong> in place of <strong>/apps</strong>.</td> 
    </tr>
    <tr>
     <td><span class="code">CQ63ToolsMenuEntriesContentUpgrade</span></td> 
     <td>&lt; 6.3</td> 
     <td>Immediate</td> 
     <td>Upgrade task that removes obsolete CRXDE Lite and Web Console menu entries in case of an upgrade.</td> 
    </tr>
    <tr>
     <td><span class="code">CQ64CommunitiesConfigsCleanupTask</span></td> 
     <td>&lt; 6.3</td> 
     <td>Delayed</td> 
     <td>Moving SRP cloud configurations, community watchwords configurations, cleans up <strong>/etc/social</strong> and <strong>/etc/enablement</strong> (any references and data needs to be be adjusted when lazy migration is run - no application part should be depending on this sturcture anymore).</td> 
    </tr>
    <tr>
     <td><span class="code">CQ64LegacyCloudSettingsCleanupTask</span></td> 
     <td>&lt; 6.4</td> 
     <td>Delayed</td> 
     <td>Cleans up <strong>/etc/cloudsettings</strong> (containing ContextHub Configuration). Configuration is automatically migrated on first access. In case Lazy Content Migration is started along with upgrade this content in <strong>/etc/cloudsettings</strong> must be preserved via package before the upgrade and reinstalled for the implicit transformation to kick in, along with a subsequent uninstallation of the package after completion.</td> 
    </tr>
    <tr>
     <td><span class="code">CQ64UsersTitleFixTask</span></td> 
     <td>&lt; 6.4</td> 
     <td>Delayed</td> 
     <td>Adjusts legacy title structure to title in user profile node.</td> 
    </tr>
   </tbody>
  </table> 
 </body>
</html>