<?xml version="1.1" encoding="UTF-8" standalone="yes"?> 
<html> 
 <head> 
  <meta content="mix:versionable" name="jcr:mixinTypes" /> 
  <meta content="remove-legacypath-6-1" name="jcr:lastModifiedBy" /> 
  <meta content="AEM provides a service that enables you to configure and control how cookies are used with your web pages" name="seoDescription" /> 
  <meta content="2018-01-18T11:19:27.511-0500" name="topicBrowsingSortDate" /> 
  <meta content="products:SG_EXPERIENCEMANAGER/6.4/SITES" name="primaryProductTag" /> 
  <meta content="audience:developing" name="primaryAudienceTag" /> 
  <meta content="" name="jcr:versionHistory" /> 
  <meta content="2018-05-08T12:41:41.220-0400" name="locHandOffDate" /> 
  <meta content="products:SG_EXPERIENCEMANAGER/6.4/SITES;topic_tags:platform;content_type:reference" name="cq:tags" /> 
  <meta content="carlino" name="cq:lastReplicatedBy" /> 
  <meta content="msm-service" name="cq:lastModifiedBy" /> 
  <meta content="2017-10-12T21:46:58.665-0400" name="qaDate" /> 
  <meta content="Activate" name="cq:lastReplicationAction" /> 
  <meta content="" name="jcr:baseVersion" /> 
  <meta content="help/components/pages/article-3" name="sling:resourceType" /> 
  <meta content="/apps/help/templates/article-3" name="cq:template" /> 
  <meta content="Guillaume Carlino" name="contentOwner" /> 
  <meta content="2018-01-19T19:04:52.246-0500" name="jcr:created" /> 
  <meta content="2018-01-18T11:19:27.511-0500" name="lastPublishExternalDate" /> 
  <meta content="https://helpx.adobe.com/experience-manager/6-3/sites/developing/using/cookie-optout.html" name="publishExternalURL" /> 
  <meta content="carlino@adobe.com" name="lr_lastReplicatedBy" /> 
  <meta content="2018-01-18T11:19:27.511-0500" name="publishExternalDate" /> 
  <meta content="/etc/designs/help" name="cq:designPath" /> 
  <meta content="dd89f4f5-75e3-45bd-9de8-b3cd4e581d5e" name="jcr:uuid" /> 
  <meta content="2018-05-08T12:41:41.221-0400" name="cq:lastModified" /> 
  <meta content="" name="jcr:primaryType" /> 
  <meta content="2017-10-12T21:46:58.665-0400" name="mwpw_migration_script_version" /> 
  <meta content="Configuring Cookie Usage" name="seoTitle" /> 
  <meta content="en_us" name="jcr:language" /> 
  <meta content="Configuring Cookie Usage" name="jcr:title" /> 
  <meta content="ecfff68c-c9bb-40a2-9c4a-9e29cbc7d391" name="jcr:predecessors" /> 
  <meta content="true" name="jcr:isCheckedOut" /> 
  <meta content="/content/docs/en/aem/6-3/develop/platform/cookie-optout" name="qaNotes" /> 
  <meta content="admin" name="jcr:createdBy" /> 
  <meta content="false" name="isReadyForLocalization" /> 
  <meta content="2018-04-03T09:00:18.011-0400" name="cq:lastReplicated" /> 
  <meta content="/content/help/en/experience-manager/6-4/sites/developing/morehelp/platform;/content/help/en/experience-manager/6-4/sites/developing/morehelp/platform" name="moreHelpPaths" /> 
  <meta content="2017-10-31T16:17:10.425-0400" name="firstPublishExternalDate" /> 
  <meta content="Configuring Cookie Usage" name="navTitle" /> 
 </head> 
 <body> 
  <p>CQ provides a service that enables you to configure and control how cookies are used with your web pages:</p> 
  <ul> 
   <li>A configurable server-side service maintains a list of cookies that can be used.</li> 
   <li>A javascript API enables your javascript code to verify that a cookie can be used.</li> 
  </ul> 
  <p>Use this feature to make sure that your pages comply with your users' consent regarding cookie usage.</p> 
  <h3>Configuring Allowed Cookies</h3> 
  <p>Configure the Adobe Granite Opt-Out Service to specify how cookies are used on your web pages. The following table describes the properties that you can configure.</p> 
  <p>To configure the service, you can use the <a href="../../../sites/deploying/using/configuring-osgi.md#osgiconfigurationwiththewebconsole">Web Console</a> or <a href="../../../sites/deploying/using/configuring-osgi.md#addinganewconfigurationtotherepository">add an OSGi configuration to the repository</a>. The following table desribes the properties that you need for either method. For an OSGi configuration, the service PID is <span class="code">com.adobe.granite.optout</span>.</p> 
  <table border="1" cellpadding="1" cellspacing="0" width="100%"> 
   <tbody> 
    <tr> 
     <th>Property Name (Web Console)</th> 
     <th>OSGi Property Name</th> 
     <th>Description</th> 
    </tr> 
    <tr> 
     <td>Opt-Out Cookies</td> 
     <td>optout.cookies</td> 
     <td>The names of cookies that indicate, when present on the user's device, that the user has not consented to using cookies.</td> 
    </tr> 
    <tr> 
     <td>Opt-Out HTTP Headers</td> 
     <td>optout.headers</td> 
     <td>The names of HTTP headers that indicate, when present, that the user has not consented to using cookies.</td> 
    </tr> 
    <tr> 
     <td>White-List Cookies</td> 
     <td>optout.whitelist.cookies</td> 
     <td>A list of cookies that are essential to the functioning of the web site, and can be used without a user's consent.</td> 
    </tr> 
   </tbody> 
  </table> 
  <h3>Validating Cookie Usage</h3> 
  <p>Use client-side javascript to call Adobe Granite Opt-Out Service to verify that you can use a cookie. Use the Granite.OptOutUtil javascript object to perform any of the following tasks:</p> 
  <ul> 
   <li>Obtain a list of cookie names that indicate that that user does not consent to using cookies for tracking purposes.</li> 
   <li>Obtain a list of cookies that can be used. </li> 
   <li>Determine whether the web browser contains a cookie that indicates the user does not consent to the use of cookies for tracking.</li> 
   <li>Determine whether a specific cookie can be used.</li> 
  </ul> 
  <p>The granite.utils <a href="../../../sites/developing/using/clientlibs.md#main-pars-title">client library folder</a> provides the Granite.OptOutUtil object. Add the following code to your page head JSP to include a link to the javascript library:</p> 
  <p><span class="code">&amp;lt;ui:includeClientLib categories="granite.utils" /&amp;gt;</span></p> 
  <p>For example, the following javascript function determines whether the COOKIE_NAME cookie is allowed to be used before writing to it:</p> 
  <codeblock class="syntax js">
    function&amp;nbsp;writeCookie(value){!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;if&amp;nbsp;(!Granite.OptOutUtil.maySetCookie("COOKIE_NAME"))&amp;nbsp;!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;return;!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;if&amp;nbsp;(value)&amp;nbsp;{!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;value&amp;nbsp;=&amp;nbsp;encodeURIComponent(value);!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;document.cookie&amp;nbsp;=&amp;nbsp;"COOKIE_NAME="&amp;nbsp;+&amp;nbsp;value;&amp;nbsp;!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;}!!discoiqbr!!} 
  </codeblock> 
  <h3>The Granite.OptOutUtil Javascript Object</h3> 
  <p>Granite.OptOutUtil enables you to determine whether cookie usage is allowed.</p> 
  <h4>getCookieNames() function</h4> 
  <p>Returns the names of the cookies that, when present, indicate that the user has not given consent to the use of cookies.</p> 
  <p><strong>Parameters</strong></p> 
  <p>None.</p> 
  <p><strong>Returns</strong></p> 
  <p>An array of cookie names.</p> 
  <h4>getWhitelistCookieNames() function</h4> 
  <p>Returns the names of cookies that can be used regardless of the user's consent.</p> 
  <p><strong>Parameters</strong></p> 
  <p>None.</p> 
  <p><strong>Returns</strong></p> 
  <p>An array of cookie names.</p> 
  <h4>isOptedOut() function</h4> 
  <p>Determines whether the user's browser contains any cookies that indicate that consent has not been given to use cookies.</p> 
  <p><strong>Parameters</strong></p> 
  <p>None.</p> 
  <p><strong>Returns</strong></p> 
  <p>A boolean value of <span class="code">true</span> if a cookie is found that indicates no consent, and a value of <span class="code">false</span> if no cookies indicate non-consent.</p> 
  <h4>maySetCookie(cookieName) function</h4> 
  <p>Determines whether a specific cookie can be used on the user's browser. This function is equivalent to using the <span class="code">isOptedOut</span> function in conjunction with determining whether the given cookie is included in the list that the <span class="code">getWhitelsitCookieNames</span> function returns.</p> 
  <p><strong>Parameters</strong></p> 
  <ul> 
   <li>cookieName: String. The name of the cookie.</li> 
  </ul> 
  <p><strong>Returns</strong></p> 
  <p>A boolean value of <span class="code">true</span> if <span class="code">cookieName</span> can be used, or a value of <span class="code">false</span> if <span class="code">cookieName</span> cannot be used.</p> 
 </body> 
</html>