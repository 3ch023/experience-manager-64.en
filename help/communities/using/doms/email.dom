<?xml version="1.1" encoding="UTF-8" standalone="yes"?> 
<html> 
 <head> 
  <meta content="2018-04-03T07:39:24.350-0400" name="topicBrowsingSortDate" /> 
  <meta content="products:SG_EXPERIENCEMANAGER/6.4/COMMUNITIES" name="primaryProductTag" /> 
  <meta content="en_us" name="jcr:language" /> 
  <meta content="/content/docs/en/aem/6-3/administer/communities/email" name="qaNotes" /> 
  <meta content="https://helpx.adobe.com/experience-manager/6-4/communities/using/email.html" name="publishExternalURL" /> 
  <meta content="2018-05-17T05:55:24.779-0400" name="cq:lastModified" /> 
  <meta content="carlino" name="cq:lastModifiedBy" /> 
  <meta content="2017-10-12T21:46:58.665-0400" name="mwpw_migration_script_version" /> 
  <meta content="Configuring Email" name="seoTitle" /> 
  <meta content="2017-10-12T21:46:58.665-0400" name="qaDate" /> 
  <meta content="f632838b-4d8d-4e0f-acd4-46bbcf81a3c3" name="jcr:predecessors" /> 
  <meta content="/apps/help/templates/article-3" name="cq:template" /> 
  <meta content="Email configuration for Communities" name="seoDescription" /> 
  <meta content="help/components/pages/article-3" name="sling:resourceType" /> 
  <meta content="2018-04-03T07:39:24.350-0400" name="lastPublishExternalDate" /> 
  <meta content="carlino@adobe.com" name="lr_lastReplicatedBy" /> 
  <meta content="2018-04-03T07:39:26.568-0400" name="cq:lastReplicated" /> 
  <meta content="admin" name="jcr:createdBy" /> 
  <meta content="/etc/designs/help" name="cq:designPath" /> 
  <meta content="" name="jcr:primaryType" /> 
  <meta content="" name="jcr:versionHistory" /> 
  <meta content="2018-05-17T05:55:24.778-0400" name="locHandOffDate" /> 
  <meta content="2017-10-31T16:33:45.714-0400" name="firstPublishExternalDate" /> 
  <meta content="true" name="jcr:isCheckedOut" /> 
  <meta content="Configuring Email" name="jcr:title" /> 
  <meta content="Activate" name="cq:lastReplicationAction" /> 
  <meta content="Configuring Email" name="navTitle" /> 
  <meta content="carlino" name="cq:lastReplicatedBy" /> 
  <meta content="products:SG_EXPERIENCEMANAGER/6.4/COMMUNITIES;topic_tags:administering;content_type:reference" name="cq:tags" /> 
  <meta content="2017-12-01T19:04:07.031-0500" name="jcr:created" /> 
  <meta content="" name="jcr:baseVersion" /> 
  <meta content="5fa2a0eb-cad6-4f27-86fd-b9917a6e7067" name="jcr:uuid" /> 
  <meta content="Configuring Email" name="pageTitle" /> 
  <meta content="false" name="isReadyForLocalization" /> 
  <meta content="2018-04-03T07:39:24.350-0400" name="publishExternalDate" /> 
  <meta content="light" name="gnavTheme" /> 
  <meta content="Janice Kendall" name="contentOwner" /> 
  <meta content="mix:versionable" name="jcr:mixinTypes" /> 
  <meta content="/content/help/en/experience-manager/6-4/communities/morehelp/administering;/content/help/en/experience-manager/6-4/communities/morehelp/administering" name="moreHelpPaths" /> 
  <meta content="dist5" name="distType" /> 
 </head> 
 <body> 
  <p>AEM Communities uses email for</p> 
  <ul> 
   <li><a href="../../communities/using/notifications.md">Communities Notifications</a></li> 
   <li><a href="../../communities/using/subscriptions.md">Communities Subscriptions</a></li> 
  </ul> 
  <p>By default, the email feature is not functional as it requires specification of an SMTP server and SMTP user.</p> 
  <note> 
   <p>Email for notifications and subscriptions must be configured only on the <a href="../../communities/using/deploy-communities.md#primarypublisher">primary publisher</a>.</p> 
  </note> 
  <h2>Default Mail Service Configuration</h2> 
  <p>The default mail service is required for both notifications and subscriptions.</p> 
  <ul> 
   <li>on the primary publisher</li> 
   <li>signed in with administrator privileges</li> 
   <li>access the <a href="../../sites/deploying/using/configuring-osgi.md">Web Console</a> 
    <ul> 
     <li>for example, <a href="http://localhost:4503/system/console/configMgr">http://localhost:4503/system/console/configMgr</a></li> 
    </ul> </li> 
   <li>locate the <span class="code">Day CQ Mail Service</span></li> 
   <li>select the edit icon</li> 
  </ul> 
  <p>This is based on the documentation for <a href="../../sites/administering/using/notification.md">Configuring Email Notification</a>, but with a difference in that the field <span class="code">"From" address</span> is <i>not</i> required and should be left empty.</p> 
  <p>For example (filled in with values for illustrative purposes only) :</p> 
  <img imageRotate="0" src="assets/chlimage_1-98.png" /> 
  <ul> 
   <li><strong>SMTP server host name : </strong><i>(required)</i> The SMTP server to use.</li> 
   <li><strong>SMTP server port : </strong><i>(required)</i> The SMTP server port must be 25 or higher.</li> 
   <li><strong>SMTP user : </strong><i>(required)</i> The SMTP user.</li> 
   <li><strong>SMTP password : </strong><i>(required)</i> The SMTP user's password.</li> 
   <li><strong>"From" address : </strong>Leave empty</li> 
   <li><strong>SMTP use SSL : </strong>If checked, will send secure email. Ensure the port is set to 465 or as required for SMTP server.</li> 
   <li><strong>Debug email : </strong>If checked, enables logging of SMTP server interactions.</li> 
  </ul> 
  <h2>AEM Communities Email Configuration</h2> 
  <p>Once the <a href="#defaultmailserviceconfiguration">default mail service</a> is configured, the two existing instances of the <span class="code">AEM Communities Email Reply Configuration</span> OSGi config, included in the release, become functional.</p> 
  <p>Only the instance for subscriptions needs to be further configured when allowing reply by email.</p> 
  <ol> 
   <li><span class="code"><a href="#configurationfornotifications">email</a></span> instance<br /> for notifications, which does not support reply email, and should not be altered</li> 
   <li><span class="code"><a href="#configurationforsubscriptions">subscriptions-email</a></span> instance<br /> requires configuration to fully enable creating post from reply email</li> 
  </ol> 
  <p>To reach the Communities email configuration instances:</p> 
  <ul> 
   <li>on the primary publisher</li> 
   <li>signed in with administrator privileges</li> 
   <li>access the <a href="../../sites/deploying/using/configuring-osgi.md">Web Console</a> 
    <ul> 
     <li>for example, <a href="http://localhost:4503/system/console/configMgr">http://localhost:4503/system/console/configMgr</a></li> 
    </ul> </li> 
   <li>locate <span class="code">AEM Communities Email Reply Configuration</span></li> 
  </ul> 
  <img imageRotate="0" src="assets/chlimage_1-99.png" /> 
  <h3>Configuration for Notifications</h3> 
  <p>The instance of <span class="code">AEM Communities Email Reply Configuration</span> OSGi config with the Name email is for the the notifications feature. This feature does not include email reply.</p> 
  <p>This configuration should not be altered.</p> 
  <ul> 
   <li>locate the <span class="code">AEM Communities Email Reply Configuration</span></li> 
   <li>select the edit icon</li> 
   <li>verify the <strong>Name</strong> is <span class="code">email</span></li> 
   <li>verify <strong>Create post from reply email</strong> is <span class="code">unchecked</span></li> 
  </ul> 
  <img imageRotate="0" src="assets/chlimage_1-100.png" /> 
  <h3>Configuration for Subscriptions</h3> 
  <p>For Communities subscriptions, it is possible to enable or disable the ability for a member to post content by replying to an email.</p> 
  <ul> 
   <li>locate the <span class="code">AEM Communities Email Reply Configuration</span></li> 
   <li>select the edit icon</li> 
   <li>verify the <strong>Name</strong> is <span class="code">subscriptions-email</span></li> 
  </ul> 
  <img imageRotate="0" src="assets/chlimage_1-101.png" /> 
  <ul> 
   <li><strong>Name </strong>: <i>(required)</i> <span class="code">subscriptions-email</span>. Do Not Edit.</li> 
   <li><strong>Create post from reply email</strong> : If checked, recipient of subscription email may post content by sending a reply. Default is checked.</li> 
   <li><strong>Add tracked id to header</strong> : Default is <span class="code">Reply-To</span>.</li> 
   <li><strong>Maximum length of Subject</strong> : If tracker id is added to subject line, this is the maximum length of subject, excluding tracked id, after which it will be trimmed. Note that this should be as small as possible to avoid tracked id information from being lost. Default is 200.</li> 
   <li><strong>Email "From" address</strong> : <i>(required)</i> Address that notification email would be delivered from. Likely the same <strong>SMTP user</strong> specified for the <a href="#configuredefaultmailservice">default mail service</a>. Default is <span class="code">no-reply@example.com</span>.</li> 
   <li><strong>Reply-to-Delimiter</strong> : If tracker id is added to Reply-to header, this delimiter will be used. Default is <span class="code">+</span> (plus sign).</li> 
   <li><strong>Tracker Id prefix in subject</strong> : If tracker id is added to subject line, this prefix will be used. Default is <span class="code">post#</span>.</li> 
   <li><strong>Tracker id prefix in message body</strong> : If tracker id is added to message body, this prefix will be used. Default is <span class="code">Please do not remove this:</span>.</li> 
   <li><strong>Email as HTML</strong> : If checked, Content-Type of email will be set as <span class="code">"text/html;charset=utf-8"</span>. Default is checked.</li> 
   <li><strong>Default user name</strong> : This name will be used for no name users. Default is <span class="code">no-reply@example.com</span>.</li> 
   <li><strong>Templates root path</strong> : The email is built using template stored at this root path. Default is <span class="code">/etc/community/templates/subscriptions-email</span>.</li> 
  </ul> 
  <h2>Configure Polling Importer</h2> 
  <p>In order for the email to be brought into the repository, it is necessary to configure a polling importer and configure its properties in the repository manually.</p> 
  <h4>Add New Polling Importer</h4> 
  <ul> 
   <li>on the primary publisher</li> 
   <li>signed in with administrator privileges</li> 
   <li>browse to the polling importer console<br /> 
    <ul> 
     <li>for example, <a href="http://localhost:4503/etc/importers/polling.html">http://localhost:4503/etc/importers/polling.html</a></li> 
    </ul> </li> 
   <li>select <strong>Add</strong></li> 
  </ul> 
  <img imageRotate="0" src="assets/chlimage_1-102.png" /> 
  <ul> 
   <li><strong>Type </strong>: <i>(required)</i> Pull down to select <span class="code">POP3 (over SSL). </span></li> 
   <li><strong>URL </strong>: <i>(required)</i> The outbound mail server. For example, <br /> <span class="code">//pop.gmail.com:995/INBOX?username=community-email@gmail.com&amp;password=****</span></li> 
   <li><strong>Import to Path*</strong> : <i>(required)</i> Set to <span class="code">/content/usergenerated/mailFolder/postEmails</span><br /> by browsing to the <span class="code">postEmails </span>folder and select <strong>OK</strong></li> 
   <li><strong>Update Interval in Seconds</strong> : <i>(optional) </i>The mail server configured for the default mail service may have requirements regarding the update interval value. For example, Gmail may require an interval of <span class="code">300</span>.</li> 
   <li><strong>Login </strong>: <i>(optional)</i> </li> 
   <li><strong>Password</strong> : <i>(optional)</i></li> 
  </ul> 
  <ul> 
   <li>Select <strong>OK</strong></li> 
  </ul> 
  <h4>Adjust Protocol for New Polling Importer</h4> 
  <p>Once the new polling configuration is saved, it is necessary to further modify properties of the subscription email importer in order to change the protocol from <span class="code">POP3</span> to <span class="code">emailreply</span></p> 
  <p>Using <a href="../../sites/developing/using/developing-with-crxde-lite.md">CRXDE Lite</a> :</p> 
  <ul> 
   <li>on the primary publisher</li> 
   <li>signed in with administrator privileges</li> 
   <li>browse to <a href="http://localhost:4503/crx/de/index.jsp#/etc/importers/polling">http://&amp;lt;server&amp;gt;:&amp;lt;port&amp;gt;/crx/de/index.jsp#/etc/importers/polling</a></li> 
   <li>select the newly created configuration</li> 
   <li>modify the following properties 
    <ul> 
     <li><strong>feedType </strong>: replace <span class="code">pop3s</span> with <strong><span class="code">emailreply</span></strong></li> 
     <li><strong>source</strong>: replace source's protocol <span class="code">pop3s://</span> with <strong><span class="code">emailreply://</span></strong></li> 
    </ul> </li> 
  </ul> 
  <img imageRotate="0" src="assets/chlimage_1-103.png" /> 
  <p>The red triangles indicate the modified properties. Be sure to save the changes :</p> 
  <ul> 
   <li>select <strong>Save All</strong></li> 
  </ul> 
 </body> 
</html>