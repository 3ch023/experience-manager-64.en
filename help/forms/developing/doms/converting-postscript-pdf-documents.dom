<?xml version="1.1" encoding="UTF-8" standalone="yes"?>
<html>
 <head>
  <meta content="admin" name="contentOwner" />
  <meta content="" name="jcr:baseVersion" />
  <meta content="" name="jcr:primaryType" />
  <meta content="video" name="pageLayout" />
  <meta content="AEMForms/6.1/ProgramLC/WS624e3cba99b79e12-726e92b21336a3542ad-8000.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12-726e92b21336a3542ad-7fff.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-7f0b.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12-726e92b21336a3542ad-7ffd.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-77a6.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-77a5.2" name="cq:gepId" />
  <meta content="head1_20111213" name="gep_conversion_script_version" />
  <meta content="carlino" name="cq:lastModifiedBy" />
  <meta content="Converting Postscript to PDF Documents" name="navTitle" />
  <meta content="2017-07-12T07:03:00.000-0400" name="sortDate" />
  <meta content="" name="jcr:versionHistory" />
  <meta content="Converting Postscript to PDF Documents" name="jcr:title" />
  <meta content="2017-07-12T07:03:00.000-0400" name="topicBrowsingSortDate" />
  <meta content="2018-04-03T08:17:11.676-0400" name="cq:lastReplicated" />
  <meta content="2017-07-12T07:03:37.497-0400" name="lr_lastModified" />
  <meta content="not_checked" name="acrolinxStatus" />
  <meta content="audience:developing" name="primaryAudienceTag" />
  <meta content="en_us" name="jcr:language" />
  <meta content="/etc/designs/help" name="cq:designPath" />
  <meta content="8affe3ec-6c71-4931-b5c4-cd3381ca86cf" name="jcr:uuid" />
  <meta content="carlino" name="cq:lastReplicatedBy" />
  <meta content="products:SG_EXPERIENCEMANAGER/6.4/FORMS" name="primaryProductTag" />
  <meta content="6a20c9f6-3f3b-44f2-80e9-bacfa8571388" name="jcr:predecessors" />
  <meta content="false" name="doNotLocalize" />
  <meta content="content_type:reference;products:SG_EXPERIENCEMANAGER/6.4/FORMS;topic_tags:operations" name="cq:tags" />
  <meta content="2017-10-03T06:47:09.545-0400" name="publishExternalDate" />
  <meta content="mix:versionable" name="jcr:mixinTypes" />
  <meta content="light" name="heroGradient" />
  <meta content="help/components/pages/article-3" name="sling:resourceType" />
  <meta content="left" name="sideColumn" />
  <meta content="2017-10-03T06:47:09.545-0400" name="firstPublishExternalDate" />
  <meta content="https://helpx.adobe.com/aem-forms/6-3/developing/converting-postscript-pdf-documents.html" name="publishExternalURL" />
  <meta content="admin" name="lr_lastModifiedBy" />
  <meta content="2017-10-03T06:47:09.545-0400" name="lastPublishExternalDate" />
  <meta content="true" name="jcr:isCheckedOut" />
  <meta content="2017-11-21T06:57:29.360-0500" name="cq:lastModified" />
  <meta content="admin" name="jcr:createdBy" />
  <meta content="admin" name="lr_creator" />
  <meta content="Activate" name="cq:lastReplicationAction" />
  <meta content="khsingh@adobe.com" name="lr_lastReplicatedBy" />
  <meta content="2017-11-22T19:05:22.087-0500" name="jcr:created" />
  <meta content="/apps/help/templates/article-3" name="cq:template" />
 </head>
 <body>
  <h2 id="about_the_distiller_service">About the Distiller Service</h2>
  <p></p>
  <p>The Distiller® service converts PostScript®, Encapsulated PostScript (EPS), and PRN files to compact, reliable, and more secure PDF files over a network. The Distiller service is frequently used to convert large volumes of print documents to electronic documents, such as invoices and statements. Converting documents to PDF also allows enterprises to send their customers a paper version and an electronic version of a document.</p>
  <note>
   <p>For more information about the Distiller service, see <a href="http://www.adobe.com/go/learn_aemforms_services_63">Services Reference for AEM Forms</a>.</p>
  </note>
  <h2 id="converting_postscript_to_pdf_documents">Converting PostScript to PDF documents</h2>
  <p></p>
  <p>This topic describes how you can use the Distiller Service API (Java and web service) to programmatically convert PostScript (PS), Encapsulated PostScript (EPS), and PRN files to PDF documents.</p>
  <note>
   <p>For more information about the Distiller service, see <a href="http://www.adobe.com/go/learn_aemforms_services_63">Services Reference for AEM Forms</a>.</p>
  </note>
  <note>
   <p>To convert PostScript files to PDF documents, one of the following needs to be installed on the server hosting AEM Forms: Acrobat 9 or Microsoft Visual C++ 2005 redistributable package.</p>
  </note>
  <h3 id="summary_of_steps">Summary of steps</h3>
  <p></p>
  <p>To convert any of the supported types to a PDF document, perform the following steps:</p>
  <ol>
   <li><p>Include project files.</p></li>
   <li><p>Create a Distiller service client.</p></li>
   <li><p>Retrieve the file to convert.</p></li>
   <li><p>Invoke the PDF creation operation.</p></li>
   <li><p>Save the PDF document. </p></li>
  </ol>
  <p><strong>Include project files</strong></p>
  <p>Include the necessary files in your development project. If you are creating a client application by using Java, include the necessary JAR files. If you are using web services, make sure you include the proxy files.</p>
  <p><strong>Create a Distiller service client</strong></p>
  <p>Before you can programmatically perform a Distiller service operation, you must create a Distiller service client. If you are using the Java API, create a <span class="code">DistillerServiceClient</span> object. If you are using the web service API, create a <span class="code">DistillerServiceService</span> object.</p>
  <p><strong>Retrieve the file to convert</strong></p>
  <p>You must retrieve the file that you want to convert. For example, to convert a PS file to a PDF document, you must retrieve the PS file. </p>
  <p><strong>Invoke the PDF creation operation</strong></p>
  <p>After you create the service client, you can then invoke the PDF creation operation. This operation will need information about the document to be converted, including the path to the target document.</p>
  <p><strong>Save the PDF document</strong></p>
  <p>You can save the PDF document as a PDF file.</p>
  <p><strong>See also</strong></p>
  <p><a href="converting-postscript-pdf-documents#convert_a_postscript_file_to_pdf_using_the_java_api">Convert a PostScript file to PDF using the Java API</a></p>
  <p><a href="converting-postscript-pdf-documents#converting_a_postscript_file_to_pdf_using_the_web_service_api">Converting a PostScript file to PDF using the web service API</a></p>
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-java#including_aem_forms_java_library_files">Including AEM Forms Java library files</a></p>
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-java#setting_connection_properties">Setting connection properties</a></p>
  <p><a href="/programming-with-aem-forms/output-service-java-api-quick#output_service_java_api_quick_start_soap">Output Service API Quick Starts</a></p>
  <h3 id="convert_a_postscript_file_to_pdf_using_the_java_api">Convert a PostScript file to PDF using the Java API</h3>
  <p></p>
  <p>Convert a PostScript file to PDF document by using the Distiller Service API (Java):</p>
  <ol>
   <li><p>Include project files. </p><p>Include client JAR files, such as adobe-distiller-client.jar, in your Java project’s class path. </p></li>
   <li><p>Create a Distiller service client. </p>
    <ul>
     <li><p>Create a <span class="code">ServiceClientFactory</span> object that contains connection properties. </p></li>
     <li><p>Create an <span class="code">DistillerServiceClient</span> object by using its constructor and passing the <span class="code">ServiceClientFactory</span> object.</p></li>
    </ul></li>
   <li><p>Retrieve the file to convert. </p>
    <ul>
     <li><p>Create a <span class="code">java.io.FileInputStream</span> object that represents the file to convert by using its constructor and passing a string value that specifies the location of the file.</p></li>
     <li><p>Create a <span class="code">com.adobe.idp.Document</span> object by using its constructor and passing the <span class="code">java.io.FileInputStream</span> object.</p></li>
    </ul></li>
   <li><p>Invoke the PDF creation operation. </p><p>Invoke the <span class="code">DistillerServiceClient</span> object’s <span class="code">createPDF</span> method and pass the following values:</p>
    <ul>
     <li><p>The <span class="code">com.adobe.idp.Document</span> object that represents the PS, EPS, or PRN file to be converted</p></li>
     <li><p>A <span class="code">java.lang.String</span> object that contains the name of the file to be converted</p></li>
     <li><p>A <span class="code">java.lang.String</span> object that contains the name of the Adobe PDF settings to be used</p></li>
     <li><p>A <span class="code">java.lang.String</span> object that contains the name of the security settings to be used</p></li>
     <li><p>An optional <span class="code">com.adobe.idp.Document</span> object that contains settings to be applied while generating the PDF document</p></li>
     <li><p>An optional <span class="code">com.adobe.idp.Document</span> object that contains metadata information to be applied to the PDF document</p></li>
    </ul><p>The <span class="code">createPDF</span> method returns a <span class="code">CreatePDFResult</span> object that contains the new PDF document and a log file that may be generated. The log file typically contains error or warning messages that are generated by the conversion request. </p></li>
   <li><p>Save the PDF document. </p><p>To obtain the newly created PDF document, perform the following actions:</p>
    <ul>
     <li><p>Invoke the <span class="code">CreatePDFResult</span> object’s <span class="code">getCreatedDocument</span> method. This returns a <span class="code">com.adobe.idp.Document</span> object.</p></li>
     <li><p>Invoke the <span class="code">com.adobe.idp.Document</span> object’s <span class="code">copyToFile</span> method to extract the PDF document.</p></li>
    </ul><p>Similarly, to obtain the log document, perform the following actions.</p>
    <ul>
     <li><p>Invoke the <span class="code">CreatePDFResult</span> object’s <span class="code">getLogDocument</span> method. This returns a <span class="code">com.adobe.idp.Document</span> object.</p></li>
     <li><p>Invoke the <span class="code">com.adobe.idp.Document</span> object’s <span class="code">copyToFile</span> method to extract the log document.</p></li>
    </ul></li>
  </ol>
  <p><strong>See also</strong></p>
  <p><a href="converting-postscript-pdf-documents#summary_of_steps">Summary of steps</a></p>
  <p><a href="/programming-with-aem-forms/distiller-service-java-api-quick#quick_start_soap_mode_converting_a_postscript_file_to_a_pdf_document_using_the_java_api">Quick Start (SOAP mode): Converting a PostScript file to a PDF document using the Java API</a></p>
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-java#including_aem_forms_java_library_files">Including AEM Forms Java library files</a></p>
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-java#setting_connection_properties">Setting connection properties</a></p>
  <h3 id="converting_a_postscript_file_to_pdf_using_the_web_service_api">Converting a PostScript file to PDF using the web service API</h3>
  <p></p>
  <p>Convert a PostScript file to PDF document by using the Distiller Service API (web service):</p>
  <ol>
   <li><p>Include project files. </p><p>Create a Microsoft .NET project that uses MTOM. Ensure that you use the following WSDL definition: <span class="code">http://localhost:8080/soap/services/DistillerService?WSDL&amp;lc_version=9.0.1</span>. </p>
    <note>
     <p>Replace <span class="code">localhost</span> with the IP address of the server hosting AEM Forms. </p>
    </note></li>
   <li><p>Create a Distiller service client. </p>
    <ul>
     <li><p>Create a <span class="code">DistillerServiceClient</span> object by using its default constructor. </p></li>
     <li><p>Create a <span class="code">DistillerServiceClient.Endpoint.Address</span> object by using the <span class="code">System.ServiceModel.EndpointAddress</span> constructor. Pass a string value that specifies the WSDL to the AEM Forms service (for example, <span class="code">http://localhost:8080/soap/services/DistillerService?blob=mtom</span>.) You do not need to use the <span class="code">lc_version</span> attribute. This attribute is used when you create a service reference. However, specify <span class="code">?blob=mtom</span> to use MTOM.</p></li>
     <li><p>Create a <span class="code">System.ServiceModel.BasicHttpBinding</span> object by getting the value of the <span class="code">DistillerServiceClient.Endpoint.Binding</span> field. Cast the return value to <span class="code">BasicHttpBinding</span>. </p></li>
     <li><p>Set the <span class="code">System.ServiceModel.BasicHttpBinding</span> object’s <span class="code">MessageEncoding</span> field to <span class="code">WSMessageEncoding.Mtom</span>. This value ensures that MTOM is used. </p></li>
     <li><p>Enable basic HTTP authentication by performing the following tasks:</p>
      <ul>
       <li><p>Assign the AEM forms user name to the field <span class="code">DistillerServiceClient.ClientCredentials.UserName.UserName</span>.</p></li>
       <li><p>Assign the corresponding password value to the field <span class="code">DistillerServiceClient.ClientCredentials.UserName.Password</span>.</p></li>
       <li><p>Assign the constant value <span class="code">HttpClientCredentialType.Basic</span> to the field <span class="code">BasicHttpBindingSecurity.Transport.ClientCredentialType</span>. </p></li>
       <li><p>Assign the constant value <span class="code">BasicHttpSecurityMode.TransportCredentialOnly</span> to the field <span class="code">BasicHttpBindingSecurity.Security.Mode</span>. </p></li>
      </ul></li>
    </ul></li>
   <li><p>Retrieve the file to convert. </p>
    <ul>
     <li><p>Create a <span class="code">BLOB</span> object by using its constructor. This <span class="code">BLOB</span> object is used to store the file to convert to a PDF document.</p></li>
     <li><p>Create a <span class="code">System.IO.FileStream</span> object by invoking its constructor and passing a string value that represents the file location and the mode to open the file in. </p></li>
     <li><p>Create a byte array that stores the content of the <span class="code">System.IO.FileStream</span> object. You can determine the size of the byte array by getting the <span class="code">System.IO.FileStream</span> object’s <span class="code">Length</span> property. </p></li>
     <li><p>Populate the byte array with stream data by invoking the <span class="code">System.IO.FileStream</span> object’s <span class="code">Read</span> method and passing the byte array, the starting position, and the stream length to read.</p></li>
     <li><p>Populate the <span class="code">BLOB</span> object by assigning its <span class="code">MTOM</span> property with the contents of the byte array.</p></li>
    </ul></li>
   <li><p>Invoke the PDF creation operation. </p><p>Invoke the <span class="code">DistillerServiceService</span> object’s <span class="code">CreatePDF2</span> method and pass the following required values:</p>
    <ul>
     <li><p>The <span class="code">BLOB</span> object that represents the PS file to convert</p></li>
     <li><p>A string that contains the path name of the file to be convert</p></li>
     <li><p>A string object that contains the Adobe PDF settings to be used (for example, <span class="code">Standard</span>)</p></li>
     <li><p>A string object that contains the security settings to be used (for example, <span class="code">No Securit</span>y)</p></li>
     <li><p>An optional <span class="code">BLOB</span> object that contains settings to be applied while generating the PDF document</p></li>
     <li><p>An optional <span class="code">BLOB</span> object that contains metadata information to be applied to the PDF document</p></li>
     <li><p>A <span class="code">BLOB</span> output parameter used to store the PDF document </p></li>
     <li><p>A <span class="code">BLOB</span> output parameter used to store the log</p></li>
    </ul></li>
   <li><p>Save the PDF document. </p>
    <ul>
     <li><p>Create a <span class="code">System.IO.FileStream</span> object by invoking its constructor. Pass a string value that represents the file location of the signed PDF document and the mode in which to open the file.</p></li>
     <li><p>Create a byte array that stores the content of the <span class="code">BLOB</span> object that was returned by the <span class="code">CreatePDF2</span> method (the output parameter). Populate the byte array by getting the value of the <span class="code">BLOB</span> object’s <span class="code">MTOM</span> data member.</p></li>
     <li><p>Create a <span class="code">System.IO.BinaryWriter</span> object by invoking its constructor and passing the <span class="code">System.IO.FileStream</span> object.</p></li>
     <li><p>Write the contents of the byte array to a PDF file by invoking the <span class="code">System.IO.BinaryWriter</span> object’s <span class="code">Write</span> method and passing the byte array.</p></li>
    </ul></li>
  </ol>
  <p><strong>See also</strong></p>
  <p><a href="converting-postscript-pdf-documents#summary_of_steps">Summary of steps</a></p>
  <p><a href="#unresolvedlink-lc-qs-distiller-di.xml#ws624e3cba99b79e12e69a9941333732bac8-7f01.2">Quick Start (MTOM): Converting a PostScript file to a PDF document using the web service API</a></p>
  <p><a href="#unresolvedlink-lc-qs-distiller-di.xml#ws624e3cba99b79e12e69a9941333732bac8-7eff.2">Quick Start (SwaRef): Converting a PostScript file to a PDF document using the web service API</a></p>
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-web#invoking_aem_forms_using_mtom">Invoking AEM Forms using MTOM</a></p>
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-web#invoking_aem_forms_using_swaref">Invoking AEM Forms using SwaRef</a></p>
 </body>
</html>