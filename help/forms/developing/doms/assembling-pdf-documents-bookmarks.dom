<?xml version="1.1" encoding="UTF-8" standalone="yes"?> 
<html> 
 <head> 
  <meta content="mix:versionable" name="jcr:mixinTypes" /> 
  <meta content="" name="jcr:versionHistory" /> 
  <meta content="4601cf11-baf5-455b-9835-e249e17c6f25" name="jcr:predecessors" /> 
  <meta content="head1_20111213" name="gep_conversion_script_version" /> 
  <meta content="2017-08-09T03:29:40.053-0400" name="lr_lastModified" /> 
  <meta content="" name="jcr:primaryType" /> 
  <meta content="" name="jcr:baseVersion" /> 
  <meta content="video" name="pageLayout" /> 
  <meta content="admin" name="lr_creator" /> 
  <meta content="false" name="doNotLocalize" /> 
  <meta content="left" name="sideColumn" /> 
  <meta content="https://helpx.adobe.com/aem-forms/6-3/developing/assembling-pdf-documents-bookmarks.html" name="publishExternalURL" /> 
  <meta content="admin" name="jcr:createdBy" /> 
  <meta content="khsingh@adobe.com" name="lr_lastReplicatedBy" /> 
  <meta content="/etc/designs/help" name="cq:designPath" /> 
  <meta content="Assembling PDF Documents with Bookmarks Assembling PDF Documents with Bookmarks" name="navTitle" /> 
  <meta content="AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-7f77.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e1270a0c0761336a35715e-7fff.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-7399.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-7398.2" name="cq:gepId" /> 
  <meta content="/apps/help/templates/article-3" name="cq:template" /> 
  <meta content="2017-11-22T19:07:11.250-0500" name="jcr:created" /> 
  <meta content="true" name="jcr:isCheckedOut" /> 
  <meta content="en_us" name="jcr:language" /> 
  <meta content="light" name="heroGradient" /> 
  <meta content="Assembling PDF Documents with Bookmarks" name="jcr:title" /> 
  <meta content="115d6c90-46e8-40fc-bb76-42615f5cb2c4" name="jcr:uuid" /> 
  <meta content="carlino" name="cq:lastReplicatedBy" /> 
  <meta content="content_type:reference;geptopics:SG_AEMFORMS/categories/assembling_pdf_documents;products:SG_EXPERIENCEMANAGER/6.4/FORMS;topic_tags:operations" name="cq:tags" /> 
  <meta content="2017-10-03T06:52:09.148-0400" name="lastPublishExternalDate" /> 
  <meta content="admin" name="lr_lastModifiedBy" /> 
  <meta content="products:SG_EXPERIENCEMANAGER/6.4/FORMS" name="primaryProductTag" /> 
  <meta content="carlino" name="cq:lastModifiedBy" /> 
  <meta content="2018-04-03T08:31:32.866-0400" name="cq:lastReplicated" /> 
  <meta content="2017-10-03T06:52:09.148-0400" name="publishExternalDate" /> 
  <meta content="admin" name="contentOwner" /> 
  <meta content="Activate" name="cq:lastReplicationAction" /> 
  <meta content="not_checked" name="acrolinxStatus" /> 
  <meta content="2017-10-03T06:52:09.148-0400" name="firstPublishExternalDate" /> 
  <meta content="2017-08-09T03:29:00.000-0400" name="topicBrowsingSortDate" /> 
  <meta content="audience:developing" name="primaryAudienceTag" /> 
  <meta content="2017-08-09T03:29:00.000-0400" name="sortDate" /> 
  <meta content="help/components/pages/article-3" name="sling:resourceType" /> 
  <meta content="2017-11-21T06:59:25.009-0500" name="cq:lastModified" /> 
 </head> 
 <body> 
  <p>You can assemble a PDF document that contains bookmarks. For example, assume that you have a PDF document that does not contain bookmarks and you want to modify it by providing bookmarks. Using the Assembler service, you can pass it a PDF document that does not contain bookmarks and get back a PDF document that contains bookmarks.</p> 
  <p>Bookmarks contain the following properties:</p> 
  <ul> 
   <li><p>A title that appears as text on the screen.</p></li> 
   <li><p>An action that specifies what happens when a user clicks on the bookmark. The typical action for a bookmark is to move to another location in the current document or open another PDF document, although other actions can be specified.</p></li> 
  </ul> 
  <p>For the purpose of this discussion, assume that the following DDX document is used.</p> 
  <codeblock gutter="true" class="syntax as3">
     &lt;?xml&amp;nbsp;version="1.0"&amp;nbsp;encoding="UTF-8"?&gt;&amp;nbsp;!!discoiqbr!! &lt;DDX&amp;nbsp;xmlns="http://ns.adobe.com/DDX/1.0/"&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;PDF&amp;nbsp;result="FinalDoc.pdf"&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;PDF&amp;nbsp;source="Loan.pdf"&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;Bookmarks&amp;nbsp;source="doc2"&amp;nbsp;/&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/PDF&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/PDF&gt;&amp;nbsp;!!discoiqbr!! &lt;/DDX&gt; 
  </codeblock> 
  <p>Within this DDX document, notice that the source attribute is assigned the value <span class="code">Loan.pdf</span>. This DDX document specifies that a single PDF document is passed to the Assembler service. When assembling a PDF document with bookmarks, you must specify a bookmark XML document that describes the bookmarks in the result document. To specify a bookmark XML document, ensure that the <span class="code">Bookmarks</span> element is specified in your DDX document. </p> 
  <p>In this example DDX document, the <span class="code">Bookmarks</span> element specifies <span class="code">doc2</span> as the value. This value indicates that the input map passed to the Assembler service contains a key named <span class="code">doc2</span>. The value of the <span class="code">doc2</span> key is a <span class="code">com.adobe.idp.Document</span> value that represents the bookmark XML document. (See "Bookmarks Language" in the <a href="http://www.adobe.com/go/learn_aemforms_ddx_63">Assembler Service and DDX Reference</a>.)</p> 
  <p>This topic uses the following XML bookmarks language to assemble a PDF document containing bookmarks. </p> 
  <codeblock gutter="true" class="syntax as3">
     &lt;?xml&amp;nbsp;version="1.0"&amp;nbsp;encoding="UTF-8"?&gt;&amp;nbsp;!!discoiqbr!! &lt;Bookmarks&amp;nbsp;xmlns="http://ns.adobe.com/pdf/bookmarks"&amp;nbsp;version="1.0"&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;Bookmark&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;Action&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;Launch&amp;nbsp;NewWindow="true"&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;File&amp;nbsp;Name="C:\Adobe\LoanDetails.pdf"&amp;nbsp;/&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/Launch&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/Action&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;Title&gt;Open&amp;nbsp;the&amp;nbsp;Loan&amp;nbsp;document&lt;/Title&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/Bookmark&gt;&amp;nbsp;!!discoiqbr!! &lt;Bookmark&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;Action&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;Launch&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;Win&amp;nbsp;Name="C:\WINDOWS\notepad.exe"&amp;nbsp;/&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/Launch&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/Action&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;Title&gt;Launch&amp;nbsp;NotePad&lt;/Title&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/Bookmark&gt;&amp;nbsp;!!discoiqbr!! &lt;/Bookmarks&gt; 
  </codeblock> 
  <p>Within this bookmark XML document, notice the Action element that defines the action that is performed when a user clicks the bookmark. Under the Action element is the Launch element that launches applications, such as NotePad and opens files, such as PDF files. To open a PDF file, you must use the File element that specifies the file to open. For example, in the bookmark XML file specified in this section, the name of the file that is opened is LoanDetails.pdf.</p> 
  <note> 
   <p>For complete details about supported actions, see "<span class="code">Action</span> element" in the <a href="http://www.adobe.com/go/learn_aemforms_ddx_63">Assembler Service and DDX Reference</a>.</p> 
  </note> 
  <p>Given the DDX document specified in this section and bookmark XML file as input, the Assembler service assembles a PDF document that contains the following bookmarks.</p> 
  <img alt="" src="assets/aw_aw_bmark.png" /> 
  <p>When a user clicks on the <i>Open the Loan Details</i> bookmark, the LoanDetails.pdf is opened. Likewise, when the user clicks on the <i>Launch NotePad</i> bookmark, NotePad is started.</p> 
  <note> 
   <p>Before reading this section, it is recommended that you be familiar with assembling PDF documents using the Assembler service. This section does not discuss concepts, such as creating a collection object that contains input documents or learning how to extract the results from the returned collection object. (See <a href="/programming-with-aem-forms/programmatically-assembling-pdf-documents-programmatically programmatically-assembling-pdf-documents-programmatically#programmatically_assembling_pdf_documents">Programmatically Assembling PDF Documents</a>.)</p> 
  </note> 
  <note> 
   <p>For more information about the Assembler service, see<a href="http://www.adobe.com/go/learn_aemforms_services_63">Services Reference for AEM Forms</a>.</p> 
  </note> 
  <note> 
   <p>For more information about a DDX document, see <a href="http://www.adobe.com/go/learn_aemforms_ddx_63">Assembler Service and DDX Reference</a>. </p> 
  </note> 
  <h2 id="summary_of_steps">Summary of steps</h2> 
  <p></p> 
  <p>To assemble a PDF document that contains bookmarks, perform the following tasks:</p> 
  <ol> 
   <li><p>Include project files.</p></li> 
   <li><p>Create a PDF Assembler client.</p></li> 
   <li><p>Reference an existing DDX document.</p></li> 
   <li><p>Reference a PDF document to which bookmarks are added.</p></li> 
   <li><p>Reference the bookmark XML document.</p></li> 
   <li><p>Add the PDF document and the bookmark XML document to a Map collection.</p></li> 
   <li><p>Set run-time options.</p></li> 
   <li><p>Assemble the PDF document. </p></li> 
   <li><p>Save the PDF document that contains bookmarks.</p></li> 
  </ol> 
  <p><strong>Include project files</strong></p> 
  <p>Include the necessary files in your development project. If you are creating a client application by using Java, include the necessary JAR files. If you are using web services, ensure that you include the proxy files.</p> 
  <p>The following JAR files must be added to your project’s class path:</p> 
  <ul> 
   <li><p>adobe-livecycle-client.jar</p></li> 
   <li><p>adobe-usermanager-client.jar</p></li> 
   <li><p>adobe-assembler-client.jar</p></li> 
   <li><p>adobe-utilities.jar (required if AEM Forms is deployed on JBoss) </p></li> 
   <li><p>jbossall-client.jar (required if AEM Forms is deployed on JBoss)</p></li> 
  </ul> 
  <p>if AEM Forms is deployed on a supported J2EE application server other than JBoss, you must replace the adobe-utilities.jar and jbossall-client.jar files with JAR files that are specific to the J2EE application server that AEM Forms is deployed on. For information about the location of all AEM Forms JAR files, see <a href="#unresolvedlink-lc-in-invoke-using-java-iu.xml#ws624e3cba99b79e12e69a9941333732bac8-7b4b.2">Including AEM Forms Java library files</a>.</p> 
  <p><strong>Create a PDF Assembler client</strong></p> 
  <p>Before you can programmatically perform an Assembler operation, you must create an Assembler service client.</p> 
  <p><strong>Reference an existing DDX document</strong></p> 
  <p>A DDX document must be referenced to assemble a PDF document. This DDX document must contain the <span class="code">Bookmarks</span> element, which instructs the Assembler service to assemble a PDF that contains bookmarks. (See the DDX document shown earlier in this section for an example.)</p> 
  <p><strong>Reference a PDF document to which bookmarks are added</strong></p> 
  <p>Reference a PDF document to which bookmarks are added. It does not matter whether the referenced PDF document already contains bookmarks. If the <span class="code">Bookmarks</span> element is a child of the PDF source element, then the Bookmarks will replace those that already exist in the PDF source. However, if you want to keep the existing bookmarks, then ensure that <span class="code">Bookmarks</span> is a sibling of the PDF source element. For example, consider the following example:</p> 
  <codeblock gutter="true" class="syntax as3">
     &lt;PDF&amp;nbsp;result="foo"&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;PDF&amp;nbsp;source="inDoc"/&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;Bookmarks&amp;nbsp;source="doc2"/&gt;&amp;nbsp;!!discoiqbr!! &lt;/PDF&gt; 
  </codeblock> 
  <p><strong>Reference the bookmark XML document</strong></p> 
  <p>To assemble a PDF that contains new bookmarks, you must reference a bookmark XML document. The bookmark XML document is passed to the Assembler service within the Map collection object. (See the bookmark XML document shown earlier in this section for an example.) </p> 
  <note> 
   <p>See "Bookmarks Language" in the <a href="http://www.adobe.com/go/learn_aemforms_ddx_63">Assembler Service and DDX Reference</a>.</p> 
  </note> 
  <p><strong>Add the PDF document and the bookmark XML document to a Map collection</strong></p> 
  <p>You must add both the PDF document to which bookmarks are added and the bookmark XML document to the Map collection. Therefore the Map collection object contains two elements: a PDF document and the bookmark XML document.</p> 
  <p><strong>Set run-time options</strong></p> 
  <p>You can set run-time options that control the behavior of the Assembler service while it performs a job. For example, you can set an option that instructs the Assembler service to continue processing a job if an error is encountered. For information about the run-time options that you can set, see the <span class="code">AssemblerOptionSpec</span> class reference in <a href="http://www.adobe.com/go/learn_aemforms_javadocs_63_en">AEM Forms API Reference</a>.</p> 
  <p><strong>Assemble the PDF document</strong></p> 
  <p>To assemble a PDF document that contains new bookmarks, use the Assembler service’s <span class="code">invokeDDX</span> operation. The reason why you must use the <span class="code">invokeDDX</span> operation as opposed to other Assembler service operations such as <span class="code">invokeOneDocument</span> is because the Assembler service requires a bookmark XML document that is passed within the Map collection object. This object is a parameter of the <span class="code">invokeDDX</span> operation. </p> 
  <p><strong>Save the PDF document that contains bookmarks</strong></p> 
  <p>You must extract the results from the returned map object and save the corresponding PDF document. (See “Extract the results” in <a href="/programming-with-aem-forms/programmatically-assembling-pdf-documents-programmatically programmatically-assembling-pdf-documents-programmatically#programmatically_assembling_pdf_documents">Programmatically Assembling PDF Documents</a>.)</p> 
  <p><strong>See also</strong></p> 
  <p><a href="/programming-with-aem-forms/assembling-pdf-documents-bookmarks-assembling assembling-pdf-documents-bookmarks-assembling#assemble_pdf_documents_with_bookmarks_using_the_java_api">Assemble PDF documents with bookmarks using the Java API</a></p> 
  <p><a href="/programming-with-aem-forms/assembling-pdf-documents-bookmarks-assembling assembling-pdf-documents-bookmarks-assembling#assemble_pdf_documents_with_bookmarks_using_the_web_service_api">Assemble PDF documents with bookmarks using the web service API</a></p> 
  <p><a href="#unresolvedlink-lc-in-invoke-using-java-iu.xml#ws624e3cba99b79e12e69a9941333732bac8-7b4b.2">Including AEM Forms Java library files</a></p> 
  <p><a href="#unresolvedlink-lc-in-invoke-using-java-iu.xml#ws624e3cba99b79e12e69a9941333732bac8-7fd6.2">Setting connection properties</a></p> 
  <p><a href="/programming-with-aem-forms/programmatically-assembling-pdf-documents-programmatically programmatically-assembling-pdf-documents-programmatically#programmatically_assembling_pdf_documents">Programmatically Assembling PDF Documents</a></p> 
  <h2 id="assemble_pdf_documents_with_bookmarks_using_the_java_api">Assemble PDF documents with bookmarks using the Java API</h2> 
  <p></p> 
  <p>Assemble a PDF document with bookmarks by using the Assembler Service API (Java):</p> 
  <ol> 
   <li><p>Include project files. </p><p>Include client JAR files, such as adobe-assembler-client.jar, in your Java project’s class path. </p></li> 
   <li><p>Create a PDF Assembler client. </p> 
    <ul> 
     <li><p>Create a <span class="code">ServiceClientFactory</span> object that contains connection properties. (See <a href="#unresolvedlink-lc-in-invoke-using-java-iu.xml#ws624e3cba99b79e12e69a9941333732bac8-7fd6.2">Setting connection properties</a>.)</p></li> 
     <li><p>Create an <span class="code">AssemblerServiceClient</span> object by using its constructor and passing the <span class="code">ServiceClientFactory</span> object. </p></li> 
    </ul></li> 
   <li><p>Reference an existing DDX document. </p> 
    <ul> 
     <li><p>Create a <span class="code">java.io.FileInputStream</span> object that represents the DDX document by using its constructor and passing a string value that specifies the location of the DDX file.</p></li> 
     <li><p>Create a <span class="code">com.adobe.idp.Document</span> object by using its constructor and passing the <span class="code">java.io.FileInputStream</span> object.</p></li> 
    </ul></li> 
   <li><p>Reference a PDF document to which bookmarks are added. </p> 
    <ul> 
     <li><p>Create a <span class="code">java.io.FileInputStream</span> object by using its constructor and passing the location of the PDF document. </p></li> 
     <li><p>Create a <span class="code">com.adobe.idp.Document</span> object by using its constructor and pass the <span class="code">java.io.FileInputStream</span> object that contains the PDF document. </p></li> 
    </ul></li> 
   <li><p>Reference the bookmark XML document. </p> 
    <ul> 
     <li><p>Create a <span class="code">java.io.FileInputStream</span> object by using its constructor and passing the location of the XML file that represents the bookmark XML document. </p></li> 
     <li><p>Create a <span class="code">com.adobe.idp.Document</span> object and pass the <span class="code">java.io.FileInputStream</span> object that contains the PDF document. </p></li> 
    </ul></li> 
   <li><p>Add the PDF document and the bookmark XML document to a Map collection.</p> 
    <ul> 
     <li><p>Create a <span class="code">java.util.Map</span> object that is used to store both the input PDF document and the bookmark XML document.</p></li> 
     <li><p>Add the input PDF document by invoking the <span class="code">java.util.Map</span> object’s <span class="code">put</span> method and passing the following arguments:</p> 
      <ul> 
       <li><p>A string value that represents the key name. This value must match the value of the PDF source element specified in the DDX document.</p></li> 
       <li><p>A <span class="code">com.adobe.idp.Document</span> object that contains the input PDF document. </p></li> 
      </ul></li> 
     <li><p>Add the bookmark XML document by invoking the <span class="code">java.util.Map</span> object’s <span class="code">put</span> method and passing the following arguments:</p> 
      <ul> 
       <li><p>A string value that represents the key name. This value must match the value of the Bookmarks source element specified in the DDX document.</p></li> 
       <li><p>A <span class="code">com.adobe.idp.Document</span> object that contains the bookmark XML document. </p></li> 
      </ul></li> 
    </ul></li> 
   <li><p>Set run-time options. </p> 
    <ul> 
     <li><p>Create an <span class="code">AssemblerOptionSpec</span> object that stores run-time options by using its constructor.</p></li> 
     <li><p>Set run-time options to meet your business requirements by invoking a method that belongs to the <span class="code">AssemblerOptionSpec</span> object. For example, to instruct the Assembler service to continue processing a job when an error occurs, invoke the <span class="code">AssemblerOptionSpec</span> object’s <span class="code">setFailOnError</span> method and pass <span class="code">false</span>. </p></li> 
    </ul></li> 
   <li><p>Assemble the PDF document. </p><p>Invoke the <span class="code">AssemblerServiceClient</span> object’s <span class="code">invokeDDX</span> method and pass the following required values:</p> 
    <ul> 
     <li><p>A <span class="code">com.adobe.idp.Document</span> object that represents the DDX document to be used</p></li> 
     <li><p>A <span class="code">java.util.Map</span> object that contains both the input PDF document and the bookmark XML document.</p></li> 
     <li><p>A <span class="code">com.adobe.livecycle.assembler.client.AssemblerOptionSpec</span> object that specifies the run-time options, including default font and job log level</p></li> 
    </ul><p>The <span class="code">invokeDDX</span> method returns a <span class="code">com.adobe.livecycle.assembler.client.AssemblerResult</span> object that contains the results of the job and any exceptions that occurred.</p></li> 
   <li><p>Save the PDF document that contains bookmarks.</p><p>To obtain the newly created PDF document, perform the following actions:</p> 
    <ul> 
     <li><p>Invoke the <span class="code">AssemblerResult</span> object’s <span class="code">getDocuments</span> method. This returns a <span class="code">java.util.Map</span> object.</p></li> 
     <li><p>Iterate through the <span class="code">java.util.Map</span> object until you find the resultant <span class="code">com.adobe.idp.Document</span> object. (You can use the PDF result element specified in the DDX document to get the document.) </p></li> 
     <li><p>Invoke the <span class="code">com.adobe.idp.Document</span> object’s <span class="code">copyToFile</span> method to extract the PDF document. </p></li> 
    </ul></li> 
  </ol> 
  <p><strong>See also</strong></p> 
  <p><a href="/programming-with-aem-forms/assembling-pdf-documents-bookmarks-assembling assembling-pdf-documents-bookmarks-assembling#assembling_pdf_documents_with_bookmarks">Assembling PDF Documents with Bookmarks</a></p> 
  <p><a href="#unresolvedlink-lc-qs-assembler-as.xml#ws624e3cba99b79e12e69a9941333732bac8-7f75.2">Quick Start (SOAP mode): Assembling PDF documents with bookmarks using the Java API</a></p> 
  <p><a href="#unresolvedlink-lc-in-invoke-using-java-iu.xml#ws624e3cba99b79e12e69a9941333732bac8-7b4b.2">Including AEM Forms Java library files</a></p> 
  <p><a href="#unresolvedlink-lc-in-invoke-using-java-iu.xml#ws624e3cba99b79e12e69a9941333732bac8-7fd6.2">Setting connection properties</a></p> 
  <h2 id="assemble_pdf_documents_with_bookmarks_using_the_web_service_api">Assemble PDF documents with bookmarks using the web service API</h2> 
  <p></p> 
  <p>Assemble a PDF document with bookmarks by using the Assembler Service API (web service):</p> 
  <ol> 
   <li><p>Include project files.</p><p>Create a Microsoft .NET project that uses MTOM. Ensure that you use the following WSDL definition: <span class="code">http://localhost:8080/soap/services/AssemblerService?WSDL&amp;lc_version=9.0.1</span>. </p> 
    <note> 
     <p>Replace <span class="code">localhost</span> with the IP address of the server hosting AEM Forms.</p> 
    </note></li> 
   <li><p>Create a PDF Assembler client.</p> 
    <ul> 
     <li><p>Create an <span class="code">AssemblerServiceClient</span> object by using its default constructor. </p></li> 
     <li><p>Create an <span class="code">AssemblerServiceClient.Endpoint.Address</span> object by using the <span class="code">System.ServiceModel.EndpointAddress</span> constructor. Pass a string value that specifies the WSDL to the AEM Forms service (for example, <span class="code">http://localhost:8080/soap/services/AssemblerService?blob=mtom</span>). You do not need to use the <span class="code">lc_version</span> attribute. This attribute is used when you create a service reference. </p></li> 
     <li><p>Create a <span class="code">System.ServiceModel.BasicHttpBinding</span> object by getting the value of the <span class="code">AssemblerServiceClient.Endpoint.Binding</span> field. Cast the return value to <span class="code">BasicHttpBinding</span>. </p></li> 
     <li><p>Set the <span class="code">System.ServiceModel.BasicHttpBinding</span> object’s <span class="code">MessageEncoding</span> field to <span class="code">WSMessageEncoding.Mtom</span>. This value ensures that MTOM is used. </p></li> 
     <li><p>Enable basic HTTP authentication by performing the following tasks:</p> 
      <ul> 
       <li><p>Assign the AEM forms user name to the field <span class="code">AssemblerServiceClient.ClientCredentials.UserName.UserName</span>.</p></li> 
       <li><p>Assign the corresponding password value to the field <span class="code">AssemblerServiceClient.ClientCredentials.UserName.Password</span>.</p></li> 
       <li><p>Assign the constant value <span class="code">HttpClientCredentialType.Basic</span> to the field <span class="code">BasicHttpBindingSecurity.Transport.ClientCredentialType</span>. </p></li> 
       <li><p>Assign the constant value <span class="code">BasicHttpSecurityMode.TransportCredentialOnly</span> to the field <span class="code">BasicHttpBindingSecurity.Security.Mode</span>. </p></li> 
      </ul></li> 
    </ul></li> 
   <li><p>Reference an existing DDX document.</p> 
    <ul> 
     <li><p>Create a <span class="code">BLOB</span> object by using its constructor. The <span class="code">BLOB</span> object is used to store the DDX document.</p></li> 
     <li><p>Create a <span class="code">System.IO.FileStream</span> object by invoking its constructor and passing a string value that represents the file location of the DDX document and the mode in which to open the file.</p></li> 
     <li><p>Create a byte array that stores the content of the <span class="code">System.IO.FileStream</span> object. You can determine the size of the byte array by getting the <span class="code">System.IO.FileStream</span> object’s <span class="code">Length</span> property. </p></li> 
     <li><p>Populate the byte array with stream data by invoking the <span class="code">System.IO.FileStream</span> object’s <span class="code">Read</span> method and passing the byte array, the starting position, and the stream length to read.</p></li> 
     <li><p>Populate the <span class="code">BLOB</span> object by assigning its <span class="code">MTOM</span> field with the contents of the byte array.</p></li> 
    </ul></li> 
   <li><p>Reference a PDF document to which bookmarks are added. </p> 
    <ul> 
     <li><p>Create a <span class="code">BLOB</span> object by using its constructor. The <span class="code">BLOB</span> object is used to store the input PDF. </p></li> 
     <li><p>Create a <span class="code">System.IO.FileStream</span> object by invoking its constructor and passing a string value that represents the file location of the input PDF document and the mode in which to open the file.</p></li> 
     <li><p>Create a byte array that stores the content of the <span class="code">System.IO.FileStream</span> object. You can determine the size of the byte array by getting the <span class="code">System.IO.FileStream</span> object’s <span class="code">Length</span> property. </p></li> 
     <li><p>Populate the byte array with stream data by invoking the <span class="code">System.IO.FileStream</span> object’s <span class="code">Read</span> method and passing the byte array, the starting position, and the stream length to read.</p></li> 
     <li><p>Populate the <span class="code">BLOB</span> object by assigning its <span class="code">MTOM</span> field with the contents of the byte array.</p></li> 
    </ul></li> 
   <li><p>Reference the bookmark XML document. </p> 
    <ul> 
     <li><p>Create a <span class="code">BLOB</span> object by using its constructor. The <span class="code">BLOB</span> object is used to store the bookmark XML document. </p></li> 
     <li><p>Create a <span class="code">System.IO.FileStream</span> object by invoking its constructor and passing a string value that represents the file location of the input PDF document and the mode in which to open the file.</p></li> 
     <li><p>Create a byte array that stores the content of the <span class="code">System.IO.FileStream</span> object. You can determine the size of the byte array by getting the <span class="code">System.IO.FileStream</span> object’s <span class="code">Length</span> property. </p></li> 
     <li><p>Populate the byte array with stream data by invoking the <span class="code">System.IO.FileStream</span> object’s <span class="code">Read</span> method and passing the byte array, the starting position, and the stream length to read.</p></li> 
     <li><p>Populate the <span class="code">BLOB</span> object by assigning its <span class="code">MTOM</span> field with the contents of the byte array.</p></li> 
    </ul></li> 
   <li><p>Add the PDF document and the bookmark XML document to a Map collection.</p> 
    <ul> 
     <li><p>Create a<span class="code"> MyMapOf_xsd_string_To_xsd_anyType</span> object. This collection object is used to store the input PDF documents and the bookmark XML document.</p></li> 
     <li><p>For each input PDF document and the bookmark XML document , create a <span class="code">MyMapOf_xsd_string_To_xsd_anyType_Item</span> object.</p></li> 
     <li><p>Assign a string value that represents the key name to the <span class="code">MyMapOf_xsd_string_To_xsd_anyType_Item</span> object's <span class="code">key</span> field. This value must match the value of the PDF source element specified in the DDX document. </p></li> 
     <li><p>Assign the <span class="code">BLOB</span> object that stores the PDF document to the <span class="code">MyMapOf_xsd_string_To_xsd_anyType_Item</span> object's <span class="code">value</span> field. </p></li> 
     <li><p>Add the <span class="code">MyMapOf_xsd_string_To_xsd_anyType_Item</span> object to the <span class="code">MyMapOf_xsd_string_To_xsd_anyType</span> object. Invoke the <span class="code">MyMapOf_xsd_string_To_xsd_anyType</span> object's <span class="code">Add</span> method and pass the <span class="code">MyMapOf_xsd_string_To_xsd_anyType</span> object. (Perform this task for each input PDF document and the bookmark XML document.)</p></li> 
    </ul></li> 
   <li><p>Set run-time options. </p> 
    <ul> 
     <li><p>Create an <span class="code">AssemblerOptionSpec</span> object that stores run-time options by using its constructor.</p></li> 
     <li><p>Set run-time options to meet your business requirements by assigning a value to a data member that belongs to the <span class="code">AssemblerOptionSpec</span> object. For example, to instruct the Assembler service to continue processing a job when an error occurs, assign <span class="code">false</span> to the <span class="code">AssemblerOptionSpec</span> object’s <span class="code">failOnError</span> data member. </p></li> 
    </ul></li> 
   <li><p>Assemble the PDF document. </p><p>Invoke the <span class="code">AssemblerServiceClient</span> object’s <span class="code">invokeDDX</span> method and pass the following values:</p> 
    <ul> 
     <li><p>A <span class="code">BLOB</span> object that represents the DDX document</p></li> 
     <li><p>The <span class="code">MyMapOf_xsd_string_To_xsd_anyType</span> array that contains the input documents</p></li> 
     <li><p>An <span class="code">AssemblerOptionSpec</span> object that specifies run-time options</p></li> 
    </ul><p>The <span class="code">invokeDDX</span> method returns an <span class="code">AssemblerResult</span> object that contains the results of the job and any exceptions that may have occurred. </p></li> 
   <li><p>Save the PDF document that contains bookmarks. </p><p>To obtain the newly created PDF document, perform the following actions:</p> 
    <ul> 
     <li><p>Access the <span class="code">AssemblerResult</span> object’s <span class="code">documents</span> field, which is a <span class="code">Map</span> object that contains the result PDF documents.</p></li> 
     <li><p>Iterate through the <span class="code">Map</span> object until you find the key that matches the name of the resultant document. Then cast that array member’s <span class="code">value</span> to a <span class="code">BLOB</span>.</p></li> 
     <li><p>Extract the binary data that represents the PDF document by accessing its <span class="code">BLOB</span> object’s <span class="code">MTOM</span> field. This returns an array of bytes that you can write out to a PDF file.</p></li> 
    </ul></li> 
  </ol> 
  <p><strong>See also</strong></p> 
  <p><a href="/programming-with-aem-forms/assembling-pdf-documents-bookmarks-assembling assembling-pdf-documents-bookmarks-assembling#assembling_pdf_documents_with_bookmarks">Assembling PDF Documents with Bookmarks</a></p> 
  <p><a href="#unresolvedlink-lc-qs-assembler-as.xml#ws624e3cba99b79e12e69a9941333732bac8-7f74.2">Quick Start (MTOM): Assembling PDF documents with bookmarks using the web service API</a></p> 
  <p><a href="#unresolvedlink-lc-in-invoke-using-web-services-iu.xml#ws624e3cba99b79e12e69a9941333732bac8-7fe7.2">Invoking AEM Forms using MTOM</a></p> 
 </body> 
</html>