<?xml version="1.1" encoding="UTF-8" standalone="yes"?> 
<html> 
 <head> 
  <meta content="AEMForms/6.1/AdminHelp/WS83e2a195e488af79746c848012e783b551a-8000.2,AEMForms/6.1/AdminHelp/WS83e2a195e488af79746c848012e783b551a-7fff.2,AEMForms/6.1/AdminHelp/WS83e2a195e488af79746c848012e783b551a-7ffe.2,AEMForms/6.1/AdminHelp/WS83e2a195e488af79746c848012e783b551a-7ffd.2,AEMForms/6.1/AdminHelp/WS83e2a195e488af79746c848012e783b551a-7ffc.2,AEMForms/6.1/AdminHelp/WS83e2a195e488af79746c848012e783b551a-7ffb.2,AEMForms/6.1/AdminHelp/WS83e2a195e488af79746c848012e783b551a-7ffa.2" name="cq:gepId" /> 
  <meta content="admin" name="contentOwner" /> 
  <meta content="light" name="heroGradient" /> 
  <meta content="not_checked" name="acrolinxStatus" /> 
  <meta content="2017-10-31T16:32:11.376-0400" name="lastPublishExternalDate" /> 
  <meta content="Just-in-time user provisioning" name="jcr:title" /> 
  <meta content="content_type:reference;geptopics:SG_AEMFORMS/categories/setting_up_and_organizing_users;products:SG_EXPERIENCEMANAGER/6.4/FORMS" name="cq:tags" /> 
  <meta content="wmyersta@adobe.com" name="lr_lastReplicatedBy" /> 
  <meta content="2018-04-26T04:23:20.223-0400" name="cq:lastModified" /> 
  <meta content="admin" name="lr_creator" /> 
  <meta content="Activate" name="cq:lastReplicationAction" /> 
  <meta content="head1_20111213" name="gep_conversion_script_version" /> 
  <meta content="Use just-in-time provisioning to add users to User Management after successfull authentication and dynamically assign relevant roles and groups to the new user." name="seoDescription" /> 
  <meta content="9dd64a23-a659-4fac-9fb5-a45b070aa3cc" name="jcr:predecessors" /> 
  <meta content="false" name="isReadyForLocalization" /> 
  <meta content="75346893-071e-4c2e-affd-3d8ed04523ed" name="jcr:uuid" /> 
  <meta content="admin" name="lr_lastModifiedBy" /> 
  <meta content="2018-04-26T04:23:20.223-0400" name="locHandOffDate" /> 
  <meta content="admin" name="jcr:createdBy" /> 
  <meta content="video" name="pageLayout" /> 
  <meta content="2016-05-31T07:01:53.279-0400" name="acrolinxDate" /> 
  <meta content="2016-02-05T03:27:00.000-0500" name="topicBrowsingSortDate" /> 
  <meta content="products:SG_EXPERIENCEMANAGER/6.4/FORMS" name="primaryProductTag" /> 
  <meta content="2016-02-05T03:27:00.000-0500" name="sortDate" /> 
  <meta content="help/components/pages/article-3" name="sling:resourceType" /> 
  <meta content="carlino" name="cq:lastReplicatedBy" /> 
  <meta content="55" name="acrolinxSentences" /> 
  <meta content="false" name="doNotLocalize" /> 
  <meta content="2017-12-01T19:05:54.307-0500" name="jcr:created" /> 
  <meta content="left" name="sideColumn" /> 
  <meta content="2017-10-31T16:32:11.376-0400" name="publishExternalDate" /> 
  <meta content="" name="jcr:baseVersion" /> 
  <meta content="vishgupt" name="acrolinxLastCheckedBy" /> 
  <meta content="red" name="acrolinxPageStatus" /> 
  <meta content="true" name="jcr:isCheckedOut" /> 
  <meta content="http://checkstyle.corp.adobe.com:8031/output/en/just_in_time_user_provisioning_admin_5e12de0b318c6865_2334_report.xml" name="acrolinxReportURL" /> 
  <meta content="2018-04-03T09:10:13.557-0400" name="cq:lastReplicated" /> 
  <meta content="carlino" name="cq:lastModifiedBy" /> 
  <meta content="2016-02-05T03:27:26.117-0500" name="lr_lastModified" /> 
  <meta content="https://helpx.adobe.com/experience-manager/6-3/forms/using/admin-help/just-in-time-user-provisioning.html" name="publishExternalURL" /> 
  <meta content="" name="jcr:primaryType" /> 
  <meta content="2016-04-20T10:05:38.727-0400" name="firstPublishExternalDate" /> 
  <meta content="/etc/designs/help" name="cq:designPath" /> 
  <meta content="818" name="acrolinxWords" /> 
  <meta content="" name="jcr:versionHistory" /> 
  <meta content="mix:versionable" name="jcr:mixinTypes" /> 
  <meta content="/apps/help/templates/article-3" name="cq:template" /> 
  <meta content="Just-in-time user provisioning" name="navTitle" /> 
  <meta content="en_us" name="jcr:language" /> 
 </head> 
 <body> 
  <p>AEM forms supports just-in-time provisioning of users that don’t yet exist in User Management. With just-in-time provisioning, users are automatically added to User Management after their credentials are successfully authenticated. In addition, relevant roles and groups are assigned dynamically to the new user.</p> 
  <h2 id="need_for_just_in_time_user_provisioning">Need for just-in-time user provisioning</h2> 
  <p></p> 
  <p>This is how traditional authentication works:</p> 
  <ol> 
   <li><p>When a user tries to log in to AEM forms, User Management passes the user’s credentials sequentially to all available authentication providers. (Login credentials include a username/password combination, Kerberos ticket, PKCS7 signature, and so on.)</p></li> 
   <li><p>The authentication provider validates the credentials. </p></li> 
   <li><p>The authentication provider then checks whether the user exists in the User Management database. The following results are possible:</p><p><strong>Exists:</strong> If the user is current and unlocked, User Management returns authentication success. However, if the user is not current or is locked, User Management returns authentication failure.</p><p><strong>Does not exist:</strong> User Management returns authentication failure.</p><p><strong>Invalid:</strong> User Management returns authentication failure.</p></li> 
   <li><p>The result returned by the authentication provider is evaluated. If the authentication provider returned authentication success, the user is allowed to log in. Otherwise, User Management checks with the next authentication provider (steps 2-3).</p></li> 
   <li><p>Authentication failure is returned if no available authentication provider validates the user credentials.</p></li> 
  </ol> 
  <p>When just-in-time provisioning is implemented, a new user is created dynamically in User Management if one of the authentication providers validates the user’s credentials. (After step 3 in the traditional authentication procedure, above.)</p> 
  <h2 id="implement_just_in_time_user_provisioning">Implement just-in-time user provisioning</h2> 
  <p></p> 
  <h3 id="apis_for_just_in_time_provisioning">APIs for just-in-time provisioning</h3> 
  <p></p> 
  <p>AEM forms provides the following APIs for just-in-time provisioning:</p> 
  <codeblock gutter="true" class="syntax as3">
    package&amp;nbsp;com.adobe.idp.um.spi.authentication&amp;nbsp;&amp;nbsp;;&amp;nbsp;!!discoiqbr!!publ&amp;nbsp;ic&amp;nbsp;interface&amp;nbsp;IdentityCreator&amp;nbsp;{&amp;nbsp;!!discoiqbr!!/**&amp;nbsp;&amp;nbsp;&amp;nbsp;!!discoiqbr!!*&amp;nbsp;Tries&amp;nbsp;&amp;nbsp;to&amp;nbsp;create&amp;nbsp;a&amp;nbsp;user&amp;nbsp;with&amp;nbsp;the&amp;nbsp;&amp;nbsp;in&amp;nbsp;formation&amp;nbsp;&amp;nbsp;provided&amp;nbsp;in&amp;nbsp;the&amp;nbsp;&lt;code&gt;UserProvisioningBO&lt;/code&gt;&amp;nbsp;object.&amp;nbsp;!!discoiqbr!!*&amp;nbsp;If&amp;nbsp;the&amp;nbsp;user&amp;nbsp;is&amp;nbsp;successfully&amp;nbsp;created,&amp;nbsp;a&amp;nbsp;valid&amp;nbsp;AuthResponse&amp;nbsp;is&amp;nbsp;returned&amp;nbsp;along&amp;nbsp;with&amp;nbsp;the&amp;nbsp;information&amp;nbsp;using&amp;nbsp;which&amp;nbsp;the&amp;nbsp;user&amp;nbsp;was&amp;nbsp;created.&amp;nbsp;!!discoiqbr!!*&amp;nbsp;It&amp;nbsp;is&amp;nbsp;the&amp;nbsp;responsibility&amp;nbsp;of&amp;nbsp;the&amp;nbsp;IdentityCreator&amp;nbsp;to&amp;nbsp;set&amp;nbsp;the&amp;nbsp;User&amp;nbsp;obje&amp;nbsp;ct&amp;nbsp;&amp;nbsp;in&amp;nbsp;the&amp;nbsp;cre&amp;nbsp;dential&amp;nbsp;map&amp;nbsp;with&amp;nbsp;th&amp;nbsp;e&amp;nbsp;&amp;nbsp;ke&amp;nbsp;y&amp;nbsp;&amp;nbsp;&lt;code&gt;UMA&amp;nbsp;u&amp;nbsp;thenticationUtil.authenticatedUserKey&lt;/code&gt;&amp;nbsp;!!discoiqbr!!*&amp;nbsp;The&amp;nbsp;credentials&amp;nbsp;are&amp;nbsp;available&amp;nbsp;in&amp;nbsp;the&amp;nbsp;&lt;code&gt;UserProvisioningBO&lt;/code&gt;&amp;nbsp;object&amp;nbsp;in&amp;nbsp;the&amp;nbsp;'credentials'&amp;nbsp;property.&amp;nbsp;!!discoiqbr!!*&amp;nbsp;If&amp;nbsp;the&amp;nbsp;IdentityCreator&amp;nbsp;is&amp;nbsp;unable&amp;nbsp;to&amp;nbsp;create&amp;nbsp;a&amp;nbsp;user&amp;nbsp;due&amp;nbsp;to&amp;nbsp;any&amp;nbsp;reason,&amp;nbsp;it&amp;nbsp;returns&amp;nbsp;&lt;code&gt;null&lt;/code&gt;&amp;nbsp;!!discoiqbr!!*&amp;nbsp;@param&amp;nbsp;userBO&amp;nbsp;An&amp;nbsp;object&amp;nbsp;of&amp;nbsp;&lt;code&gt;com.adobe.&amp;nbsp;i&amp;nbsp;dp.um&amp;nbsp;.&amp;nbsp;spi.authenti&amp;nbsp;c&amp;nbsp;ationUserProvisioningBO&lt;/code&gt;&amp;nbsp;!!discoiqbr!!*&amp;nbsp;@return&amp;nbsp;*/public&amp;nbsp;AuthResponse&amp;nbsp;create(UserProvisioningBO&amp;nbsp;userBO);&amp;nbsp;!!discoiqbr!!/**&amp;nbsp;!!discoiqbr!!*&amp;nbsp;Returns&amp;nbsp;the&amp;nbsp;name&amp;nbsp;of&amp;nbsp;the&amp;nbsp;IdentityCreator&amp;nbsp;which&amp;nbsp;will&amp;nbsp;be&amp;nbsp;registered&amp;nbsp;in&amp;nbsp;preferences.&amp;nbsp;!!discoiqbr!!*&amp;nbsp;This&amp;nbsp;name&amp;nbsp;is&amp;nbsp;used&amp;nbsp;to&amp;nbsp;associate&amp;nbsp;the&amp;nbsp;IdentityProvider&amp;nbsp;with&amp;nbsp;the&amp;nbsp;Auth&amp;nbsp;Provider&amp;nbsp;Configuration&amp;nbsp;in&amp;nbsp;the&amp;nbsp;domain.&amp;nbsp;!!discoiqbr!!*&amp;nbsp;@return&amp;nbsp;The&amp;nbsp;name&amp;nbsp;of&amp;nbsp;the&amp;nbsp;Identity&amp;nbsp;Creator&amp;nbsp;which&amp;nbsp;is&amp;nbsp;recognized&amp;nbsp;in&amp;nbsp;Configuration.&amp;nbsp;!!discoiqbr!!*/&amp;nbsp;!!discoiqbr!!public&amp;nbsp;String&amp;nbsp;getName();&amp;nbsp;!!discoiqbr!!}&amp;nbsp;!!discoiqbr!!package&amp;nbsp;com.adobe.idp.um.spi.authentication;&amp;nbsp;!!discoiqbr!!import&amp;nbsp;com.adobe.idp.um.api.infomodel.User;&amp;nbsp;!!discoiqbr!!public&amp;nbsp;interface&amp;nbsp;AssignmentProvider&amp;nbsp;{&amp;nbsp;!!discoiqbr!!/**&amp;nbsp;!!discoiqbr!!*&amp;nbsp;Tries&amp;nbsp;to&amp;nbsp;assign&amp;nbsp;roles&amp;nbsp;or&amp;nbsp;permissions&amp;nbsp;or&amp;nbsp;group&amp;nbsp;memberships&amp;nbsp;to&amp;nbsp;users&amp;nbsp;created&amp;nbsp;via&amp;nbsp;Just-in-time&amp;nbsp;provisioning.&amp;nbsp;!!discoiqbr!!*&amp;nbsp;@param&amp;nbsp;user&amp;nbsp;The&amp;nbsp;User&amp;nbsp;created&amp;nbsp;via&amp;nbsp;the&amp;nbsp;Just-in-time&amp;nbsp;provisioning&amp;nbsp;process.&amp;nbsp;!!discoiqbr!!*&amp;nbsp;@return&amp;nbsp;a&amp;nbsp;Boolean&amp;nbsp;flag&amp;nbsp;indicating&amp;nbsp;whether&amp;nbsp;the&amp;nbsp;assignment&amp;nbsp;was&amp;nbsp;successful&amp;nbsp;or&amp;nbsp;not.&amp;nbsp;!!discoiqbr!!*/&amp;nbsp;!!discoiqbr!!public&amp;nbsp;Boolean&amp;nbsp;assign(User&amp;nbsp;user);&amp;nbsp;!!discoiqbr!!/**&amp;nbsp;!!discoiqbr!!*&amp;nbsp;Returns&amp;nbsp;the&amp;nbsp;name&amp;nbsp;of&amp;nbsp;the&amp;nbsp;AssignmentProvider&amp;nbsp;through&amp;nbsp;which&amp;nbsp;it&amp;nbsp;is&amp;nbsp;registered&amp;nbsp;under&amp;nbsp;preferences.&amp;nbsp;!!discoiqbr!!*&amp;nbsp;This&amp;nbsp;name&amp;nbsp;is&amp;nbsp;used&amp;nbsp;to&amp;nbsp;associate&amp;nbsp;the&amp;nbsp;AssignmentProvider&amp;nbsp;with&amp;nbsp;the&amp;nbsp;Auth&amp;nbsp;Provider&amp;nbsp;Configuration&amp;nbsp;in&amp;nbsp;the&amp;nbsp;domain.&amp;nbsp;!!discoiqbr!!*&amp;nbsp;@return&amp;nbsp;The&amp;nbsp;name&amp;nbsp;of&amp;nbsp;the&amp;nbsp;AssignmentProvider&amp;nbsp;which&amp;nbsp;is&amp;nbsp;recognized&amp;nbsp;in&amp;nbsp;Configuration.&amp;nbsp;!!discoiqbr!!*/public&amp;nbsp;String&amp;nbsp;getName();&amp;nbsp;!!discoiqbr!!} 
  </codeblock> 
  <h3 id="considerations_while_creating_a_just_in_time_enabled_domain">Considerations while creating a just-in-time-enabled domain</h3> 
  <p></p> 
  <ul> 
   <li><p>While creating a custom <span class="code">IdentityCreator</span> for a hybrid domain, ensure that a dummy password is specified for the local user. Do not leave this password field empty.</p></li> 
   <li><p>Recommendation: Use <span class="code">DomainSpecificAuthentication</span> to validate user credentials against a specific domain.</p></li> 
  </ul> 
  <h3 id="create_a_just_in_time_enabled_domain">Create a just-in-time-enabled domain</h3> 
  <p></p> 
  <ol> 
   <li><p>Write a DSC implementing the APIs in the “APIs for just-in-time provisioning” section.</p></li> 
   <li><p>Deploy the DSC to the forms server.</p></li> 
   <li><p>Create a just-in-time-enabled domain:</p> 
    <ul> 
     <li><p>In Administration Console, click Settings &amp;gt; User Management &amp;gt; Domain Management &amp;gt; New Enterprise Domain.</p> </li> 
     <li><p>Configure the domain and select Enable Just In Time Provisioning. (See <a href="/forms/using/admin-help/topics/setting-up-and-managing-domains" target="_blank">Setting up and managing domains</a>.</p> </li> 
     <li><p>Add authentication providers. While adding authentication providers, on the New Authentication screen, select a registered Identity Creator and Assignment Provider.</p> </li> 
    </ul> </li> 
   <li><p>Save the new domain.</p></li> 
  </ol> 
  <h2 id="behind_the_scenes">Behind the scenes</h2> 
  <p></p> 
  <p>Assume that a user is trying to log in to AEM forms and an authentication provider accepts their user credentials. If the user doesn’t yet exist in the User Management database, the identity check for the user fails. AEM forms now performs the following actions: </p> 
  <ol> 
   <li><p>Create a <span class="code">UserProvisioningBO</span> object with the authentication data and place it in a credential map.</p></li> 
   <li><p>Based on domain information returned by <span class="code">UserProvisioningBO</span>, fetch and invoke the registered <span class="code">IdentityCreator</span> and <span class="code">AssignmentProvider</span> for the domain.</p></li> 
   <li><p>Invoke <span class="code">IdentityCreator</span>. If it returns a successful <span class="code">AuthResponse</span>, extract <span class="code">UserInfo</span> from the credential map. Pass it to the <span class="code">AssignmentProvider</span> for group/role assignment and any other post-processing after the user is created.</p></li> 
   <li><p>If the user is created successfully, return the login attempt by the user as successful.</p></li> 
   <li><p>For hybrid domains, pull user information from the authentication data provided to the authentication provider. If this information is fetched successfully, create the user on-the-fly.</p></li> 
  </ol> 
  <note> 
   <p>The just-in-time provisioning feature ships with a default implementation of <span class="code">IdentityCreator</span> that you can use to dynamically create users. Users are created with the information associated with the directories in the domain.</p> 
  </note> 
 </body> 
</html>