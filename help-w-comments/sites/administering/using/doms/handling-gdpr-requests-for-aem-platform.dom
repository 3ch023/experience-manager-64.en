<?xml version="1.1" encoding="UTF-8" standalone="yes"?> 
<html> 
 <head> 
  <meta content="sarchiz" name="contentOwner" /> 
  <meta content="d4685536-c2ca-49c2-9342-fcd72e691cc3" name="jcr:predecessors" /> 
  <meta content="a8183df1-0e36-48ba-a564-97663df0acfa" name="jcr:uuid" /> 
  <meta content="Activate" name="cq:lastReplicationAction" /> 
  <meta content="2018-05-25T11:35:05.416-0400" name="cq:lastModified" /> 
  <meta content="/apps/help/templates/article-3" name="cq:template" /> 
  <meta content="mix:versionable" name="jcr:mixinTypes" /> 
  <meta content="" name="jcr:primaryType" /> 
  <meta content="2018-04-04T07:30:10.910-0400" name="jcr:created" /> 
  <meta content="true" name="jcr:isCheckedOut" /> 
  <meta content="https://helpx.adobe.com/experience-manager/6-4/sites/administering/using/handling-gdpr-requests-for-aem-platform.html" name="publishExternalURL" /> 
  <meta content="2018-05-24T06:30:48.935-0400" name="lastPublishExternalDate" /> 
  <meta content="en_us" name="jcr:language" /> 
  <meta content="false" name="isReadyForLocalization" /> 
  <meta content="aheimoz@adobe.com" name="lr_lastReplicatedBy" /> 
  <meta content="help/components/pages/article-3" name="sling:resourceType" /> 
  <meta content="admin" name="jcr:createdBy" /> 
  <meta content="Handling GDPR Requests for the AEM Foundation" name="jcr:title" /> 
  <meta content="" name="jcr:versionHistory" /> 
  <meta content="2018-05-24T06:30:48.935-0400" name="publishExternalDate" /> 
  <meta content="/etc/designs/help" name="cq:designPath" /> 
  <meta content="2018-05-25T11:35:05.416-0400" name="locHandOffDate" /> 
  <meta content="" name="jcr:baseVersion" /> 
  <meta content="2018-05-24T06:30:48.953-0400" name="cq:lastReplicated" /> 
  <meta content="carlino" name="cq:lastModifiedBy" /> 
  <meta content="en" name="pageCreatedAt" /> 
  <meta content="aheimoz" name="cq:lastReplicatedBy" /> 
  <meta content="2018-04-03T08:19:08.736-0400" name="firstPublishExternalDate" /> 
  <meta content="2018-05-24T06:30:48.935-0400" name="topicBrowsingSortDate" /> 
 </head> 
 <body> 
  <h2>AEM Foundation GDPR support</h2> 
  <p>At the AEM Foundation level, the Personal Data that is stored 
   <g class="gr_ gr_4 gr-alert gr_spell gr_inline_cards gr_run_anim ContextualSpelling ins-del" data-gr-id="4" id="4">
     is 
   </g> the User Profile. Therefore, the information in this article primarily addresses how to access and delete user profiles, to address the GDPR Access and Delete requests respectively.</p> 
  <p> </p> 
  <draft-comment lastModifiedBy="wmitchel" lastModifiedDate="2018-05-14T10:37:37.136-0400" type="annotation">
    change "Personally Identifiable Information (PII in short) data" to "Personal Data". 
  </draft-comment> 
  <h2>Accessing a User Profile</h2> 
  <h3>Manual Steps</h3> 
  <ol> 
   <li><p>Open the User Administration console, by browsing to <strong>Settings - Security - Users </strong>or by browsing directly to <em>http://serveraddress:serverport/libs/granite/security/content/useradmin.html</em></p> <img imageRotate="0" src="assets/useradmin2.png" /></li> 
   <li><p>Then, search for the user in question by typing the name in the search bar at the top of the page:<br /> </p> <img imageRotate="0" src="assets/usersearch.png" /></li> 
   <li><p>Finally, open the user profile by clicking it, then check under the <strong>Details</strong> tab.</p> <img imageRotate="0" src="assets/userprofile_small.png" /></li> 
  </ol> 
  <h3>HTTP API</h3> 
  <p>As mentioned, Adobe provides APIs for accessing user data, in order to facilitate automation. There are several types of APIs which you can use:<br /> </p> 
  <p><strong>UserProperties API</strong></p> 
  <codeblock gutter="true" class="syntax shell">
    curl&amp;nbsp;-u&amp;nbsp;user:password&amp;nbsp;http://localhost:4502/libs/granite/security/search/profile.userproperties.json\?authId\=cavery 
  </codeblock> 
  <p><strong>Sling API</strong></p> 
  <p><em>Discovering the user home:</em></p> 
  <codeblock gutter="true" class="syntax xml">
    curl&amp;nbsp;-g&amp;nbsp;-u&amp;nbsp;user:password&amp;nbsp;'http://localhost:4502/libs/granite/security/search/authorizables.json?query={"condition":[{"named":"cavery"}]}'!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{"authorizables":[{"type":"user","authorizableId_xss":"cavery","authorizableId":"cavery","name_xss":"Carlene&amp;nbsp;Avery","name":"Carlene&amp;nbsp;Avery","home":"/home/users/we-retail/DSCP-athB1NYLBXvdTuN"}],"total":1} 
  </codeblock> 
  <p><em>Retrieving user data</em></p> 
  <p><br /> Using the node path from the home property of the JSON payload returned from the above command:</p> 
  <codeblock gutter="true" class="syntax shell">
    curl&amp;nbsp;-u&amp;nbsp;user:password&amp;nbsp;&amp;nbsp;'http://localhost:4502/home/users/we-retail/DSCP-athB1NYLBXvdTuN/profile.-1.json' 
  </codeblock> 
  <codeblock gutter="true" class="syntax shell">
    curl&amp;nbsp;-u&amp;nbsp;user:password&amp;nbsp;&amp;nbsp;'http://localhost:4502/home/users/we-retail/DSCP-athB1NYLBXvdTuN/profiles.-1.json' 
  </codeblock> 
  <draft-comment color="yellow" lastModifiedBy="taneja" lastModifiedDate="2018-03-16T03:56:55.484-0400" prevFirstName="Arun" prevLastName="Taneja" type="remark"> 
   <p>Should probably clarify in these sections, what user:password refers to...I will try to get some info on this.</p> 
  </draft-comment> 
  <h2>Disabling a User and Deleting the Associated Profiles</h2> 
  <h3>Disable User</h3> 
  <ol> 
   <li><p>Open the User Administration console and search for the user in question, as described above.</p> </li> 
   <li><p>Hover over the user and click the select icon. The profile will turn grey indicating that it is selected.<br /> </p> </li> 
   <li><p>Press the Disable button in the upper menu to disable the user:</p> <img imageRotate="0" src="assets/userdisable.png" /></li> 
   <li><p>Fianlly, confirm the action:</p> <img imageRotate="0" src="assets/image2018-2-6_1-40-58.png" /><p>The user interface will then indicate that the user has been deactivated by greying out and adding a lock to the profile card:<br /><br /> </p> <img imageRotate="0" src="assets/disableduser.png" /></li> 
  </ol> 
  <h3>Delete User Profile Information</h3> 
  <ol> 
   <li><p>Log in to CRXDE Lite, then search for the <span class="code">userId</span>: </p> <img imageRotate="0" src="assets/image2018-2-6_1-57-11.png" /></li> 
   <li><p>Open the user node which is located under <span class="code">/home/users</span> by default:</p> <img imageRotate="0" src="assets/image2018-2-6_1-58-25.png" /></li> 
   <li><p>Delete profile nodes and all their children. There are two formats to the profile nodes, depeding on the AEM version:</p> 
    <ol> 
     <li>The default private profile under <span class="code">/profile</span><br /> </li> 
     <li><span class="code">/profiles</span>, for new profiles created using AEM 6.4.</li> 
    </ol> <img imageRotate="0" src="assets/image2018-2-6_2-0-4.png" /></li> 
  </ol> 
  <h3>HTTP API</h3> 
  <p>The following procedures use the <span class="code">curl</span> command line tool to illustrate how to disable the user with the <strong>cavery</strong> <span class="code">userId</span> and delete her profiles available at the default location.</p> 
  <ul> 
   <li><em>Discovering the user home</em></li> 
  </ul> 
  <codeblock gutter="true" class="syntax shell">
    curl&amp;nbsp;-g&amp;nbsp;-u&amp;nbsp;user:password&amp;nbsp;'http://localhost:4502/libs/granite/security/search/authorizables.json?query={"condition":[{"named":"cavery"}]}'!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{"authorizables":[{"type":"user","authorizableId_xss":"cavery","authorizableId":"cavery","name_xss":"Carlene&amp;nbsp;Avery","name":"Carlene&amp;nbsp;Avery","home":"/home/users/we-retail/DSCP-athB1NYLBXvdTuN"}],"total":1} 
  </codeblock> 
  <ul> 
   <li><em>Disabling the user</em></li> 
  </ul> 
  <p>Using the node path from the home property of the JSON payload returned from the above command:</p> 
  <codeblock gutter="true" class="syntax shell">
    curl&amp;nbsp;-X&amp;nbsp;POST&amp;nbsp;-u&amp;nbsp;user:password&amp;nbsp;-FdisableUser="describe&amp;nbsp;the&amp;nbsp;reasons&amp;nbsp;for&amp;nbsp;disabling&amp;nbsp;this&amp;nbsp;user&amp;nbsp;(GDPR&amp;nbsp;in&amp;nbsp;this&amp;nbsp;case)"&amp;nbsp;'http://localhost:4502/home/users/we-retail/DSCP-athB1NYLBXvdTuN.rw.userprops.html' 
  </codeblock> 
  <ul> 
   <li><em>Deleting user profile(s)</em></li> 
  </ul> 
  <p>Using the node path from the home property of the JSON payload returned from the account discovery command and the known out of the box profile node locations:</p> 
  <codeblock gutter="true" class="syntax shell">
    curl&amp;nbsp;-X&amp;nbsp;POST&amp;nbsp;-u&amp;nbsp;user:password&amp;nbsp;-H&amp;nbsp;"Accept:&amp;nbsp;application/json,**/**;q=0.9"&amp;nbsp;-d&amp;nbsp;':operation=delete'&amp;nbsp;'http://localhost:4502/home/users/we-retail/DSCP-athB1NYLBXvdTuN/profile' 
  </codeblock> 
  <codeblock gutter="true" class="syntax shell">
    curl&amp;nbsp;-X&amp;nbsp;POST&amp;nbsp;-u&amp;nbsp;user:password&amp;nbsp;-H&amp;nbsp;"Accept:&amp;nbsp;application/json,**/**;q=0.9"&amp;nbsp;-d&amp;nbsp;':operation=delete'&amp;nbsp;'http://localhost:4502/home/users/we-retail/DSCP-athB1NYLBXvdTuN/profile' 
  </codeblock> 
 </body> 
</html>