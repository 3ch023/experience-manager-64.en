<?xml version="1.1" encoding="UTF-8" standalone="yes"?> 
<html> 
 <head> 
  <meta content="2017-10-12T21:46:58.665-0400" name="qaDate" /> 
  <meta content="products:SG_EXPERIENCEMANAGER/6.4/SITES;topic_tags:extending-aem;content_type:reference" name="cq:tags" /> 
  <meta content="en_us" name="jcr:language" /> 
  <meta content="" name="jcr:versionHistory" /> 
  <meta content="2018-05-08T12:43:18.171-0400" name="locHandOffDate" /> 
  <meta content="/apps/help/templates/article-3" name="cq:template" /> 
  <meta content="products:SG_EXPERIENCEMANAGER/6.4/SITES" name="primaryProductTag" /> 
  <meta content="true" name="jcr:isCheckedOut" /> 
  <meta content="remove-legacypath-6-1" name="jcr:lastModifiedBy" /> 
  <meta content="2017-10-31T16:16:44.698-0400" name="publishExternalDate" /> 
  <meta content="2017-10-12T21:46:58.665-0400" name="mwpw_migration_script_version" /> 
  <meta content="/etc/designs/help" name="cq:designPath" /> 
  <meta content="help/components/pages/article-3" name="sling:resourceType" /> 
  <meta content="Activate" name="cq:lastReplicationAction" /> 
  <meta content="2018-04-03T09:00:43.659-0400" name="cq:lastReplicated" /> 
  <meta content="Cloud Service Configurations" name="navTitle" /> 
  <meta content="" name="jcr:baseVersion" /> 
  <meta content="User" name="contentOwner" /> 
  <meta content="2017-10-31T16:16:44.698-0400" name="topicBrowsingSortDate" /> 
  <meta content="You can extend the existing instances to create your own configurations" name="seoDescription" /> 
  <meta content="/content/help/en/experience-manager/6-4/sites/developing/morehelp/extending-aem;/content/help/en/experience-manager/6-4/sites/developing/morehelp/extending-aem" name="moreHelpPaths" /> 
  <meta content="carlino" name="cq:lastReplicatedBy" /> 
  <meta content="carlino" name="cq:lastModifiedBy" /> 
  <meta content="2017-10-31T16:16:44.698-0400" name="lastPublishExternalDate" /> 
  <meta content="false" name="isReadyForLocalization" /> 
  <meta content="" name="jcr:primaryType" /> 
  <meta content="admin" name="jcr:createdBy" /> 
  <meta content="https://helpx.adobe.com/experience-manager/6-3/sites/developing/using/extending-cloud-config.html" name="publishExternalURL" /> 
  <meta content="mix:versionable" name="jcr:mixinTypes" /> 
  <meta content="/content/docs/en/aem/6-3/develop/extending/cloud-service-configurations" name="qaNotes" /> 
  <meta content="audience:developing" name="primaryAudienceTag" /> 
  <meta content="b998ca90-f8e1-4348-8f46-f18863b1783d" name="jcr:predecessors" /> 
  <meta content="Cloud Service Configurations" name="jcr:title" /> 
  <meta content="49f05df9-410e-4ad7-b6a2-f68a717ca71c" name="jcr:uuid" /> 
  <meta content="2017-10-31T16:16:44.698-0400" name="firstPublishExternalDate" /> 
  <meta content="2017-12-01T19:02:46.368-0500" name="jcr:created" /> 
  <meta content="Cloud Service Configurations" name="seoTitle" /> 
  <meta content="wmyersta@adobe.com" name="lr_lastReplicatedBy" /> 
  <meta content="2018-05-08T12:43:18.173-0400" name="cq:lastModified" /> 
 </head> 
 <body> 
  <p>Configurations are designed to provide the logic and structure for storing service configurations.</p> 
  <p>You can extend the existing instances to create your own configurations.</p> 
  <h3>Concepts</h3> 
  <p>The principles used in developing the configurations have been based on the following concepts:</p> 
  <ul> 
   <li>Services/Adapters are used to retrieve the configuration(s).</li> 
   <li>Configurations (e.g. properties/paragraphs) are inherited from the parent(s).</li> 
   <li>Referenced from analytics node(s) by path.</li> 
   <li>Easily extensible.</li> 
   <li>Has the flexibility to cater for more complex configurations, such as <a href="../../../sites/administering/using/marketing-cloud.md#integratingwithsitecatalyst">SiteCatalyst</a>.</li> 
   <li>Support for dependencies (e.g. <a href="../../../sites/administering/using/marketing-cloud.md#integratingwithsitecatalyst">SiteCatalyst</a> plugins need a <a href="../../../sites/administering/using/marketing-cloud.md#integratingwithsitecatalyst">SiteCatalyst</a> configuration).</li> 
  </ul> 
  <h3>Structure</h3> 
  <p>The base path of the configurations is:</p> 
  <p> <span class="code">/etc/cloudservices</span>.</p> 
  <p>For each type of configuration a template and a component will be provided.This makes it possible to have configuration templates that can fulfil most needs after being customized.</p> 
  <p>To provide a configuration for a new services you need to:</p> 
  <ul> 
   <li>create a servicepage in<br /> <span class="code">/etc/cloudservices</span></li> 
   <li>under this: 
    <ul> 
     <li>a configuration template</li> 
     <li>a configuration component</li> 
    </ul> </li> 
  </ul> 
  <p>The template and component must inherit the <span class="code">sling:resourceSuperType</span> from the base template:</p> 
  <p> <span class="code">cq/cloudserviceconfigs/templates/configpage</span></p> 
  <p>or base component respectively</p> 
  <p> <span class="code">cq/cloudserviceconfigs/components/configpage</span></p> 
  <p>The service provider should also provide the service page:</p> 
  <p> <span class="code">/etc/cloudservices/&amp;lt;service-name&amp;gt;</span></p> 
  <h4>Template</h4> 
  <p>Your template will extend the base template:</p> 
  <p> <span class="code">cq/cloudserviceconfigs/templates/configpage</span></p> 
  <p>and define a <span class="code">resourceType</span> that points to the custom component.</p> 
  <codeblock gutter="true" class="syntax xml">
    /libs/cq/analytics/templates/sitecatalyst!!discoiqbr!!sling:resourceSuperType&amp;nbsp;=&amp;nbsp;cq/cloudserviceconfigs/templates/configpage!!discoiqbr!!allowedChildren&amp;nbsp;=&amp;nbsp;/libs/cq/analytics/templates/sitecatalyst!!discoiqbr!!allowedPaths&amp;nbsp;=&amp;nbsp;/etc/cloudservices/analytics/*,&amp;nbsp;/etc/cloudservices/analytics/.*!!discoiqbr!!componentReference&amp;nbsp;=&amp;nbsp;cq/analytics/components/sitecatalyst!!discoiqbr!!jcr:content/!!discoiqbr!!cq:designPath&amp;nbsp;=&amp;nbsp;/etc/designs/cloudservices!!discoiqbr!!sling:resourceType&amp;nbsp;=&amp;nbsp;cq/analytics/components/sitecatalystpage!!discoiqbr!!!!discoiqbr!!/libs/cq/analytics/templates/generictracker!!discoiqbr!!sling:resourceSuperType&amp;nbsp;=&amp;nbsp;cq/cloudservices/templates/configpage!!discoiqbr!!allowedChildren&amp;nbsp;=&amp;nbsp;/libs/cq/analytics/templates/generictracker!!discoiqbr!!allowedPaths&amp;nbsp;=&amp;nbsp;/etc/cloudservices/analytics/*,&amp;nbsp;/etc/cloudservices/analytics/.*!!discoiqbr!!jcr:content/!!discoiqbr!!cq:designPath&amp;nbsp;=&amp;nbsp;/etc/designs/cloudservices!!discoiqbr!!sling:resourceType&amp;nbsp;=&amp;nbsp;cq/analytics/components/generictrackerpage!!discoiqbr!! 
  </codeblock> 
  <h4>Components</h4> 
  <p>Your component should extend the base component:</p> 
  <p> <span class="code">cq/cloudserviceconfigs/templates/configpage</span></p> 
  <draft-comment color="yellow" lastModifiedBy="colligno@adobe.com" lastModifiedDate="2017-11-30T05:24:39.545-0500" prevFirstName="unknown" prevLastName="unknown" type="remark"> 
   <p>Why are we talking about analytics?<br /> </p> 
  </draft-comment> 
  <codeblock gutter="true" class="syntax xml">
    /libs/cq/analytics/components/sitecatalystpage!!discoiqbr!!!!discoiqbr!!/libs/cq/analytics/components/generictrackerpage!!discoiqbr!! 
  </codeblock> 
  <p>After setting up your template and component you can add your configuration by adding subpages under:</p> 
  <p> <span class="code">/etc/cloudservices/&amp;lt;<i>service-name</i>&amp;gt;</span></p> 
  <h3>Content Model</h3> 
  <p>The content model is stored as <span class="code">cq:Page</span> under:</p> 
  <p> <span class="code">/etc/cloudservices/&amp;lt;service-name&amp;gt;(/*)</span></p> 
  <codeblock gutter="true" class="syntax xml">
    /etc/cloudservices!!discoiqbr!!/etc/cloudservices/service-name!!discoiqbr!!/etc/cloudservices/service-name/config!!discoiqbr!!/etc/cloudservices/service-name/config/inherited-config 
  </codeblock> 
  <p>The configurations are stored under the subnode <span class="code">jcr:content</span>.</p> 
  <ul> 
   <li>Fixed properties, defined in a dialog should be stored on the <span class="code">jcr:node</span> directly.</li> 
   <li>Dynamic elements (using <span class="code">parsys</span> or <span class="code">iparsys</span>) use a subnode to store the component data.</li> 
  </ul> 
  <codeblock gutter="true" class="syntax xml">
    /etc/cloudservices/service/config/jcr:content&amp;nbsp;as&amp;nbsp;nt:unstructured!!discoiqbr!!propertyname!!discoiqbr!!*!!discoiqbr!!par/component/&amp;nbsp;as&amp;nbsp;cq:Component!!discoiqbr!!propertyname!!discoiqbr!!* 
  </codeblock> 
  <h3>API</h3> 
  <p>For reference documentation on the API see <a href="/sites/developing/using/reference-materials/javadoc/com/day/cq/wcm/webservicesupport/package-summary">com.day.cq.wcm.webservicesupport</a>.</p> 
  <h3>CQ Integration</h3> 
  <p>Available services are listed in the <strong>Cloud Services</strong> tab of the <strong>Page Properties</strong> dialog (of any page that inherits from <span class="code">foundation/components/page</span> or <span class="code">wcm/mobile/components/page</span>).</p> 
  <p> The tab also provides:</p> 
  <ul> 
   <li> a link to the location where you can enable the service </li> 
   <li>choose a configuration (subnode of the service) from a path field</li> 
  </ul> 
  <h4>Password Encryption</h4> 
  <p>When storing user credentials for the service, all passwords should be encrypted.</p> 
  <p>You can achieve this by adding a hidden form field. This field should have the annotation <span class="code">@Encrypted</span> in the property name; i.e. for the <span class="code">password</span> field the name would be written as:</p> 
  <p> <span class="code">password@Encrypted</span></p> 
  <p>The property will then be automatically encrypted (using the <span class="code">CryptoSupport</span> service) by the <span class="code">EncryptionPostProcessor</span>.<br /> </p> 
  <note> 
   <p>This is similar to the standard <span class="code"><a href="http://sling.apache.org/site/manipulating-content-the-slingpostservlet-servletspost.html">SlingPostServlet</a></span> annotations.</p> 
  </note> 
  <note> 
   <p>By default the <span class="code">EcryptionPostProcessor</span> only encrypts <span class="code">POST</span> requests made to <span class="code">/etc/cloudservices</span>.</p> 
  </note> 
  <h4>Additional Properties for Service Page jcr:content Nodes</h4> 
  <table border="1" cellpadding="1" cellspacing="0" width="100%"> 
   <tbody> 
    <tr> 
     <td><strong>Property</strong></td> 
     <td><strong>Description</strong></td> 
    </tr> 
    <tr> 
     <td>componentReference</td> 
     <td>Reference path to a component to be automatically included in the page.<br /> This is used for additional functionality and JS inclusions.<br /> This includes the component on the page where<br /> <span class="code"> cq/cloudserviceconfigs/components/servicecomponents</span><br /> is included (normally before the <span class="code">body</span> tag).<br /> In case the of Analytics and Target we use this to include additional functionality, such as JavaScript calls to track visitor behavior.</td> 
    </tr> 
    <tr> 
     <td>description</td> 
     <td>Short description of the service.<br /> </td> 
    </tr> 
    <tr> 
     <td>descriptionExtended</td> 
     <td>Extended description of the service.</td> 
    </tr> 
    <tr> 
     <td>ranking</td> 
     <td>Service ranking for use in listings.</td> 
    </tr> 
    <tr> 
     <td>selectableChildren</td> 
     <td>Filter for displaying configurations in page properties dialog.</td> 
    </tr> 
    <tr> 
     <td>serviceUrl</td> 
     <td>URL to service website.</td> 
    </tr> 
    <tr> 
     <td>serviceUrlLabel</td> 
     <td>Label for service URL.</td> 
    </tr> 
    <tr> 
     <td>thumbnailPath</td> 
     <td>Path to thumbnail for service.</td> 
    </tr> 
    <tr> 
     <td>visible</td> 
     <td>Visibility in page properties dialog; visible by default (optional)</td> 
    </tr> 
   </tbody> 
  </table> 
  <h3>Use Cases</h3> 
  <p>These services are provided by default:</p> 
  <ul> 
   <li><a href="../../../sites/administering/using/external-providers.md">Tracker Snippets</a> (Google, WebTrends etc.)</li> 
   <li><a href="../../../sites/administering/using/marketing-cloud.md#integratingwithsitecatalyst">SiteCatalyst</a></li> 
   <li><a href="../../../sites/administering/using/marketing-cloud.md#integratingwithtesttarget">Test&amp;Target</a></li> 
   <li><a href="../../../sites/administering/using/marketing-cloud.md#integratingwithsearchpromote">Search&amp;Promote</a></li> 
   <li><a href="../../../sites/administering/using/marketing-cloud.md#integratingwithscene7">Scene7</a></li> 
  </ul> 
  <note> 
   <p>See also <a href="../../../sites/developing/using/extending-cloud-config-custom-cloud.md">Creating a Custom Cloud Service</a>.</p> 
  </note> 
 </body> 
</html>