<?xml version="1.1" encoding="UTF-8" standalone="yes"?> 
<html> 
 <head> 
  <meta content="false" name="isReadyForLocalization" /> 
  <meta content="mix:versionable" name="jcr:mixinTypes" /> 
  <meta content="2018-01-19T19:06:16.827-0500" name="jcr:created" /> 
  <meta content="audience:developing" name="primaryAudienceTag" /> 
  <meta content="Using Client-Side Libraries" name="jcr:title" /> 
  <meta content="2017-10-12T21:46:58.665-0400" name="mwpw_migration_script_version" /> 
  <meta content="2018-11-14T08:11:29.892-0500" name="cq:lastReplicated" /> 
  <meta content="2018-08-29T11:19:54.264-0400" name="lastPublishExternalDate" /> 
  <meta content="en_us" name="jcr:language" /> 
  <meta content="2017-10-31T16:17:15.002-0400" name="firstPublishExternalDate" /> 
  <meta content="/etc/designs/help" name="cq:designPath" /> 
  <meta content="" name="jcr:versionHistory" /> 
  <meta content="true" name="jcr:isCheckedOut" /> 
  <meta content="https://helpx.adobe.com/experience-manager/6-4/sites/developing/using/clientlibs.html" name="publishExternalURL" /> 
  <meta content="msm-service" name="contentOwner" /> 
  <meta content="products:SG_EXPERIENCEMANAGER/6.4/SITES" name="primaryProductTag" /> 
  <meta content="Activate" name="cq:lastReplicationAction" /> 
  <meta content="admin" name="jcr:createdBy" /> 
  <meta content="2017-10-12T21:46:58.665-0400" name="qaDate" /> 
  <meta content="/apps/help/templates/article-3" name="cq:template" /> 
  <meta content="cotescu" name="cq:lastModifiedBy" /> 
  <meta content="ab9a2b6b-e778-4efb-b100-d6b664e5164b" name="jcr:predecessors" /> 
  <meta content="742bb90a-4609-4660-8878-b8d20eb81b8b" name="jcr:uuid" /> 
  <meta content="2018-08-29T11:19:54.264-0400" name="topicBrowsingSortDate" /> 
  <meta content="" name="jcr:primaryType" /> 
  <meta content="Using Client-Side Libraries" name="navTitle" /> 
  <meta content="/content/help/en/experience-manager/6-4/sites/developing/morehelp/introduction;/content/help/en/experience-manager/6-4/sites/developing/morehelp/introduction" name="moreHelpPaths" /> 
  <meta content="Using Client-Side Libraries" name="seoTitle" /> 
  <meta content="/content/docs/en/aem/6-3/develop/the-basics/clientlibs" name="qaNotes" /> 
  <meta content="AEM provides Client-side Library Folders, which allow you to store your client-side code in the repository, organize it into categories, and define when and how each category of code is to be served to the client" name="seoDescription" /> 
  <meta content="help/components/pages/article-3" name="sling:resourceType" /> 
  <meta content="remove-legacypath-6-1" name="jcr:lastModifiedBy" /> 
  <meta content="2018-05-08T12:40:44.333-0400" name="locHandOffDate" /> 
  <meta content="products:SG_EXPERIENCEMANAGER/6.4/SITES;topic_tags:introduction;content_type:reference" name="cq:tags" /> 
  <meta content="bohnert" name="cq:lastReplicatedBy" /> 
  <meta content="2018-11-14T07:17:56.610-0500" name="cq:lastModified" /> 
  <meta content="2018-08-29T11:19:54.264-0400" name="publishExternalDate" /> 
  <meta content="" name="jcr:baseVersion" /> 
  <meta content="trushton@adobe.com" name="lr_lastReplicatedBy" /> 
 </head> 
 <body> 
  <p>Modern websites rely heavily on client-side processing driven by complex JavaScript and CSS code. Organizing and optimizing the serving of this code can be a complicated issue.</p> 
  <p>To help deal with this issue, AEM provides <strong>Client-side Library Folders</strong>, which allow you to store your client-side code in the repository, organize it into categories, and define when and how each category of code is to be served to the client. The client-side library system then takes care of producing the correct links in your final webpage to load the correct code.</p> 
  <h2>How Client-Side Libraries Work in AEM</h2> 
  <p>The standard way to include a client-side library (that is, a JS or CSS file) in the HTML of a page is simply to include a <span class="code">&amp;lt;script&amp;gt;</span> or <span class="code">&amp;lt;link&amp;gt;</span> tag in the JSP for that page, containig the path to the file in question. For example,</p> 
  <codeblock gutter="true" class="syntax xml">
    ...!!discoiqbr!!&lt;head&gt;!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;...!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;script&amp;nbsp;type="text/javascript"&amp;nbsp;src="/etc/clientlibs/granite/jquery/source/1.8.1/jquery-1.8.1.js"&gt;&lt;/script&gt;!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;...!!discoiqbr!!&lt;/head&gt;!!discoiqbr!!... 
  </codeblock> 
  <p>While this approach works in AEM, it can lead to problems when pages and their constituent components become complex. In such cases there is the danger that multiple copies of the same JS library may be included in the final HTML output. To avoid this and to allow logical organization of client-side libraries AEM uses <strong>client-side library folders</strong>.</p> 
  <p>A client-side library folder is a repository node of type <span class="code">cq:ClientLibraryFolder</span>. It's definition in <a href="http://jackrabbit.apache.org/node-type-notation.html">CND notation</a> is</p> 
  <codeblock gutter="true" class="syntax shell">
    [cq:ClientLibraryFolder]&amp;nbsp;&gt;&amp;nbsp;sling:Folder!!discoiqbr!!&amp;nbsp;&amp;nbsp;-&amp;nbsp;dependencies&amp;nbsp;(string)&amp;nbsp;multiple!!discoiqbr!!&amp;nbsp;&amp;nbsp;-&amp;nbsp;categories&amp;nbsp;(string)&amp;nbsp;multiple!!discoiqbr!!&amp;nbsp;&amp;nbsp;-&amp;nbsp;embed&amp;nbsp;(string)&amp;nbsp;multiple!!discoiqbr!!&amp;nbsp;&amp;nbsp;-&amp;nbsp;channels&amp;nbsp;(string)&amp;nbsp;multiple 
  </codeblock> 
  <p>By default, <span class="code">cq:ClientLibraryFolder</span> nodes can be placed anywhere within the <span class="code">/apps</span>, <span class="code">/libs</span> and <span class="code">/etc</span> subtrees of the repository (these defaults, and other settings can be controlled through the <strong>Adobe Granite HTML Library Manager</strong> panel of the <a href="http://localhost:4502/system/console/configMgr">System Console</a>).</p> 
  <p>Each <span class="code">cq:ClientLibraryFolder</span> is populated with a set of JS and/or CSS files, along with a few supporting files (see below). The properties of the <span class="code">cq:ClientLibraryFolder</span> are configured as follows:</p> 
  <ul> 
   <li><span class="code">categories</span>: Identifies the categories into which the set of JS and/or CSS files within this <span class="code">cq:ClientLibraryFolder</span> fall. The <span class="code">categories</span> property, being multi-valued, allows a library folder to be part of more than one category (see below for how this may be useful).</li> 
   <li><span class="code">dependencies</span>: This is a list of other client library categories on which this library folder depends. For example, given two <span class="code">cq:ClientLibraryFolder</span> nodes <span class="code">F</span> and <span class="code">G</span>, if a file in <span class="code">F</span> requires another file in <span class="code">G</span> in order to function properly, then at least one of the <span class="code">categories</span> of <span class="code">G</span> should be among the <span class="code">dependencies</span> of <span class="code">F</span>.</li> 
   <li><span class="code">embed</span>: Used to embed code from other libraries. If node F embeds nodes G and H, the resulting HTML will be a concetration of content from nodes G and H.</li> 
   <li><span class="code">allowProxy</span>: If a client library is located under <span class="code">/apps</span>, this property allows acces to it via proxy servlet. See <a href="../../../sites/developing/using/clientlibs.md#main-pars-title-8ced">Locating a Client Library Folder and Using the Proxy Client Libraries Servlet</a> below.</li> 
  </ul> 
  <h2>Referencing Client-Side Libraries</h2> 
  <p>Because HTL is the preferred technology for developing AEM sites, HTL should be used to include client-side libraries in AEM. However it is also possible to do so using JSP.</p> 
  <h3>Using HTL</h3> 
  <p>In HTL, client libraries are loaded through a helper template provided by AEM, which can be accessed through <a href="/content/help/en/experience-manager/htl/using/block-statements#main-pars_title_12"><span class="code">data-sly-use</span></a>. Three templates are available in this file, which can be called through <a href="/content/help/en/experience-manager/htl/using/block-statements#main-pars_title_23"><span class="code">data-sly-call</span></a>:</p> 
  <ul> 
   <li><strong>css</strong> - Loads only the CSS files of the referenced client libraries.</li> 
   <li><strong>js </strong> - Loads only the JavaScript files of the referenced client libraries.</li> 
   <li><strong>all</strong> - Loads all the files of the referenced client libraries (both CSS and JavaScript).</li> 
  </ul> 
  <p>Each helper template expects a <span class="code">categories</span> option for referencing the desired client libraries. That option can be either an array of string values, or a string containing a comma separated values list.</p> 
  <p>For further details and exmple of usage, see the document <a href="/content/help/en/experience-manager/htl/using/getting-started#LoadingClientLibraries">Getting Started with the HTML Template Language</a>.</p> 
  <h3>Using JSP</h3> 
  <p>Add a <span class="code">ui:includeClientLib</span> tag to your JSP code to add a link to client libraries in the generated HTML page. To reference the libraries, you use the value of the <span class="code">categories</span> property of the <span class="code">ui:includeClientLib</span> node.</p> 
  <codeblock class="syntax js">
    &lt;%@taglib&amp;nbsp;prefix="ui"&amp;nbsp;uri="http://www.adobe.com/taglibs/granite/ui/1.0"&amp;nbsp;%&gt;!!discoiqbr!!&lt;ui:includeClientLib&amp;nbsp;categories="&lt;%=&amp;nbsp;categories&amp;nbsp;%&gt;"&amp;nbsp;/&gt; 
  </codeblock> 
  <p>For example, the <span class="code">/etc/clientlibs/foundation/jquery</span> node is of type <span class="code">cq:ClientLibraryFolder</span> with a categories property of value <span class="code">cq.jquery</span>. The following code in a JSP file references the libraries:</p> 
  <codeblock class="syntax xml">
    &lt;ui:includeClientLib&amp;nbsp;categories="cq.jquery"/&gt; 
  </codeblock> 
  <p>The generated HTML page contains the following code:</p> 
  <codeblock class="syntax xml">
    &lt;script&amp;nbsp;type="text/javascript"&amp;nbsp;src="/etc/clientlibs/foundation/jquery.js"&gt;&lt;/script&gt; 
  </codeblock> 
  <p>For complete information, including attributes for filtering JS, CSS, or theme libraries, see <a href="../../../sites/developing/using/taglib.md#main-pars-title-1565813984">ui:includeClientLib</a>.</p> 
  <note> 
   <p><span class="code">&amp;lt;cq:includeClientLib&amp;gt;</span>, which in the past was commonly used to include client libraries, has been deprecated since AEM 5.6. <a href="../../../sites/developing/using/taglib.md#main-pars-title-1565813984"><span class="code">&amp;lt;ui:includeClientLib&amp;gt;</span></a> should be used instead as detailed above.</p> 
  </note> 
  <h2>Creating Client Library Folders</h2> 
  <p>Create a <span class="code">cq:ClientLibraryFolder</span> node to define JavaScript and Cascading Style Sheet libraries and make them available to HTML pages. Use the <span class="code">categories</span> property of the node to identify the library categories to which it belongs.</p> 
  <p>The node contains one or more source files that, at runtime, are merged into a single JS and/or CSS file. The name of the generated file is the node name with either the <span class="code">.js</span> or <span class="code">.css</span> file name extension. For example, the library node named <span class="code">cq.jquery</span> results in the generated file named <span class="code">cq.jquery.js</span> or <span class="code">cq.jquery.css</span>. </p> 
  <p>Client library folders contain the following items:</p> 
  <ul> 
   <li>The JS and/or CSS source files to merge. </li> 
   <li>Resources that support CSS styles, such as image files.<p><strong>Note: </strong>You can use subfolders to organize source files.</p> </li> 
   <li>One <span class="code">js.txt</span> file and/or one <span class="code">css.txt</span> file that identifies the source files to merge in the generated JS and/or CSS files.</li> 
  </ul> 
  <img imageRotate="0" src="assets/clientlibarch.png" /> 
  <p>For information about requirements that are specific to client libraries for widgets, see <a href="../../../sites/developing/using/widgets.md">Using and Extending Widgets</a>.</p> 
  <p>The web client must have permissions to access the <span class="code">cq:ClientLibraryFolder</span> node. You can also expose libraries from secured areas of the repository (see Embedding Code From Other Libraries, below).</p> 
  <h3>Overriding Libraries in /lib</h3> 
  <p>Client library folders located below <span class="code">/apps</span> take precedence over same-named folders that are similarly located in <span class="code">/libs</span>. For example, <span class="code">/apps/cq/ui/widgets</span> takes precedence over <span class="code">/libs/cq/ui/widgets</span>. When these libraries belong to the same category, the library below <span class="code">/apps</span> is used.</p> 
  <h3>Locating a Client Library Folder and Using the Proxy Client Libraries Servlet</h3> 
  <p>In previous versions, client library folders were located below <span class="code">/etc/clientlibs</span> in the repository. This is still supported, however it is recommended that client libraries now be located under <span class="code">/apps</span>. This is to locate the client libraries near the other scripts, which are generally found below <span class="code">/apps</span> and <span class="code">/libs</span>.</p> 
  <note> 
   <p>Static resources below the client library folder must be in a folder called <em>resources</em>. If you do not have the static resources, such as images, under the folder <em>resources</em>, it cannot be referenced on a publish instance. Here is an example: http://localhost:4503/etc.clientlibs/geometrixx/components/clinetlibs/resources/example.gif</p> 
  </note> 
  <note> 
   <p>In order to better isolate code from content and configuration, it is recommended to locate client libraries under <span class="code">/apps</span> and expose them via <span class="code">/etc.clientlibs</span> by leveraging the <span class="code">allowProxy</span> property.</p> 
  </note> 
  <p>In order for the client libraries under <span class="code">/apps</span> to be accessible, a proxy servelt is used. The ACLs are still enforced on the client library folder, but the servlet allows for the content to be read via <span class="code">/etc.clientlibs/</span> if the <span class="code">allowProxy</span> property is set to <span class="code">true</span>.</p> 
  <p>A static resource can only be accessed via the proxy, if it resides below a resource below the client library folder.</p> 
  <p>As an example:</p> 
  <ul> 
   <li>You have a clientlib in <span class="code">/apps/myproject/clientlibs/foo</span></li> 
   <li>You have a static image in <span class="code">/apps/myprojects/clientlibs/foo/resources/icon.png</span></li> 
  </ul> 
  <p>Then you set the <span class="code">allowProxy</span> property on <span class="code">foo</span> to true.</p> 
  <ul> 
   <li>You can then request <span class="code">/etc.clientlibs/myprojects/clientlibs/foo.js</span></li> 
   <li>You can then reference the image via <span class="code">/etc.clientlibs/myprojects/clientlibs/foo/resources/icon.png</span></li> 
  </ul> 
  <note> 
   <p>When using proxied client libraries, the AEM Dispatcher configuration may require an update to ensure the URIs with the extension clientlibs are allowed.</p> 
  </note> 
  <note> 
   <p>Adobe recommends locating client libraries under <span class="code">/apps</span> and making them available using the proxy servlet. However keep in mind that best practice still requires that public sites never include anything that is served directly over an <span class="code">/apps</span> or <span class="code">/libs</span> path.</p> 
  </note> 
  <h3>Create a Client Library Folder</h3> 
  <ol> 
   <li><p>Open CRXDE Lite in a web browser (<a href="http://localhost:4502/crx/de">http://localhost:4502/crx/de</a>).</p>  </li> 
   <li><p>Select the folder where you want to locate the client library folder and click <strong>Create &amp;gt; Create Node</strong>.</p>  </li> 
   <li><p>Enter a name for the library file, and in the Type list select <span class="code">cq:ClientLibraryFolder</span>. Click <strong>OK</strong> and then click <strong>Save All</strong>.</p>  </li> 
   <li><p>To specify the category or categories that the library belongs to, select the <span class="code">cq:ClientLibraryFolder</span> node, add the following property, and then click <strong>Save All</strong>:</p> 
    <ul> 
     <li>Name: categories</li> 
     <li>Type: String</li> 
     <li>Value: The category name</li> 
     <li>Multi: Select </li> 
    </ul> </li> 
   <li><p>Add source files to the library folder by any means. For example, use a WebDav client to copy files, or create a file and author the content manually.</p>  <p><strong>Note: </strong>You can organize source files in subfolders if desired.</p>  </li> 
   <li><p>Select the client library folder and click <strong>Create &amp;gt; Create file</strong>.</p>  </li> 
   <li><p>In the file name box, type one of the following file names and click OK:</p> 
    <ul> 
     <li><strong><span class="code">js.txt</span>:</strong> Use this file name to generate a JavaScript file.</li> 
     <li><strong><span class="code">css.txt</span>:</strong> Use this file name to generate a Cascading Style Sheet.</li> 
    </ul>  </li> 
   <li><p>Open the file and type the following text to identify the root of the path of the source files:</p>  <p>Replace <i><span class="code">[root]</span></i> with the path to the folder that contains the source files, relative to the TXT file. For example, use the following text when the source files are in the same folder as the TXT file:</p>  <p>The following code sets the root as the folder named mobile below the <span class="code">cq:ClientLibraryFolder</span> node:</p>   </li> 
   <li><p>On the lines below <span class="code">#base=[root]</span>, type the paths of the source files relative to the root. Place each file name on a separate line.</p>  </li> 
   <li><p>Click <strong>Save All</strong>.</p>  </li> 
  </ol> 
  <h3>Linking to Dependencies</h3> 
  <p>When the code in your client library folder references other libraries, identify the other libraries as dependencies. In the JSP, the <span class="code">ui:includeClientLib</span> tag that references your client library folder causes the HTML code to include a link to your generated library file as well as the dependencies.</p> 
  <p>The dependencies must be another <span class="code">cq:ClientLibraryFolder</span>. To identify dependencies, add a property to your <span class="code">cq:ClientLibraryFolder</span> node with the following attributes:</p> 
  <ul> 
   <li><strong>Name:</strong> dependencies</li> 
   <li><strong>Type: </strong>String[]</li> 
   <li><strong>Values:</strong> The value of the categories property of the cq:ClientLibraryFolder node that the current library folder depends on.</li> 
  </ul> 
  <p>For example, the /<span class="code">etc/clientlibs/myclientlibs/publicmain</span> has a dependency on the <span class="code">cq.jquery</span> library. The JSP that references the main client library generates HTML that includes the following code:</p> 
  <codeblock gutter="true" class="syntax xml">
    &lt;script&amp;nbsp;src="/etc/clientlibs/foundation/cq.jquery.js"&amp;nbsp;type="text/javascript"&gt;!!discoiqbr!!&lt;script&amp;nbsp;src="/etc/clientlibs/mylibs/publicmain.js"&amp;nbsp;type="text/javascript"&gt; 
  </codeblock> 
  <h3>Embedding Code From Other Libraries</h3> 
  <p>You can embed code from a client library into another client library. At runtime, the generated JS and CSS files of the embedding library includes the code of the embedded library.</p> 
  <p>Embedding code is useful for providing access to libraries that are stored in secured areas of the repository.</p> 
  <h4>App-Specific Client Library Folders</h4> 
  <p>It is a best practice to keep all application-related files in their application folder below <span class="code">/app</span>. It is also a best practice to deny access for web site visitors to the <span class="code">/app</span> folder. To satisfy both best practices, create a client library folder below the <span class="code">/etc</span> folder that embeds the client library that is below <span class="code">/app</span>. </p> 
  <p>Use the categories property to identify the client library folder to embed. To embed the library, add a property to the embedding <span class="code">cq:ClientLibraryFolder</span> node, using the following property attributes:</p> 
  <ul> 
   <li><strong>Name:</strong> embed</li> 
   <li><strong>Type:</strong> String[]</li> 
   <li><strong>Value:</strong> The value of the categories property of the <span class="code">cq:ClientLibraryFolder</span> node to embed.</li> 
  </ul> 
  <h4>Using Embedding to Minimize Requests</h4> 
  <p>In some cases you may find that the final HTML generated for typical page by your publish instance includes a relatively large number of <span class="code">&amp;lt;script&amp;gt;</span> elements, particularly if your site is using client context information for analaytics or targeting. For example, in a non-optimized project you might find the following series of <span class="code">&amp;lt;script&amp;gt;</span> elements in the HTML for a page:</p> 
  <codeblock gutter="true" class="syntax xml">
    &lt;script&amp;nbsp;type="text/javascript"&amp;nbsp;src="/etc/clientlibs/granite/jquery.js"&gt;&lt;/script&gt;!!discoiqbr!!&lt;script&amp;nbsp;type="text/javascript"&amp;nbsp;src="/etc/clientlibs/granite/utils.js"&gt;&lt;/script&gt;!!discoiqbr!!&lt;script&amp;nbsp;type="text/javascript"&amp;nbsp;src="/etc/clientlibs/granite/jquery/granite.js"&gt;&lt;/script&gt;!!discoiqbr!!&lt;script&amp;nbsp;type="text/javascript"&amp;nbsp;src="/etc/clientlibs/foundation/jquery.js"&gt;&lt;/script&gt;!!discoiqbr!!&lt;script&amp;nbsp;type="text/javascript"&amp;nbsp;src="/etc/clientlibs/foundation/shared.js"&gt;&lt;/script&gt;!!discoiqbr!!&lt;script&amp;nbsp;type="text/javascript"&amp;nbsp;src="/etc/clientlibs/granite/underscore.js"&gt;&lt;/script&gt;!!discoiqbr!!&lt;script&amp;nbsp;type="text/javascript"&amp;nbsp;src="/etc/clientlibs/foundation/personalization/kernel.js"&gt;&lt;/script&gt; 
  </codeblock> 
  <p>In such cases, it can be useful to combine all the required client library code in to a single file so that the number of back and forth requests on page load is reduced. To do this you can <span class="code">embed</span> the required libraries into you app-specific client library using the embed property of the <span class="code">cq:ClientLibraryFolder</span> node.</p> 
  <p>The following client library categories are incuded with AEM. You should embed only those that are required for he functioning of your particular site. However, <strong>you should maintain the order listed here</strong>:</p> 
  <ol> 
   <li><span class="code">browsermap.standard</span></li> 
   <li><span class="code">browsermap</span></li> 
   <li><span class="code">jquery-ui</span></li> 
   <li><span class="code">cq.jquery.ui</span></li> 
   <li><span class="code">personalization</span></li> 
   <li><span class="code">personalization.core</span></li> 
   <li><span class="code">personalization.core.kernel</span></li> 
   <li><span class="code">personalization.clientcontext.kernel</span></li> 
   <li><span class="code">personalization.stores.kernel</span></li> 
   <li><span class="code">personalization.kernel</span></li> 
   <li><span class="code">personalization.clientcontext</span></li> 
   <li><span class="code">personalization.stores</span></li> 
   <li><span class="code">cq.collab.comments</span></li> 
   <li><span class="code">cq.collab.feedlink</span></li> 
   <li><span class="code">cq.collab.ratings</span></li> 
   <li><span class="code">cq.collab.toggle</span></li> 
   <li><span class="code">cq.collab.forum</span></li> 
   <li><span class="code">cq.cleditor</span></li> 
  </ol> 
  <h4>Paths in CSS Files</h4> 
  <p>When you embed CSS files, the generated CSS code uses paths to resources that are relative to the embedding library. For example, the publicly-accessible library <span class="code">/etc/client/libraries/myclientlibs/publicmain</span> embeds the<span class="code"> /apps/myapp/clientlib</span> client library:</p> 
  <img imageRotate="0" src="assets/screen_shot_2012-05-29at20122pm.png" /> 
  <p>The <span class="code">main.css</span> file contains the following style:</p> 
  <codeblock gutter="true" class="syntax xml">
    body&amp;nbsp;{!!discoiqbr!!&amp;nbsp;&amp;nbsp;padding:&amp;nbsp;0;!!discoiqbr!!&amp;nbsp;&amp;nbsp;margin:&amp;nbsp;0;!!discoiqbr!!&amp;nbsp;&amp;nbsp;background:&amp;nbsp;url(images/bg-full.jpg)&amp;nbsp;no-repeat&amp;nbsp;center&amp;nbsp;top;!!discoiqbr!!&amp;nbsp;&amp;nbsp;width:&amp;nbsp;100%;!!discoiqbr!!} 
  </codeblock> 
  <p>The CSS file that the <span class="code">publicmain</span> node generates contains the following style, using the URL of the original image:</p> 
  <codeblock gutter="true" class="syntax xml">
    body&amp;nbsp;{!!discoiqbr!!&amp;nbsp;&amp;nbsp;padding:&amp;nbsp;0;!!discoiqbr!!&amp;nbsp;&amp;nbsp;margin:&amp;nbsp;0;!!discoiqbr!!&amp;nbsp;&amp;nbsp;background:&amp;nbsp;url(../../../apps/myapp/clientlib/styles/images/bg-full.jpg)&amp;nbsp;no-repeat&amp;nbsp;center&amp;nbsp;top;!!discoiqbr!!&amp;nbsp;&amp;nbsp;width:&amp;nbsp;100%;!!discoiqbr!!} 
  </codeblock> 
  <h3>Using a Library for Specific Mobile Groups</h3> 
  <p>Use the <span class="code">channels</span> property of a client library folder to identify the mobile group that uses the library. The <span class="code">channels</span> property is useful when libraries of the same category are designed for different device capabilities.</p> 
  <p>To associate a client library folder with a device group, add a property to your <span class="code">cq:ClientLibraryFolder</span> node with the following attributes:</p> 
  <ul> 
   <li><strong>Name:</strong> channels</li> 
   <li><strong>Type: </strong>String[]</li> 
   <li><strong>Values:</strong> The name of the mobile group. To exclude the library folder from a group, prefix the name with an exclamation mark ("!").</li> 
  </ul> 
  <p>For example, the following table lists the value of the <span class="code">channels</span> property for each client library folder of the <span class="code">cq.widgets</span> category:</p> 
  <table border="1" cellpadding="3" cellspacing="0" width="90%"> 
   <tbody> 
    <tr> 
     <th>Client library folder</th> 
     <th>Value of channels property</th> 
    </tr> 
    <tr> 
     <td><span class="code">/libs/cq/analytics/widgets</span></td> 
     <td><span class="code">!touch</span></td> 
    </tr> 
    <tr> 
     <td><span class="code">/libs/cq/analytics/widgets/themes/default</span></td> 
     <td><span class="code">!touch</span></td> 
    </tr> 
    <tr> 
     <td><span class="code">/libs/cq/cloudserviceconfigs/widgets</span></td> 
     <td><span class="code">!touch</span></td> 
    </tr> 
    <tr> 
     <td><span class="code">/libs/cq/searchpromote/widgets</span></td> 
     <td><span class="code">!touch</span></td> 
    </tr> 
    <tr> 
     <td><span class="code">/libs/cq/searchpromote/widgets/themes/default</span></td> 
     <td><i>[no value]</i></td> 
    </tr> 
    <tr> 
     <td><span class="code">/libs/cq/touch/widgets</span></td> 
     <td><span class="code">touch</span></td> 
    </tr> 
    <tr> 
     <td><span class="code">/libs/cq/touch/widgets/themes/default</span></td> 
     <td><span class="code">touch</span></td> 
    </tr> 
    <tr> 
     <td><span class="code">/libs/cq/ui/widgets</span></td> 
     <td><span class="code">!touch</span></td> 
    </tr> 
    <tr> 
     <td><span class="code">/libs/cq/ui/widgets/themes/default</span></td> 
     <td><span class="code">!touch</span></td> 
    </tr> 
   </tbody> 
  </table> 
  <h2>Using Preprocessors</h2> 
  <p>AEM allows for pluggable preprocessors and ships with support for <a href="https://github.com/yui/yuicompressor#yui-compressor---the-yahoo-javascript-and-css-compressor">YUI Compressor</a> for CSS and JavaScript and <a href="https://developers.google.com/closure/compiler/">Google Closure Compiler (GCC)</a> for JavaScript with YUI set as AEM's default preprocessor.</p> 
  <p>The pluggable preprocessors allow for flexible usage including:</p> 
  <ul> 
   <li>Defining ScriptProcessors that can process script sources</li> 
   <li>Processors are configurable with options</li> 
   <li>Processors can be used for minification, but also for non-minified cases</li> 
   <li>The clientlib can define which processor to use</li> 
  </ul> 
  <note> 
   <p>By default, AEM uses the YUI Compressor. See the <a href="https://github.com/yui/yuicompressor/issues">YUI Compressor GitHub documentation</a> for a list of known issues. Switching to GCC compressor for particular clientlibs may solve some issues observed when using YUI.</p> 
  </note> 
  <note> 
   <p>Do not place a minified library in a client library. Instead provide the raw library and if minification is required, use the options of the preprocessors.</p> 
  </note> 
  <h3>Usage</h3> 
  <p>You can choose to configure the preprocessors configuration per clientlibrary or system-wide.</p> 
  <ul> 
   <li>Add the multivalue properties <span class="code">cssProcessor</span> and <span class="code">jsProcessor</span> on the clientlibrary node</li> 
   <li>Or define the system default configuration via the <strong>HTML Library Manager</strong> OSGi configuration</li> 
  </ul> 
  <p>A preprocessor configuration on the clientlib node takes precedence over the OSGI configuration.</p> 
  <h3>Format and Examples</h3> 
  <h4>Format</h4> 
  <codeblock class="syntax xml">
    config:=&amp;nbsp;mode&amp;nbsp;":"&amp;nbsp;processorName&amp;nbsp;options*;!!discoiqbr!!mode:=&amp;nbsp;"default"&amp;nbsp;|&amp;nbsp;"min";!!discoiqbr!!processorName&amp;nbsp;:=&amp;nbsp;"none"&amp;nbsp;|&amp;nbsp;&lt;name&gt;;!!discoiqbr!!options&amp;nbsp;:=&amp;nbsp;";"&amp;nbsp;option;!!discoiqbr!!option&amp;nbsp;:=&amp;nbsp;name&amp;nbsp;"="&amp;nbsp;value; 
  </codeblock> 
  <h4>YUI Compressor for CSS Minification and GCC for JS</h4> 
  <codeblock class="syntax xml">
    cssProcessor:&amp;nbsp;["default:none",&amp;nbsp;"min:yui"]!!discoiqbr!!jsProcessor:&amp;nbsp;["default:none",&amp;nbsp;"min:gcc;compilationLevel=advanced"] 
  </codeblock> 
  <h4>Typescript to Preprocess and Then GCC to Minify and Obfuscate</h4> 
  <codeblock class="syntax xml">
    jsProcessor:&amp;nbsp;[!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;"default:typescript",!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;"min:typescript",&amp;nbsp;!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;"min:gcc;obfuscate=true"!!discoiqbr!!]!!discoiqbr!! 
  </codeblock> 
  <h4>Additional GCC Options</h4> 
  <codeblock class="syntax xml">
    failOnWarning&amp;nbsp;(defaults&amp;nbsp;to&amp;nbsp;"false")!!discoiqbr!!languageIn&amp;nbsp;(defaults&amp;nbsp;to&amp;nbsp;"ECMASCRIPT5")!!discoiqbr!!languageOut&amp;nbsp;(defaults&amp;nbsp;to&amp;nbsp;"ECMASCRIPT5")!!discoiqbr!!compilationLevel&amp;nbsp;(defaults&amp;nbsp;to&amp;nbsp;"simple")&amp;nbsp;(can&amp;nbsp;be&amp;nbsp;"whitespace",&amp;nbsp;"simple",&amp;nbsp;"advanced") 
  </codeblock> 
  <p>For further details on GCC options, see the <a href="https://developers.google.com/closure/compiler/docs/compilation_levels">GCC documentation</a>.</p> 
  <h3>Set System Default Minifier</h3> 
  <p>YUI is set as the default minifier in AEM. To change this to GCC, follow these steps.</p> 
  <ol> 
   <li><p>Go to Apache Felix Config Manager at <a href="http://localhost:4502/system/console/configMgr">http://localhost:4502/system/console/configMgr</a></p> </li> 
   <li><p>Find and edit the <strong>Adobe Granite HTML Library Manager</strong>.</p> </li> 
   <li><p>Enable the <strong>Minify</strong> option (if not already enabled).</p> </li> 
   <li><p>Set the value <strong>JS Processor Default Configs</strong> to <span class="code">min:gcc</span>.</p> <p>Options can be passed if separated with a semicolon e.g. <span class="code">min:gcc;obfuscate=true</span>.</p> </li> 
   <li><p>Click <strong>Save</strong> to save the changes.</p> </li> 
  </ol> 
  <h2>Debugging Tools</h2> 
  <p>AEM provides several tools for debugging and testing client library folders.</p> 
  <h3>See Embedded Files</h3> 
  <p>To trace the origin of embedded code, or to ensure that embedded client libraries are producing the expected results, you can see the names of the files that are being embedded at runtime. To see the file names, append the <span class="code">debugClientLibs=true</span> parameter to the URL of your web page. The library that is generated contains <span class="code">@import</span> statements instead of the embedded code.</p> 
  <p>In the example in the previous <a href="../../../sites/developing/using/clientlibs.md#main-pars-title-7">Embedding Code From Other Libraries</a> section, the <span class="code">/etc/client/libraries/myclientlibs/publicmain</span> client library folder embeds the <span class="code">/apps/myapp/clientlib</span> client library folder. Appending the parameter to the web page produces the following link in the web page's source code:</p> 
  <codeblock class="syntax xml">
    &lt;link&amp;nbsp;rel="stylesheet"&amp;nbsp;href="/etc/clientlibs/mycientlibs/publicmain.css"&gt; 
  </codeblock> 
  <p>Opening the <span class="code">publicmain.css</span> file reveals the following code:</p> 
  <codeblock class="syntax xml">
    @import&amp;nbsp;url("/apps/myapp/clientlib/styles/main.css"); 
  </codeblock> 
  <p></p> 
  <ol> 
   <li>In the address box of your web browser, append the following text to the URL of your HTML: </li> 
   <li>When the page loads, view the page source.</li> 
   <li>Click the link that is provided as the href for the link element to open the file and view the source code.</li> 
  </ol> 
  <h3>Discover Client Libraries</h3> 
  <p>The <span class="code">/libs/cq/ui/components/dumplibs/dumplibs</span> component generates a page of information about all client library folders on the system. The <span class="code">/libs/cq/ui/content/dumplibs</span> node has the component as a resource type. To open the page, use the following URL (use a different host and port as required):</p> 
  <p><a href="http://localhost:4502/libs/cq/ui/content/dumplibs.test.html">http://localhost:4502/libs/cq/ui/content/dumplibs.test.html</a></p> 
  <p>The information includes the library path and type (CSS or JS), and the values of the library attributes, such as categories and dependencies. Subsequent tables on the page show the libraries in each category and channel. </p> 
  <h3>See Generated Output</h3> 
  <p>The <span class="code">dumplibs</span> component includes a test selector that displays the source code that is generated for <span class="code">ui:includeClientLib</span> tags. The page includes code for different combinations of js, css, and themed attributes.</p> 
  <ol> 
   <li>Use one of the following methods to open the Test Output page: 
    <ul> 
     <li>From the <span class="code">dumplibs.html</span> page, click the link in the <strong>Click here for output testing</strong> text.</li> 
     <li>Open the following URL in your web browser (use a different host and port as required): </li> 
    </ul> <p>The default page shows output for tags with no value for the categories attribute.</p> </li> 
   <li>To see the output for a category, type the value of the client library's <span class="code">categories</span> property and click <strong>Submit Query</strong>. </li> 
  </ol> 
  <h2>Configuring Library Handling for Development and Production</h2> 
  <p>The HTML Library Manager service processes <span class="code">cq:ClientLibraryFolder</span> tags and generates the libraries at runtime. The type of environment, development or production, determines how you should configure the service:</p> 
  <ul> 
   <li>Increase security: Disable debugging</li> 
   <li>Improve performance: Remove whitespace and compress libraries. </li> 
   <li>Improve readability: Include whitespace and do not compress.</li> 
  </ul> 
  <p>For information about configuring the service, see <a href="../../../sites/deploying/using/osgi-configuration-settings.md#aemhtmllibrarymanager">AEM HTML Library Manager</a>.</p> 
 </body> 
</html>