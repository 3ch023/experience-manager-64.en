<?xml version="1.1" encoding="UTF-8" standalone="yes"?> 
<html> 
 <head> 
  <meta content="admin" name="jcr:createdBy" /> 
  <meta content="2018-09-14T19:33:29.829-0400" name="locHandOffDate" /> 
  <meta content="https://helpx.adobe.com/experience-manager/6-3/sites/developing/using/dev-guidelines-bestpractices.html" name="publishExternalURL" /> 
  <meta content="locales:fr;locales:de;locales:ja" name="locLangTag" /> 
  <meta content="/apps/help/templates/article-3" name="cq:template" /> 
  <meta content="fbc927e8-92f3-4c79-ba67-c0aacb7f1bb2" name="jcr:predecessors" /> 
  <meta content="carlino" name="cq:lastReplicatedBy" /> 
  <meta content="Guillaume Carlino" name="contentOwner" /> 
  <meta content="" name="jcr:versionHistory" /> 
  <meta content="products:SG_EXPERIENCEMANAGER/6.4/SITES;topic_tags:introduction;content_type:reference" name="cq:tags" /> 
  <meta content="dist5" name="distType" /> 
  <meta content="remove-legacypath-6-1" name="jcr:lastModifiedBy" /> 
  <meta content="carlino@adobe.com" name="lr_lastReplicatedBy" /> 
  <meta content="en_us" name="jcr:language" /> 
  <meta content="audience:developing" name="primaryAudienceTag" /> 
  <meta content="Activate" name="cq:lastReplicationAction" /> 
  <meta content="AEM Development - Guidelines and Best Practices" name="seoTitle" /> 
  <meta content="mix:versionable" name="jcr:mixinTypes" /> 
  <meta content="2017-10-12T21:46:58.665-0400" name="mwpw_migration_script_version" /> 
  <meta content="2018-01-19T19:04:49.854-0500" name="jcr:created" /> 
  <meta content="0170acf6-a405-4e6b-966f-a3cf17c1b81d" name="jcr:uuid" /> 
  <meta content="2018-04-03T09:00:25.185-0400" name="cq:lastReplicated" /> 
  <meta content="AEM Development - Guidelines and Best Practices" name="jcr:title" /> 
  <meta content="" name="jcr:primaryType" /> 
  <meta content="2018-01-18T11:18:59.151-0500" name="lastPublishExternalDate" /> 
  <meta content="2018-01-18T11:18:59.151-0500" name="publishExternalDate" /> 
  <meta content="2017-10-31T16:17:04.964-0400" name="firstPublishExternalDate" /> 
  <meta content="2018-01-18T11:18:59.151-0500" name="topicBrowsingSortDate" /> 
  <meta content="true" name="jcr:isCheckedOut" /> 
  <meta content="light" name="gnavTheme" /> 
  <meta content="2017-10-12T21:46:58.665-0400" name="qaDate" /> 
  <meta content="/content/docs/en/aem/6-3/develop/the-basics/dev-guidelines-bestpractices" name="qaNotes" /> 
  <meta content="help/components/pages/article-3" name="sling:resourceType" /> 
  <meta content="/etc/designs/help" name="cq:designPath" /> 
  <meta content="/content/help/en/experience-manager/6-4/sites/developing/morehelp/introduction;/content/help/en/experience-manager/6-4/sites/developing/morehelp/introduction" name="moreHelpPaths" /> 
  <meta content="products:SG_EXPERIENCEMANAGER/6.4/SITES" name="primaryProductTag" /> 
  <meta content="AEM Development - Guidelines and Best Practices" name="navTitle" /> 
  <meta content="" name="jcr:baseVersion" /> 
  <meta content="Guidelines and best practices for developing on AEM" name="seoDescription" /> 
  <meta content="msm-service" name="cq:lastModifiedBy" /> 
  <meta content="false" name="isReadyForLocalization" /> 
  <meta content="2018-09-14T19:33:29.830-0400" name="cq:lastModified" /> 
 </head> 
 <body> 
  <draft-comment type="draft"> 
   <ul> 
    <li>Needs information about flat node hierarchies, their affects on performance, and some approaches for proper structuring (for example <a href="/content/ddc/blog/2011/05/efficient_management">Efficient JCR node management with BTreeManager</a> )</li> 
    <li>Tuning JCR queries and how to create efficient ones: <a href="http://wiki.apache.org/jackrabbit/Performance" title="Follow link">http://wiki.apache.org/jackrabbit/Performance</a></li> 
   </ul> 
  </draft-comment> 
  <draft-comment type="draft"> 
   <h2>Repository Structure</h2> 
  </draft-comment> 
  <draft-comment type="draft"> 
   <h2>Repository Queries</h2> 
  </draft-comment> 
  <h2>Guidelines for Using Templates and Components</h2> 
  <p>AEM components and templates form a very powerful toolkit. They can be used by developers to provide website business users, editors, and administrators with the functionality to adapt their websites to changing business needs (content agility) while retaining the uniform layout of the sites (brand protection).</p> 
  <p>A typical challenge for a person responsible for a website, or set of websites (for example in a branch office of a global enterprise), is to introduce a new type of content presentation on their websites.</p> 
  <p>Let us assume there is a need to add a newslist page to the websites, which lists extracts from other articles already published. The page should have the same design and structure as the rest of the website.</p> 
  <p>The recommended way to approach such a challenge would be to:</p> 
  <ul> 
   <li><p>Reuse an existing template to create a new type of page. The template roughly defines page structure (navigation elements, panels, and so on), which is further fine-tuned by its design (CSS, graphics).</p> </li> 
   <li><p>Use the paragraph system (parsys/iparsys) on the new pages.</p> </li> 
   <li><p>Define access right to the Design mode of the paragraph systems, so that only authorized people (usually the administrator) can change them.</p> </li> 
   <li><p>Define the components allowed in the given paragraph system so that editors can then place the required components on the page. In our case it could be a list component, which can traverse a subtree of pages and extract the information according to predefined rules.</p> </li> 
   <li><p>Editors add and configure the allowed components, on the pages they are responsible for, to deliver the requested functionality (information) to the business.</p> </li> 
  </ul> 
  <p>This illustrates how this approach empowers the contributing users and administrators of the website to respond to business needs quickly, without requiring the involvement of development teams. Alternative methods, such as creating a new template, is usually a costly exercise, requiring a change management process and involvement of the development team. This makes the whole process much longer and costly.</p> 
  <p>The developers of AEM-based systems should therefore use:</p> 
  <ul> 
   <li><p>templates and access control to paragraph system design for uniformity and brand protection</p> </li> 
   <li><p>paragraph system including its configuration options for flexibility.</p> </li> 
  </ul> 
  <p>The following general rules for developers make sense in majority of usual projects:</p> 
  <ul> 
   <li><p>Keep the number of templates low - as low as the number of fundamentally different page structures on the web sites.</p> </li> 
   <li><p>Provide necessary flexibility and configuration capabilities to your custom components.</p> </li> 
   <li><p>Maximize use of the power and flexibility of AEM paragraph system - the parsys &amp; iparsys components.</p> </li> 
  </ul> 
  <h4>Customizing Components and Other Elements</h4> 
  <p>When creating your own components or customizing an existing component it is often easiest (and safest) to re-use existing definitions. The same principles also applies to other elements within AEM, for example the error handler.<br /> </p> 
  <p>This can be done by copying and overlaying the existing definition. In other words, copying the definition from <span class="code">/libs</span> to <span class="code">/apps/&amp;lt;your-project&amp;gt;</span>. This new definition, in <span class="code">/apps</span>, can be updated according to your requirements.</p> 
  <note> 
   <p>See <a href="../../../sites/developing/using/overlays.md">Using Overlays</a> for more details.</p> 
  </note> 
  <p>For example:</p> 
  <ul> 
   <li><a href="../../../sites/developing/using/components.md">Customizing a Component</a><br /> This involved overlaying a component definition: 
    <ul> 
     <li>Create a new component folder in <span class="code">/apps/&amp;lt;website-name&amp;gt;/components/&amp;lt;MyComponent&amp;gt;</span> by copying an existing component: 
      <ul> 
       <li>For example, to customize the Text component copy: 
        <ul> 
         <li>from <span class="code">/libs/foundation/components/text</span><br /> </li> 
         <li>to <span class="code">/apps/myProject/components/text</span></li> 
        </ul> </li> 
      </ul> </li> 
    </ul> </li> 
   <li><a href="../../../sites/developing/using/customizing-errorhandler-pages.md#howtocustomizepagesshownbytheerrorhandler">Customizing pages shown by the Error Handler </a><br /> This case involves overlaying a servlet:<br /> 
    <ul> 
     <li>In the repository, copy the default script(s): 
      <ul> 
       <li>from <span class="code">/libs/sling/servlet/errorhandler/</span></li> 
       <li>to <span class="code">/apps/sling/servlet/errorhandler/</span><br /> </li> 
      </ul> </li> 
    </ul> </li> 
  </ul> 
  <note> 
   <p>You <strong>must not</strong> change anything in the <span class="code">/libs</span> path.</p> 
   <p>This is because the content of <span class="code">/libs</span> is overwritten the next time you upgrade your instance (and may well be overwritten when you apply either a hotfix or feature pack).</p> 
   <p>For configuration and other changes:</p> 
   <ol> 
    <li>copy the item in <span class="code">/libs</span> to <span class="code">/apps</span><br /> </li> 
    <li>make any changes within <span class="code">/apps</span></li> 
   </ol> 
  </note> 
  <h2>When to use JCR Queries and when not to use them</h2> 
  <p>JCR Queries are a powerful tool when employed correctly. They are appropriate for:</p> 
  <ul> 
   <li>real end-user queries, such as fulltext searches on content.</li> 
   <li>occasions where structured content needs to be found across the entire repository. <br /> <br /> In such cases, make sure that queries only run when absolutely required, e.g. on component activation or cache invalidation (as opposed to e.g. Workflows Steps, Event Handlers that trigger on content modifications, Filters, etc).</li> 
  </ul> 
  <p>JCR Queries should never be used for pure rendering requests. For example, JCR Queries are not appropriate for</p> 
  <ul> 
   <li>rendering navigation</li> 
   <li>creating a "top 10 latest news items" overview</li> 
   <li>showing counts of content items </li> 
  </ul> 
  <p>For rendering content, use navigational access to the content tree instead of performing a JCR Query.</p> 
  <note> 
   <p>If you use the <a href="../../../sites/developing/using/querybuilder-api.md">Query Builder</a>, you use JCR Queries, as the Query Builder generates JCR Queries under the hood.</p> 
   <p></p> 
  </note> 
  <h2>Security Considerations</h2> 
  <note> 
   <p>It is also worthwhile referencing the <a href="../../../sites/administering/using/security-checklist.md">security checklist</a>.<br /> </p> 
  </note> 
  <h3>JCR (Repository) Sessions</h3> 
  <p>You should use the user session, not the administrative session. This means you should use:</p> 
  <codeblock gutter="true" class="syntax java">
    slingRequest.getResourceResolver().adaptTo(Session.class); 
  </codeblock> 
  <h3>Protect against Cross-Site Scripting (XSS)</h3> 
  <p>Cross-site scripting (XSS) allows attackers to inject code into web pages viewed by other users. This security vulnerability can be exploited by malicious web users to bypass access controls.</p> 
  <p>AEM applies the principle of filtering all user-supplied content upon output. Preventing XSS is given the highest priority during both development and testing.</p> 
  <p>Additionally, a web application firewall, such as <a href="http://www.modsecurity.org/projects/modsecurity/apache/">mod_security for Apache</a>, can provide reliable, central control over the security of the deployment environment and protect against previously undetected cross-site scripting attacks.</p> 
  <note> 
   <p>Example code provided with AEM may not itself protect against such attacks and generally relies on request filtering by a web application firewall.</p> 
  </note> 
  <p>The XSS API cheat sheet contains information you need to know in order to use the XSS API and make an AEM app more secure. You can download it here:</p> 
  <div> 
   <p>The XSSAPI cheat sheet.</p> 
   <p><a alt="xss_cheat_sheet_2016.pdf" href="assets/xss_cheat_sheet_2016.pdf">Get File</a></p> 
  </div> 
  <h3>Securing Communication for Confidential Information</h3> 
  <p>As for any internet application, make sure that when transporting confidential information</p> 
  <ul> 
   <li>traffic is secured through SSL</li> 
   <li>HTTP POST is used if applicable</li> 
  </ul> 
  <p>This applies to information that is confidential to the system (like configuration or administrative access) as well as information confidential to its users (like their personal details)</p> 
  <h2>Distinct Development Tasks</h2> 
  <h3>Customizing Error Pages</h3> 
  <p>Error pages can be customized for AEM. This is advisable so that the instance does not reveal sling traces on internal server errors.</p> 
  <p>See <a href="../../../sites/developing/using/customizing-errorhandler-pages.md">Customizing Error Pages shown by the Error Handler</a> for full details.</p> 
  <h3>Open Files in the Java Process</h3> 
  <p>Because AEM can access a large number of files it is recommended that the number of <a href="../../../sites/deploying/using/configuring.md#openfilesinthejavaprocess">open files for a Java process</a> be explicitly configured for AEM.<br /> </p> 
  <p>To minimize this issue development should ensure that any file opened is correctly closed as soon as (meaningfully) possible.<br /> </p> 
 </body> 
</html>