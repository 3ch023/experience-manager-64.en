<?xml version="1.1" encoding="UTF-8" standalone="yes"?>
<html>
 <head>
  <meta content="true" name="jcr:isCheckedOut" />
  <meta content="false" name="isReadyForLocalization" />
  <meta content="2018-04-03T08:47:02.061-0400" name="lastPublishExternalDate" />
  <meta content="2018-04-03T08:47:02.529-0400" name="cq:lastReplicated" />
  <meta content="Activate" name="cq:lastReplicationAction" />
  <meta content="f0087a0f-41c0-40ed-940a-10f0e765cec0" name="jcr:predecessors" />
  <meta content="/content/help/en/experience-manager/6-4/sites/deploying/morehelp/configuring;/content/help/en/experience-manager/6-4/sites/deploying/morehelp/configuring" name="moreHelpPaths" />
  <meta content="carlino@adobe.com" name="lr_lastReplicatedBy" />
  <meta content="carlino" name="cq:lastReplicatedBy" />
  <meta content="Version Purging" name="seoTitle" />
  <meta content="/content/docs/en/aem/6-3/deploy/configuring/version-purging" name="qaNotes" />
  <meta content="2018-04-03T08:47:02.061-0400" name="publishExternalDate" />
  <meta content="mix:versionable" name="jcr:mixinTypes" />
  <meta content="2017-10-12T21:46:58.665-0400" name="qaDate" />
  <meta content="a8f9c0d2-e50c-4a43-8851-1de07642b91c" name="jcr:uuid" />
  <meta content="Version Purging" name="navTitle" />
  <meta content="products:SG_EXPERIENCEMANAGER/6.4/SITES" name="primaryProductTag" />
  <meta content="products:SG_EXPERIENCEMANAGER/6.4/SITES;topic_tags:configuring;content_type:reference" name="cq:tags" />
  <meta content="bohnert" name="cq:lastModifiedBy" />
  <meta content="2018-04-03T08:47:02.061-0400" name="topicBrowsingSortDate" />
  <meta content="2017-10-12T21:46:58.665-0400" name="mwpw_migration_script_version" />
  <meta content="audience:deploying" name="primaryAudienceTag" />
  <meta content="" name="jcr:primaryType" />
  <meta content="/apps/help/templates/article-3" name="cq:template" />
  <meta content="https://helpx.adobe.com/experience-manager/6-4/sites/deploying/using/version-purging.html" name="publishExternalURL" />
  <meta content="remove-legacypath-6-1" name="jcr:lastModifiedBy" />
  <meta content="This article describes the available options for version purging." name="seoDescription" />
  <meta content="Version Purging" name="jcr:title" />
  <meta content="" name="jcr:baseVersion" />
  <meta content="2017-10-31T16:17:29.758-0400" name="firstPublishExternalDate" />
  <meta content="" name="jcr:versionHistory" />
  <meta content="/etc/designs/help" name="cq:designPath" />
  <meta content="2018-04-30T03:29:29.389-0400" name="locHandOffDate" />
  <meta content="en_us" name="jcr:language" />
  <meta content="2018-04-30T03:29:29.390-0400" name="cq:lastModified" />
  <meta content="2017-12-01T19:05:31.628-0500" name="jcr:created" />
  <meta content="help/components/pages/article-3" name="sling:resourceType" />
  <meta content="admin" name="jcr:createdBy" />
  <meta content="Guillaume Carlino" name="contentOwner" />
 </head>
 <body>
  <p>In a standard installation AEM creates a new version of a page or node when you activate a page after updating the content.</p> 
  <note>
   <p>If no content changes are made then you will see the message stating that the page has been activated, but no new version will be created</p> 
  </note>
  <p>You can create additional versions on request using the <strong>Versioning</strong> tab of the sidekick. These versions are stored in the repository and can be restored if required.</p> 
  <p>These versions are never purged, so the repository size will grow over time and therefore need to be managed.</p> 
  <p>AEM is shipped with various mechanisms to help you manage your repository:</p> 
  <ul> 
   <li>the <a href="#versionmanager">Version Manager</a><br /> This can be configured to purge old versions when new versions are created.<br /> </li> 
   <li>the <strong><a href="#purgeversionstool">Purge Versions</a> </strong>tool<br /> This is used as part of <a href="../../../sites/deploying/using/monitoring-and-maintaining.md">monitoring and maintaining</a> your repository.<br /> It allows you to intervene to remove old versions of a node, or a hierarchy of nodes, according to these parameters:<br /> 
    <ul> 
     <li>The maximum number of versions to be kept in the repository.<br /> When this number is exceeded, the oldest version is removed.<br /> </li> 
     <li>The maximum age of any version kept in the repository.<br /> When the age of a version exceeds this value, it is purged from the repository.</li> 
    </ul> </li> 
  </ul> 
  <h2>Version Manager</h2>
  <p>In addition to explicit purging by means of the purge tool, the Version Manager can be configured to purge old versions when new versions are created. </p> 
  <p>To configure the Version Manager, create a configuration for:</p> 
  <p><span class="code"> PID com.day.cq.wcm.core.impl.VersionManagerImpl</span></p> 
  <p>The following options are available:</p> 
  <ul> 
   <li><span class="code">versionmanager.createVersionOnActivation</span> (Boolean, default: true)<br /> whether to create a version when pages are activated.<br /> A version is created unless the replication agent is configured to suppress creation of versions, which is honoured by the Version Manager<br /> A version is only created if the activation happens on a paths that is contained in versionmanager.ivPaths (see below).</li> 
   <li><span class="code">versionmanager.ivPaths</span> (String[], default: {"/"})<br /> paths on which versions are implicitly created on activation if versionmanager.createVersionOnActivation is true.</li> 
   <li><span class="code">versionmanager.purgingEnabled</span> (Boolean, default: false)<br /> whether to enable purging when new versions are created</li> 
   <li><span class="code">versionmanager.purgePaths</span> (String[], default: {"/content"})<br /> on which paths to purge versions when new versions are created</li> 
   <li><span class="code">versionmanager.maxAgeDays</span> (int, default: 30)<br /> on purge, any version older than this value will be removed. If this value is less than 1, purging is not performed based on the age of the version<br /> </li> 
   <li><span class="code">versionmanager.maxNumberVersions</span> (int, default 5)<br /> on purge, any version older than the n-th newest version will be removed. If this value is less than 1, purging is not performed based on the number of versions</li> 
   <li><span class="code">versionmanager.minNumberVersions</span> (int, default 0)<br /> The minimum number of versions to keep regardless of the age. If this value is set to a value less than 1 no minimum number of versions is retained. <br /> </li> 
  </ul> 
  <h3>Combining Retention Options</h3>
  <p>The options defining how which versions should be retained (<span class="code">maxAgeDays</span>, <span class="code">maxNumberVersions</span>, <span class="code">minNumberVersions</span>), can be combined depending on your requirements.<br /> </p> 
  <p>For example, when defining the maximum number of versions to retain AND the oldest version to retain:</p> 
  <ul> 
   <li>Setting:
    <ul> 
     <li><span class="code">maxNumberVersions</span> = 7<br /> </li> 
     <li><span class="code">maxAgeDays</span> = 30</li> 
    </ul> </li> 
   <li>With:
    <ul> 
     <li>10 versions made within the past 60 days</li> 
     <li>3 of those versions created within the past 30 days</li> 
    </ul> </li> 
   <li>Will mean that:
    <ul> 
     <li>The last 3 versions will be retained</li> 
    </ul> </li> 
  </ul> 
  <p>For example, when defining the maximum AND minimum number of versions to retain AND the oldest version to retain:</p> 
  <ul> 
   <li>Setting:
    <ul> 
     <li><span class="code">maxNumberVersions</span> = 3 </li> 
     <li><span class="code">maxAgeDays</span> = 30 </li> 
     <li><span class="code">minNumberVersions</span> = 3</li> 
    </ul> </li> 
   <li>With: 
    <ul> 
     <li>5 versions made 60 days ago </li> 
    </ul> </li> 
   <li>Will mean that:
    <ul> 
     <li>3 versions will be retained</li> 
    </ul> </li> 
  </ul> 
  <h2>Purge Versions Tool</h2>
  <p>The <strong>Purge Versions</strong> tool is intended for purging the versions of a node or a hierarchy of nodes in your repository. Its primary purpose is to help you reduce the size of your repository by removing old versions of your nodes.</p> 
 </body>
</html>