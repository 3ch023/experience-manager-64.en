<?xml version="1.1" encoding="UTF-8" standalone="yes"?> 
<html> 
 <head> 
  <meta content="Resource Mapping" name="seoTitle" /> 
  <meta content="carlino" name="cq:lastReplicatedBy" /> 
  <meta content="2017-10-12T21:46:58.665-0400" name="qaDate" /> 
  <meta content="2018-04-30T03:29:07.106-0400" name="cq:lastModified" /> 
  <meta content="2018-04-03T08:45:55.157-0400" name="lastPublishExternalDate" /> 
  <meta content="Learn how to define redirects, vanity URLs and virtual hosts for AEM by using resource mapping." name="seoDescription" /> 
  <meta content="Resource Mapping" name="navTitle" /> 
  <meta content="aa2ed379-92ff-4bea-970f-4201b8b636bb" name="jcr:uuid" /> 
  <meta content="" name="jcr:primaryType" /> 
  <meta content="false" name="isReadyForLocalization" /> 
  <meta content="en_us" name="jcr:language" /> 
  <meta content="help/components/pages/article-3" name="sling:resourceType" /> 
  <meta content="/content/docs/en/aem/6-3/deploy/configuring/resource-mapping" name="qaNotes" /> 
  <meta content="b99c1477-9a86-4133-b365-2607ff6c092a" name="jcr:predecessors" /> 
  <meta content="2017-10-31T16:17:39.350-0400" name="firstPublishExternalDate" /> 
  <meta content="2018-04-03T08:45:55.407-0400" name="cq:lastReplicated" /> 
  <meta content="carlino" name="cq:lastModifiedBy" /> 
  <meta content="2018-04-30T03:29:07.106-0400" name="locHandOffDate" /> 
  <meta content="carlino@adobe.com" name="lr_lastReplicatedBy" /> 
  <meta content="mix:versionable" name="jcr:mixinTypes" /> 
  <meta content="remove-legacypath-6-1" name="jcr:lastModifiedBy" /> 
  <meta content="/etc/designs/help" name="cq:designPath" /> 
  <meta content="products:SG_EXPERIENCEMANAGER/6.4/SITES" name="primaryProductTag" /> 
  <meta content="2018-04-03T08:45:55.157-0400" name="topicBrowsingSortDate" /> 
  <meta content="Activate" name="cq:lastReplicationAction" /> 
  <meta content="User" name="contentOwner" /> 
  <meta content="" name="jcr:baseVersion" /> 
  <meta content="audience:deploying" name="primaryAudienceTag" /> 
  <meta content="admin" name="jcr:createdBy" /> 
  <meta content="products:SG_EXPERIENCEMANAGER/6.4/SITES;topic_tags:configuring;content_type:reference" name="cq:tags" /> 
  <meta content="https://helpx.adobe.com/experience-manager/6-4/sites/deploying/using/resource-mapping.html" name="publishExternalURL" /> 
  <meta content="2018-04-03T08:45:55.157-0400" name="publishExternalDate" /> 
  <meta content="2017-10-12T21:46:58.665-0400" name="mwpw_migration_script_version" /> 
  <meta content="2017-12-01T19:04:33.124-0500" name="jcr:created" /> 
  <meta content="true" name="jcr:isCheckedOut" /> 
  <meta content="Resource Mapping" name="jcr:title" /> 
  <meta content="" name="jcr:versionHistory" /> 
  <meta content="/apps/help/templates/article-3" name="cq:template" /> 
 </head> 
 <body> 
  <p>Resource mapping is used to define redirects, vanity URLs and virtual hosts for AEM.<br /> </p> 
  <p>For example, you can use these mappings to:</p> 
  <ul> 
   <li>Prefix all requests with <span class="code">/content</span> so that the internal structure is hidden from the visitors to your website.</li> 
   <li>Define a redirect so that all requests to the <span class="code">/content/en/gateway</span> page of your website are redirected to <span class="code">http://gbiv.com/</span>.</li> 
  </ul> 
  <p>One possible HTTP mapping <a href="#configuringaninternalredirecttocontent">prefixes all requests to <span class="code">localhost:4503</span> with <span class="code">/content</span></a>. A mapping like this could be used to hide the internal structure from the visitors to the website as it allows:</p> 
  <p style="margin-left: 40px;"><span class="code">localhost:4503/content/geometrixx/en/products.html</span></p> 
  <p>to be accessed using:<br /> </p> 
  <p style="margin-left: 40px;"><span class="code">localhost:4503/geometrixx/en/products.html</span></p> 
  <p>as the mapping will automatically add the prefix <span class="code">/content</span> to <span class="code">/geometrixx/en/products.html</span>.</p> 
  <note> 
   <p>Vanity URLs do not support regex patterns.</p> 
  </note> 
  <note> 
   <p>See the Sling documentation, and <a href="http://sling.apache.org/site/resources.html">Mappings for Resource Resolution</a> and <a href="http://sling.apache.org/site/mappings-for-resource-resolution.html">Resources</a> for further information.<br /> </p> 
  </note> 
  <h3>Viewing Mapping Definitions</h3> 
  <p>The mappings form two lists that the JCR Resource Resolver evaluates (top-down) to find a match.</p> 
  <p>These lists can be viewed (together with configuration information) under the <strong>JCR ResourceResolver</strong> option of the Felix console; for example, <span class="code">http://&amp;lt;<i>host</i>&amp;gt;:&amp;lt;<i>port</i>&amp;gt;/system/console/jcrresolver</span>:</p> 
  <ul> 
   <li>Configuration<br /> Shows the current configuration (as defined for the <a href="../../../sites/deploying/using/osgi-configuration-settings.md#apacheslingresourceresolver">Apache Sling Resource Resolver</a>).</li> 
   <li>Configuration Test<br /> This allows you to enter a URL or resource path. Click <strong>Resolve</strong> or <strong>Map</strong> to confirm how the system will transform the entry.<br /> </li> 
   <li><strong>Resolver Map Entries</strong><br /> The list of entries used by the ResourceResolver.resolve methods to map URLs to Resources.</li> 
   <li><strong>Mapping Map Entries</strong><br /> The list of entries used by the ResourceResolver.map methods to map Resource Paths to URLs.</li> 
  </ul> 
  <p>The two lists show various entries, including those defined as defaults by the application(s). These often aim to simplify URLs for the user.</p> 
  <p>The lists pair a <strong>Pattern</strong>, a regular expression matched to the request, with a <strong>Replacement</strong> that defines the redirection to impose.</p> 
  <p>For example, the:</p> 
  <p style="margin-left: 40px;"><strong>Pattern </strong><span class="code">^[^/]+/[^/]+/welcome$</span></p> 
  <p>will trigger the:</p> 
  <p style="margin-left: 40px;"><strong>Replacement</strong> <span class="code">/libs/cq/core/content/welcome.html</span>.</p> 
  <p>to redirect a request:</p> 
  <p style="margin-left: 40px;"><span class="code">http://localhost:4503/welcome</span><span class="code"></span></p> 
  <p>to:</p> 
  <p style="margin-left: 40px;"><span class="code">http://localhost:4503/libs/cq/core/content/welcome.html</span></p> 
  <p>New mapping definitions are created within the repository.<br /> </p> 
  <note> 
   <p>There are many resources available that help explain how to define regular expressions; for example <a href="http://www.regular-expressions.info/">http://www.regular-expressions.info/</a>.<br /> </p> 
  </note> 
  <h3>Creating Mapping Definitions in AEM</h3> 
  <p>In a standard installation of AEM you can find the folder:</p> 
  <p style="margin-left: 40px;"><span class="code">/etc/map/http</span></p> 
  <p>This is the structure used when defining mappings for the HTTP protocol. Other folders (<span class="code">sling:Folder</span>) can be created under <span class="code">/etc/map</span> for any other protocols that you want to map.<br /> </p> 
  <h4>Configuring an Internal Redirect to /content</h4> 
  <p>To create the mapping that prefixes any request to http://localhost:4503/ with <span class="code">/content</span>:<br /> </p> 
  <ol> 
   <li>Using CRXDE navigate to <span class="code">/etc/map/http</span>.<br /> </li> 
   <li>Create a new node: 
    <ul> 
     <li><strong>Type</strong> <span class="code">sling:Mapping</span><br /> This node type is intended for such mappings, though its use is not mandatory.<br /> </li> 
     <li><strong>Name</strong> <span class="code">localhost_any</span></li> 
    </ul> </li> 
   <li>Click <strong>Save All</strong>.</li> 
   <li><strong>Add</strong> the following properties to this node: 
    <ul> 
     <li><strong>Name</strong> <span class="code">sling:match </span><br /> 
      <ul> 
       <li><strong>Type</strong> <span class="code">String</span> </li> 
       <li><strong>Value</strong> <span class="code">localhost.4503/</span></li> 
      </ul> </li> 
     <li><strong>Name</strong> <span class="code">sling:internalRedirect </span><br /> 
      <ul> 
       <li><strong>Type</strong> <span class="code">String </span><br /> </li> 
       <li><strong>Value</strong> <span class="code">/content/</span></li> 
      </ul> </li> 
    </ul> </li> 
   <li>Click <strong>Save All</strong>.</li> 
  </ol> 
  <p>This will handle a request such as:<br /> <span class="code">localhost:4503/geometrixx/en/products.html</span><br /> as if:<br /> <span class="code">localhost:4503/content/geometrixx/en/products.html</span><br /> had been requested.</p> 
  <note> 
   <p>See <a href="http://sling.apache.org/site/mappings-for-resource-resolution.html">Resources</a> in the Sling Documentation for further information about the sling properties available and how they can be configured.<br /> </p> 
  </note> 
  <note> 
   <p>You can use <span class="code">/etc/map.publish</span> to hold the configurations for the publish environment. These must then be replicated, and the new location (<span class="code">/etc/map.publish</span>) configured for the <strong>Mapping Location</strong> of the <a href="../../../sites/deploying/using/osgi-configuration-settings.md#apacheslingresourceresolver">Apache Sling Resource Resolver</a> of the publish environment.</p> 
  </note> 
 </body> 
</html>