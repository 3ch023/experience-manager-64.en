<?xml version="1.1" encoding="UTF-8" standalone="yes"?> 
<html> 
 <head> 
  <meta content="admin" name="lr_creator" /> 
  <meta content="" name="jcr:baseVersion" /> 
  <meta content="mix:versionable" name="jcr:mixinTypes" /> 
  <meta content="02583801-68ec-4f26-9c5c-3f2b1fe2c49b" name="jcr:predecessors" /> 
  <meta content="true" name="jcr:isCheckedOut" /> 
  <meta content="en_us" name="jcr:language" /> 
  <meta content="/etc/designs/help" name="cq:designPath" /> 
  <meta content="Activate" name="cq:lastReplicationAction" /> 
  <meta content="admin" name="contentOwner" /> 
  <meta content="2017-10-03T06:48:56.548-0400" name="publishExternalDate" /> 
  <meta content="" name="jcr:primaryType" /> 
  <meta content="AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-767a.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-7cc1.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12-271be6bf1336a3553d3-7ffe.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12-271be6bf1336a3553d3-7fff.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-7658.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-7657.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-7cbe.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12-6acebdb11336a3554be-7fff.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-763f.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-763e.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-7cbd.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12-2770047f1336a355599-7fff.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-7628.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-7627.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-7cbc.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12-6bbc85731336a355693-7fff.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-7614.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-7613.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-7cbb.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12-348240e81336a35577d-7fff.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-75fd.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-75fc.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-7cba.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12241da4ab1336a355877-7fff.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-75e4.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-75e3.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-7cb9.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e1235ea546b1336a355961-7fff.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-75ce.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-75cd.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-7ff0.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e127efa4e7d1336a355a4c-7fff.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-75b7.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-75b6.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-7cb8.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12519786b91336a355b36-7fff.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-759e.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-759d.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-7cb7.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12-73e5790d1336a355c20-7fff.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-7588.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-7587.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-7cb6.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12-13ff689a1336a355d0b-7ffe.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-7571.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-7570.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-7fef.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e1224b612821336a355df5-7fff.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-755b.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-755a.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-7fee.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12-73de0e6e1336a355ee0-7fff.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-7547.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-7546.2" name="cq:gepId" /> 
  <meta content="/apps/help/templates/article-3" name="cq:template" /> 
  <meta content="2018-04-03T08:30:24.163-0400" name="cq:lastReplicated" /> 
  <meta content="b9b7b53a-97f6-42f0-83c3-6763fbff1c56" name="jcr:uuid" /> 
  <meta content="head1_20111213" name="gep_conversion_script_version" /> 
  <meta content="content_type:reference;products:SG_EXPERIENCEMANAGER/6.4/FORMS;topic_tags:operations" name="cq:tags" /> 
  <meta content="products:SG_EXPERIENCEMANAGER/6.4/FORMS" name="primaryProductTag" /> 
  <meta content="Protecting Documents with Policies" name="jcr:title" /> 
  <meta content="2017-11-21T06:59:06.704-0500" name="cq:lastModified" /> 
  <meta content="https://helpx.adobe.com/aem-forms/6-3/developing/protecting-documents-policies.html" name="publishExternalURL" /> 
  <meta content="2017-10-03T06:48:56.548-0400" name="firstPublishExternalDate" /> 
  <meta content="carlino" name="cq:lastReplicatedBy" /> 
  <meta content="Protecting Documents with Policies" name="navTitle" /> 
  <meta content="audience:developing" name="primaryAudienceTag" /> 
  <meta content="2017-07-12T07:03:00.000-0400" name="sortDate" /> 
  <meta content="carlino" name="cq:lastModifiedBy" /> 
  <meta content="khsingh@adobe.com" name="lr_lastReplicatedBy" /> 
  <meta content="2017-07-12T07:03:00.000-0400" name="topicBrowsingSortDate" /> 
  <meta content="admin" name="jcr:createdBy" /> 
  <meta content="2017-11-22T19:05:29.844-0500" name="jcr:created" /> 
  <meta content="" name="jcr:versionHistory" /> 
  <meta content="2017-10-03T06:48:56.548-0400" name="lastPublishExternalDate" /> 
  <meta content="2017-07-12T07:03:39.536-0400" name="lr_lastModified" /> 
  <meta content="admin" name="lr_lastModifiedBy" /> 
  <meta content="help/components/pages/article-3" name="sling:resourceType" /> 
 </head> 
 <body> 
  <p><strong>About the Document Security Service</strong></p> 
  <p>The Document Security service enables users to dynamically apply confidentiality settings to Adobe PDF documents and to maintain control over the documents, no matter how widely they are distributed. </p> 
  <p>The Document Security service prevents information from spreading beyond the user’s reach by enabling the users to maintain control over how recipients use the policy-protected PDF document. A user can specify who can open a document, limit how they can use it, and monitor the document after it is distributed. A user can also dynamically control access to a policy-protected document and can even dynamically revoke access to the document. </p> 
  <p>The Document Security service also protects other file types such as Microsoft Word files (DOC files). You can use the Document Security Client API to work with these file types. The following versions are supported:</p> 
  <ul> 
   <li><p>Microsoft Office 2003 files (DOC, XLS, PPT files)</p></li> 
   <li><p>Microsoft Office 2007 files (DOCX, XLSX, PPTX files)</p></li> 
   <li><p>PTC Pro/E files</p></li> 
  </ul> 
  <p>For clarity, the following two sections discuss how to work with Word documents:</p> 
  <ul> 
   <li></li> 
   <li></li> 
  </ul> 
  <p>You can accomplish these tasks using the Document Security service:</p> 
  <ul> 
   <li><p>Create policies. For information, see <a href="protecting-documents-policies#creating_policies">Creating Policies</a>.</p></li> 
   <li><p>Modify policies. For information, see <a href="protecting-documents-policies#modifying_policies">Modifying Policies</a>.</p></li> 
   <li><p>Delete policies. For information, see <a href="protecting-documents-policies#deleting_policies">Deleting Policies</a>.</p></li> 
   <li><p>Apply policies to PDF documents. For information, see <a href="protecting-documents-policies#applying_policies_to_pdf_documents">Applying Policies to PDF Documents</a>.</p></li> 
   <li><p>Remove policies from PDF documents. For information, see <a href="protecting-documents-policies#removing_policies_from_pdf_documents">Removing Policies from PDF Documents</a>.</p></li> 
   <li><p>Inspect policy-protected documents. For information, see <a href="protecting-documents-policies#inspecting_policy_protected_pdf_documents">Inspecting Policy Protected PDF Documents</a>.</p></li> 
   <li><p>Revoke access to PDF documents. For information, see <a href="protecting-documents-policies#revoking_access_to_documents">Revoking Access to Documents</a>.</p></li> 
   <li><p>Reinstate access to revoked documents. For information, see <a href="protecting-documents-policies#reinstating_access_to_revoked_documents">Reinstating Access to Revoked Documents</a>.</p></li> 
   <li><p>Create watermarks. For information, see <a href="protecting-documents-policies#creating_watermarks">Creating Watermarks</a>.</p></li> 
   <li><p>Search for events. For information, see <a href="protecting-documents-policies#searching_for_events">Searching for Events</a>.</p></li> 
  </ul> 
  <note> 
   <p>For more information about the Document Security service, see <a href="http://www.adobe.com/go/learn_aemforms_services_63">Services Reference for AEM Forms</a>. For examples of working with policies, see the “Document Security Service API Quick Starts” in <a href="/programming-with-aem-forms/#java_api_soap_quick_start_code_examples">API Quick Starts (Code Examples)</a>.</p> 
  </note> 
  <draft-comment type="remark">
    Content Referenced from lc_po_create_policies_cp.xml#WS624e3cba99b79e12e69a9941333732bac8-7cc1.2_ver6.1 
  </draft-comment> 
  <h2 id="creating_policies">Creating Policies</h2> 
  <p></p> 
  <p>You can programmatically create policies using the Document Security Java API or web service API. A <i>policy</i> is a collection of information that includes document security settings, authorized users, and usage rights. You can create and save any number of policies, using security settings appropriate for different situations and users. </p> 
  <p>Policies enable you to perform these tasks: </p> 
  <ul> 
   <li><p>Specify the individuals who can open the document. Recipients can either belong to or be external to your organization.</p></li> 
   <li><p>Specify how recipients can use the document. You can restrict access to different Acrobat and Adobe Reader features. These features include the ability to print and copy text, add signatures, and add comments to a document. </p></li> 
   <li><p>Change the access and security settings at any time, even after you distribute the policy-protected document.</p></li> 
   <li><p>Monitor the use of the document after you distribute it. You can see how the document is being used and who is using it. For example, you can find out when someone has opened the document.</p></li> 
  </ul> 
  <h3 id="creating_a_policy_using_web_services">Creating a policy using web services</h3> 
  <p></p> 
  <p>When creating a policy using the web service API, reference an existing Portable Document Rights Language (PDRL) XML file that describes the policy. Policy permissions and the principal are defined in the PDRL document. The following XML document is an example of a PDRL document. </p> 
  <codeblock gutter="true" class="syntax as3">
     &lt;?xml&amp;nbsp;version="1.0"&amp;nbsp;encoding="UTF-8"&amp;nbsp;standalone="yes"?&gt;&amp;nbsp;!!discoiqbr!! &lt;Policy&amp;nbsp;PolicyInstanceVersion="1"&amp;nbsp;PolicyID="5DA3F847-DE76-F9CC-63EA-49A8D59154DE"&amp;nbsp;PolicyCreationTime="2004-08-30T00:02:28.294+00:00"&amp;nbsp;PolicyType="1"&amp;nbsp;PolicySchemaVersion="1.0"&amp;nbsp;PolicyName="SDK&amp;nbsp;Test&amp;nbsp;Policy&amp;nbsp;-4344050357301573237"&amp;nbsp;PolicyDescription="An&amp;nbsp;SDK&amp;nbsp;Test&amp;nbsp;policy"&amp;nbsp;xmlns="http://www.adobe.com/schema/1.0/pdrl"&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;PolicyEntry&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;ns1:Permission&amp;nbsp;PermissionName="com.adobe.aps.onlineOpen"&amp;nbsp;Access="ALLOW"&amp;nbsp;xmlns:ns1="http://www.adobe.com/schema/1.0/pdrl"&amp;nbsp;xmlns="http://www.adobe.com/schema/1.0/pdrl-ex"&amp;nbsp;/&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;ns2:Permission&amp;nbsp;PermissionName="com.adobe.aps.offlineOpen"&amp;nbsp;Access="ALLOW"&amp;nbsp;xmlns:ns2="http://www.adobe.com/schema/1.0/pdrl"&amp;nbsp;xmlns="http://www.adobe.com/schema/1.0/pdrl-ex"&amp;nbsp;/&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;ns3:Permission&amp;nbsp;PermissionName="com.adobe.aps.pdf.editNotes"&amp;nbsp;Access="ALLOW"&amp;nbsp;xmlns:ns3="http://www.adobe.com/schema/1.0/pdrl"&amp;nbsp;xmlns="http://www.adobe.com/schema/1.0/pdrl-ex"&amp;nbsp;/&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;ns4:Permission&amp;nbsp;PermissionName="com.adobe.aps.pdf.fillAndSign"&amp;nbsp;Access="ALLOW"&amp;nbsp;xmlns:ns4="http://www.adobe.com/schema/1.0/pdrl"&amp;nbsp;xmlns="http://www.adobe.com/schema/1.0/pdrl-ex"&amp;nbsp;/&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;Principal&amp;nbsp;PrincipalNameType="SYSTEM"&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;PrincipalDomain&gt;EDC_SPECIAL&lt;/PrincipalDomain&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;PrincipalName&gt;all_internal_users&lt;/PrincipalName&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/Principal&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/PolicyEntry&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;PolicyEntry&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;ns5:Permission&amp;nbsp;PermissionName="com.adobe.aps.onlineOpen"&amp;nbsp;Access="ALLOW"&amp;nbsp;xmlns:ns5="http://www.adobe.com/schema/1.0/pdrl"&amp;nbsp;xmlns="http://www.adobe.com/schema/1.0/pdrl-ex"&amp;nbsp;/&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;ns6:Permission&amp;nbsp;PermissionName="com.adobe.aps.offlineOpen"&amp;nbsp;Access="ALLOW"&amp;nbsp;xmlns:ns6="http://www.adobe.com/schema/1.0/pdrl"&amp;nbsp;xmlns="http://www.adobe.com/schema/1.0/pdrl-ex"&amp;nbsp;/&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;ns7:Permission&amp;nbsp;PermissionName="com.adobe.aps.pdf.copy"&amp;nbsp;Access="ALLOW"&amp;nbsp;xmlns:ns7="http://www.adobe.com/schema/1.0/pdrl"&amp;nbsp;xmlns="http://www.adobe.com/schema/1.0/pdrl-ex"&amp;nbsp;/&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;ns8:Permission&amp;nbsp;PermissionName="com.adobe.aps.pdf.printLow"&amp;nbsp;Access="ALLOW"&amp;nbsp;xmlns="http://www.adobe.com/schema/1.0/pdrl-ex"&amp;nbsp;xmlns:ns8="http://www.adobe.com/schema/1.0/pdrl"&amp;nbsp;/&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;ns9:Permission&amp;nbsp;PermissionName="com.adobe.aps.policySwitch"&amp;nbsp;Access="ALLOW"&amp;nbsp;xmlns:ns9="http://www.adobe.com/schema/1.0/pdrl"&amp;nbsp;xmlns="http://www.adobe.com/schema/1.0/pdrl-ex"&amp;nbsp;/&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;ns10:Permission&amp;nbsp;PermissionName="com.adobe.aps.revoke"&amp;nbsp;Access="ALLOW"&amp;nbsp;xmlns="http://www.adobe.com/schema/1.0/pdrl-ex"&amp;nbsp;xmlns:ns10="http://www.adobe.com/schema/1.0/pdrl"&amp;nbsp;/&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;ns11:Permission&amp;nbsp;PermissionName="com.adobe.aps.pdf.edit"&amp;nbsp;Access="ALLOW"&amp;nbsp;xmlns:ns11="http://www.adobe.com/schema/1.0/pdrl"&amp;nbsp;xmlns="http://www.adobe.com/schema/1.0/pdrl-ex"&amp;nbsp;/&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;ns12:Permission&amp;nbsp;PermissionName="com.adobe.aps.pdf.editNotes"&amp;nbsp;Access="ALLOW"&amp;nbsp;xmlns:ns12="http://www.adobe.com/schema/1.0/pdrl"&amp;nbsp;xmlns="http://www.adobe.com/schema/1.0/pdrl-ex"&amp;nbsp;/&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;ns13:Permission&amp;nbsp;PermissionName="com.adobe.aps.pdf.fillAndSign"&amp;nbsp;Access="ALLOW"&amp;nbsp;xmlns:ns13="http://www.adobe.com/schema/1.0/pdrl"&amp;nbsp;xmlns="http://www.adobe.com/schema/1.0/pdrl-ex"&amp;nbsp;/&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;ns14:Permission&amp;nbsp;PermissionName="com.adobe.aps.pdf.printHigh"&amp;nbsp;Access="ALLOW"&amp;nbsp;xmlns:ns14="http://www.adobe.com/schema/1.0/pdrl"&amp;nbsp;xmlns="http://www.adobe.com/schema/1.0/pdrl-ex"&amp;nbsp;/&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;Principal&amp;nbsp;PrincipalNameType="SYSTEM"&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;PrincipalDomain&gt;EDC_SPECIAL&lt;/PrincipalDomain&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;PrincipalName&gt;publisher&lt;/PrincipalName&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/Principal&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/PolicyEntry&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;OfflineLeasePeriod&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;Duration&gt;P31D&lt;/Duration&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/OfflineLeasePeriod&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;AuditSettings&amp;nbsp;isTracked="true"&amp;nbsp;/&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;PolicyValidityPeriod&amp;nbsp;isAbsoluteTime="false"&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;ValidityPeriodRelative&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;NotBeforeRelative&gt;PT0S&lt;/NotBeforeRelative&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;NotAfterRelative&gt;P20D&lt;/NotAfterRelative&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/ValidityPeriodRelative&gt;&amp;nbsp;!!discoiqbr!! &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/PolicyValidityPeriod&gt;&amp;nbsp;!!discoiqbr!! &lt;/Policy&gt;&amp;nbsp;!!discoiqbr!!  
  </codeblock> 
  <note> 
   <p>For more information about the Document Security service, see <a href="http://www.adobe.com/go/learn_aemforms_services_63">Services Reference for AEM Forms</a>.</p> 
  </note> 
  <h3 id="summary_of_steps">Summary of steps</h3> 
  <p></p> 
  <p>To create a policy, perform the following steps:</p> 
  <ol> 
   <li><p>Include project files.</p></li> 
   <li><p>Create a Document Security Client API object.</p></li> 
   <li><p>Set the policy’s attributes. </p></li> 
   <li><p>Create a policy entry.</p></li> 
   <li><p>Register the policy.</p></li> 
  </ol> 
  <p><strong>Include project files</strong></p> 
  <p>Include necessary files into your development project. If you are creating a client application using Java, then include the necessary JAR files. If you are using web services, then make sure that you include the proxy files.</p> 
  <p>The following JAR files must be added to your project’s classpath:</p> 
  <ul> 
   <li><p>adobe-rightsmanagement-client.jar</p></li> 
   <li><p>namespace.jar (if AEM Forms is deployed on JBoss)</p></li> 
   <li><p>jaxb-api.jar (if AEM Forms is deployed on JBoss)</p></li> 
   <li><p>jaxb-impl.jar (if AEM Forms is deployed on JBoss)</p></li> 
   <li><p>jaxb-libs.jar (if AEM Forms is deployed on JBoss)</p></li> 
   <li><p>jaxb-xjc.jar (if AEM Forms is deployed on JBoss)</p></li> 
   <li><p>relaxngDatatype.jar (if AEM Forms is deployed on JBoss)</p></li> 
   <li><p>xsdlib.jar (if AEM Forms is deployed on JBoss)</p></li> 
   <li><p>adobe-livecycle-client.jar</p></li> 
   <li><p>adobe-usermanager-client.jar</p></li> 
   <li><p>adobe-utilities.jar</p></li> 
   <li><p>jbossall-client.jar (use a different JAR file if AEM Forms is not deployed on JBoss)</p></li> 
  </ul> 
  <p>For information about the location of these JAR files, see <a href="/programming-with-aem-forms/invoking-aem-forms-using-java#including_aem_forms_java_library_files">Including AEM Forms Java library files</a>.</p> 
  <p><strong>Create a Document Security Client API object</strong></p> 
  <p>Before you can programmatically perform a Document Security service operation, create a Document Security service client object.</p> 
  <p><strong>Set the policy’s attributes</strong></p> 
  <p>To create a policy, set policy attributes. A mandatory attribute is the policy name. Policy names must be unique for each policy set. A policy set is simply a collection of policies. There can be two policies with the same name if the policies belong to separate policy sets. However, two policies within a single policy set cannot have the same policy name.</p> 
  <p>Another useful attribute to set is the validity period. A validity period is the time period during which a policy-protected document is accessible to authorized recipients. If you do not set this attribute, then the policy is always valid.</p> 
  <p>A validity period can be set to one of these options: </p> 
  <ul> 
   <li><p>A set number of days that the document is accessible from the time which the document is published</p></li> 
   <li><p>An end date after which the document is not accessible</p></li> 
   <li><p>A specific date range for which the document is accessible</p></li> 
   <li><p>Always valid</p></li> 
  </ul> 
  <p>You can specify just a start date, which results in the policy being valid after the start date. If you specify just an end date, the policy is valid until the end date. However, an exception is thrown if both a start date and an end date are not defined.</p> 
  <p>When setting attributes that belong to a policy, you can also set encryption settings. These encryption settings take affect when the policy is applied to a document. You can specify the following encryption values:</p> 
  <ul> 
   <li><p><strong>AES256</strong>: Represents the AES encryption algorithm with a 256-bit key. </p></li> 
   <li><p><strong>AES128</strong>: Represents the AES encryption algorithm with a 128-bit key.</p></li> 
   <li><p><strong>NoEncryption:</strong> Represents no encryption.</p></li> 
  </ul> 
  <p>When specifying the <span class="code">NoEncryption</span> option, you cannot set the <span class="code">PlaintextMetadata</span> option to <span class="code">false</span>. If you attempt to do so, an exception is thrown. </p> 
  <note> 
   <p>For information about other attributes that you can set, see the <span class="code">Policy</span> interface description in the <a href="http://www.adobe.com/go/learn_aemforms_javadocs_63_en">AEM Forms API Reference</a>.</p> 
  </note> 
  <p><strong>Create a policy entry</strong></p> 
  <p>A policy entry attaches principals, which are groups and users, and permissions to a policy. A policy must have at least one policy entry. Assume, for example, that you perform these tasks:</p> 
  <ul> 
   <li><p>Create and register a policy entry that enables a group to only view a document while online and prohibits recipients from copying it. </p></li> 
   <li><p>Attach the policy entry to the policy.</p></li> 
   <li><p>Secure a document with the policy by using Acrobat.</p></li> 
  </ul> 
  <p>These actions result in recipients only being able to view the document online and not being able to copy it. The document remains secure until security is removed from it. </p> 
  <p><strong>Register the policy</strong></p> 
  <p>A new policy must be registered before it can be used. After you register a policy, you can use it to protect documents. </p> 
  <h3 id="create_a_policy_using_the_java_api">Create a policy using the Java API</h3> 
  <p></p> 
  <p>Create a policy by using the Document Security API (Java):</p> 
  <ol> 
   <li><p>Include project files. </p><p>Include client JAR files, such as adobe-rightsmanagement-client.jar, in your Java project’s class path. </p></li> 
   <li><p>Create a Document Security Client API object. </p> 
    <ul> 
     <li><p>Create a <span class="code">ServiceClientFactory</span> object that contains connection properties.</p></li> 
     <li><p>Create a <span class="code">DocumentSecurityClient</span> object by using its constructor and passing the <span class="code">ServiceClientFactory</span> object.</p></li> 
    </ul></li> 
   <li><p>Set the policy’s attributes. </p> 
    <ul> 
     <li><p>Create a <span class="code">Policy</span> object by invoking the <span class="code">InfomodelObjectFactory</span> object’s static <span class="code">createPolicy</span> method. This method returns a <span class="code">Policy</span> object.</p></li> 
     <li><p>Set the policy’s name attribute by invoking the <span class="code">Policy</span> object’s <span class="code">setName</span> method and passing a string value that specifies the policy name. </p></li> 
     <li><p>Set the policy’s description by invoking the <span class="code">Policy</span> object’s <span class="code">setDescription</span> method and passing a string value that specifies the policy’s description.</p></li> 
     <li><p>Set the policy set to which the new policy belongs by invoking the <span class="code">Policy</span> object’s <span class="code">setPolicySetName</span> method and passing a string value that specifies the policy set name. (You can specify <span class="code">null</span> for this parameter value that results in the policy being added to the <i>My Policies</i> policy set.) </p></li> 
     <li><p>Create the policy’s validity period by invoking the <span class="code">InfomodelObjectFactory</span> object’s static <span class="code">createValidityPeriod</span> method. This method returns a <span class="code">ValidityPeriod</span> object. </p></li> 
     <li><p>Set the number of days for which a policy-protected document is accessible by invoking the <span class="code">ValidityPeriod</span> object’s <span class="code">setRelativeExpirationDays</span> method and passing an integer value that specifies the number of days. </p></li> 
     <li><p>Set the policy’s validity period by invoking the <span class="code">Policy</span> object’s <span class="code">setValidityPeriod</span> method and passing the <span class="code">ValidityPeriod</span> object.</p></li> 
    </ul></li> 
   <li><p>Create a policy entry. </p> 
    <ul> 
     <li><p>Create a policy entry by invoking the <span class="code">InfomodelObjectFactory</span> object’s static <span class="code">createPolicyEntry</span> method. This method returns a <span class="code">PolicyEntry</span> object.</p></li> 
     <li><p>Specify the policy’s permissions by invoking the <span class="code">InfomodelObjectFactory</span> object’s static <span class="code">createPermission</span> method. Pass a static data member that belongs to the <span class="code">Permission</span> interface that represents the permission. This method returns a <span class="code">Permission</span> object. For example, to add the permission that enables users to copy data from a policy-protected PDF document, pass <span class="code">Permission.COPY</span>. (Repeat this step for each permission to add). </p></li> 
     <li><p>Add the permission to the policy entry by invoking the <span class="code">PolicyEntry</span> object’s <span class="code">addPermission</span> method and passing the <span class="code">Permission</span> object. (Repeat this step for each <span class="code">Permission</span> object that you created). </p></li> 
     <li><p>Create the policy principal by invoking the <span class="code">InfomodelObjectFactory</span> object’s static <span class="code">createSpecialPrincipal</span> method. Pass a data member that belongs to the <span class="code">InfomodelObjectFactory</span> object that represents the principal. This method returns a <span class="code">Principal</span> object. For example, to add the publisher of the document as the principal, pass <span class="code">InfomodelObjectFactory.PUBLISHER_PRINCIPAL</span>.</p></li> 
     <li><p>Add the principal to the policy entry by invoking the <span class="code">PolicyEntry</span> object’s <span class="code">setPrincipal </span>method and passing the <span class="code">Principal</span> object. </p></li> 
     <li><p>Add the policy entry to the policy by invoking the <span class="code">Policy</span> object’s <span class="code">addPolicyEntry</span> method and passing the <span class="code">PolicyEntry</span> object.</p></li> 
    </ul></li> 
   <li><p>Register the policy. </p> 
    <ul> 
     <li><p>Create a <span class="code">PolicyManager</span> object by invoking the <span class="code">DocumentSecurityClient</span> object’s <span class="code">getPolicyManager</span> method.</p></li> 
     <li><p>Register the policy by invoking the <span class="code">PolicyManager</span> object’s <span class="code">registerPolicy</span> method and passing the following values:</p> 
      <ul> 
       <li><p>The <span class="code">Policy</span> object that represents the policy to register. </p></li> 
      </ul></li> 
     <li><p>A string value that represents the policy set that the policy belongs to. </p></li> 
    </ul><p>If you use a AEM forms administrator account within connection settings to create the <span class="code">DocumentSecurityClient</span> object, then specify the policy set name when you invoke the <span class="code">registerPolicy</span> method. If you pass a <span class="code">null</span> value for the policy set, the policy is created in the administrators <i>My Policies</i> policy set. </p><p>If you use a Document Security user within connection settings, then you can invoke the overloaded <span class="code">registerPolicy</span> method that accepts only the policy. That is, you do not need to specify the policy set name. However, the policy is added to the policy set named <i>My Policies</i>. If you do not want to add the new policy to this policy set, then specify a policy set name when you invoke the <span class="code">registerPolicy</span> method.</p> 
    <note> 
     <p>When creating a policy, reference an existing policy set. If you specify a policy set that does not exist, then an exception is thrown. </p> 
    </note></li> 
  </ol> 
  <p>For code examples using the Document Security service, see the following Quick Starts in <i><a href="/programming-with-aem-forms/#java_api_soap_quick_start_code_examples">API Quick Starts (Code Examples)</a></i>:</p> 
  <ul> 
   <li><p>“Quick Start (SOAP mode): Creating a policy using the Java API”</p></li> 
  </ul> 
  <h3 id="create_a_policy_using_the_web_service_api">Create a policy using the web service API</h3> 
  <p></p> 
  <p>Create a policy by using the Document Security API (web service):</p> 
  <ol> 
   <li><p>Include project files. </p><p>Create a Microsoft .NET project that uses MTOM. Ensure that you use the following WSDL definition: <span class="code">http://localhost:8080/soap/services/RightsManagementService?WSDL&amp;lc_version=9.0.1</span>. </p> 
    <note> 
     <p>Replace <span class="code">localhost</span> with the IP address of the server hosting AEM Forms. </p> 
    </note></li> 
   <li><p>Create a Document Security Client API object. </p> 
    <ul> 
     <li><p>Create a <span class="code">DocumentSecurityServiceClient</span> object by using its default constructor. </p></li> 
     <li><p>Create a <span class="code">DocumentSecurityServiceClient.Endpoint.Address</span> object by using the <span class="code">System.ServiceModel.EndpointAddress</span> constructor. Pass a string value that specifies the WSDL to the AEM Forms service (for example, <span class="code">http://localhost:8080/soap/services/RightsManagementService?WSDL</span>.) You do not need to use the <span class="code">lc_version</span> attribute. This attribute is used when you create a service reference.) </p></li> 
     <li><p>Create a <span class="code">System.ServiceModel.BasicHttpBinding</span> object by getting the value of the <span class="code">RightsManagementServiceClient.Endpoint.Binding</span> field. Cast the return value to <span class="code">BasicHttpBinding</span>. </p></li> 
     <li><p>Set the <span class="code">System.ServiceModel.BasicHttpBinding</span> object’s <span class="code">MessageEncoding</span> field to <span class="code">WSMessageEncoding.Mtom</span>. This value ensures that MTOM is used. </p></li> 
     <li><p>Enable basic HTTP authentication by performing the following tasks:</p> 
      <ul> 
       <li><p>Assign the AEM forms user name to the field <span class="code">RightsManagementServiceClient.ClientCredentials.UserName.UserName</span>.</p></li> 
       <li><p>Assign the corresponding password value to the field <span class="code">RightsManagementServiceClient.ClientCredentials.UserName.Password</span>.</p></li> 
       <li><p>Assign the constant value <span class="code">HttpClientCredentialType.Basic</span> to the field <span class="code">BasicHttpBindingSecurity.Transport.ClientCredentialType</span>. </p></li> 
      </ul></li> 
     <li><p>Assign the constant value <span class="code">BasicHttpSecurityMode.TransportCredentialOnly</span> to the field <span class="code">BasicHttpBindingSecurity.Security.Mode</span>. </p></li> 
    </ul></li> 
   <li><p>Set the policy’s attributes. </p> 
    <ul> 
     <li><p>Create a <span class="code">PolicySpec</span> object by using its constructor. </p></li> 
     <li><p>Set the policy’s name by assigning a string value to the <span class="code">PolicySpec</span> object’s <span class="code">name</span> data member. </p></li> 
     <li><p>Set the policy’s description by assigning a string value to the <span class="code">PolicySpec</span> object’s <span class="code">description</span> data member. </p></li> 
     <li><p>Set the policy set to which the policy will belong by assigning a string value to the <span class="code">PolicySpec</span> object’s <span class="code">policySetName</span> data member. You must specify an existing policy set name. (You can specify <span class="code">null</span> for this parameter value that results in the policy being added to <i>My Policies</i>.) </p></li> 
     <li><p>Set the policy’s offline lease period by assigning an integer value to the <span class="code">PolicySpec</span> object’s <span class="code">offlineLeasePeriod</span> data member.</p></li> 
     <li><p>Set the <span class="code">PolicySpec</span> object’s <span class="code">policyXml</span> data member with a string value that represents PDRL XML data. To perform this task, create a .NET <span class="code">StreamReader</span> object by using its constructor. Pass the location of a PDRL XML file that represents the policy to the <span class="code">StreamReader</span> constructor. Next, invoke the <span class="code">StreamReader</span> object’s <span class="code">ReadLine</span> method and assign the return value to a string variable. Iterate through the <span class="code">StreamReader</span> object until the <span class="code">ReadLine</span> method returns null. Assign the string variable to the <span class="code">PolicySpec</span> object’s <span class="code">policyXml</span> data member.</p></li> 
    </ul></li> 
   <li><p>Create a policy entry. </p><p>It is not necessary to create a policy entry when creating a policy using the Document Security web service API. The policy entry is defined in the PDRL document. </p></li> 
   <li><p>Register the policy. </p><p>Register the policy by invoking the <span class="code">DocumentSecurityServiceClient</span> object’s <span class="code">registerPolicy</span> method and passing the following values:</p> 
    <ul> 
     <li><p>The <span class="code">PolicySpec</span> object that represents the policy to register. </p></li> 
     <li><p>A string value that represents the policy set that the policy belongs to. You can specify a <span class="code">null</span> value which results in the policy being added to the <i>MyPolices</i> policy set. </p></li> 
    </ul><p>If you use a AEM forms administrator account within connection settings to create the <span class="code">DocumentSecurityClient</span> object, specify the policy set name when you invoke the <span class="code">registerPolicy</span> method.</p><p>If you use a Document SecurityDocument Security user within connection settings, then you can invoke the overloaded <span class="code">registerPolicy</span> method that accepts only the policy. That is, you do not need to specify the policy set name. However, the policy is added to the policy set named <i>My Policies</i>. If you do not want to add the new policy to this policy set, then specify a policy set name when you invoke the <span class="code">registerPolicy</span> method.</p> 
    <note> 
     <p>When creating a policy and you specify a policy set, ensure that you specify an existing policy set. If you specify a policy set that does not exist, then an exception is thrown. </p> 
    </note></li> 
  </ol> 
  <p>For code examples using the Document Security service, see the following Quick Starts in <i><a href="/programming-with-aem-forms/#java_api_soap_quick_start_code_examples">API Quick Starts (Code Examples)</a></i>:</p> 
  <ul> 
   <li><p>“Quick Start (MTOM): Creating a policy using the web service API”</p></li> 
   <li><p>“Quick Start (SwaRef): Creating a policy using the web service API”</p></li> 
  </ul> 
  <draft-comment type="remark">
    Content Referenced from lc_po_modify_policies_mp.xml#WS624e3cba99b79e12e69a9941333732bac8-7cbe.2_ver6.1 
  </draft-comment> 
  <h2 id="modifying_policies">Modifying Policies</h2> 
  <p></p> 
  <p>You can modify an existing policy using the Document Security Java API or web service API. To make changes to an existing policy, you retrieve it, modify it, and then update the policy on the server. For example, assume that you retrieve an existing policy and extend its validity period. Before the change takes effect, you must update the policy. </p> 
  <p>You can modify a policy when business requirements change and the policy no longer reflects these requirements. Instead of creating a new policy, you can simply update an existing policy.</p> 
  <p>To modify policy attributes using a web service (for example, using Java proxy classes that were created with JAX-WS), you must ensure that the policy is registered with the Document Security service. You can then reference the existing policy by using the <span class="code">PolicySpec.getPolicyXml</span> method and modify the policy attributes by using the applicable methods. For example, you can modify the offline lease period by invoking the <span class="code">PolicySpec.setOfflineLeasePeriod</span> method.</p> 
  <note> 
   <p>For more information about the Document Security service, see <a href="http://www.adobe.com/go/learn_aemforms_services_63">Services Reference for AEM Forms</a>.</p> 
  </note> 
  <h3 id="summary_of_steps">Summary of steps</h3> 
  <p></p> 
  <p>To modify an existing policy, perform the following steps:</p> 
  <ol> 
   <li><p>Include project files.</p></li> 
   <li><p>Create a Document Security Client API object.</p></li> 
   <li><p>Retrieve an existing policy. </p></li> 
   <li><p>Change policies attributes. </p></li> 
   <li><p>Update the policy.</p></li> 
  </ol> 
  <p><strong>Include project files</strong></p> 
  <p>Include necessary files into your development project. If you are creating a client application using Java, then include the necessary JAR files. If you are using web services, then make sure that you include the proxy files.</p> 
  <p><strong>Create a Document Security Client API object</strong></p> 
  <p>Before you can programmatically perform a Document Securityservice operation, you must create a Document Security service client object. If you are using the Java API, create a <span class="code">RightsManagementClient</span> object. If you are using the Document Security web service API, create a <span class="code">RightsManagementServiceService</span> object.</p> 
  <p><strong>Retrieve an existing policy</strong></p> 
  <p>You must retrieve an existing policy in order to modify it. To retrieve a policy, specify the policy name and the policy set to which the policy belongs. If you specify a <span class="code">null</span> value for the policy set name, the policy is retrieved from the <i>My Policies</i> policy set. </p> 
  <p><strong>Set the policy’s attributes</strong></p> 
  <p>To modify a policy, you modify the value of policy attributes. The only policy attribute that you cannot change is the name attribute. For example, to change the policy’s offline lease period, you can modify the value of the policy’s offline lease period attribute.</p> 
  <p>When modifying a policy’s offline lease period using a web service, the <span class="code">offlineLeasePeriod</span> field on the <span class="code">PolicySpec</span> interface is ignored. To update the offline lease period, modify the <span class="code">OfflineLeasePeriod</span> element in the PDRL XML document. Then reference the updated PDRL XML document by using the <span class="code">PolicySpec</span> interface’s <span class="code">policyXML</span> data member.</p> 
  <note> 
   <p>For information about other attributes that you can set, see the <span class="code">Policy</span> interface description in the <a href="http://www.adobe.com/go/learn_aemforms_javadocs_63_en">AEM Forms API Reference</a>.</p> 
  </note> 
  <p><strong>Update the policy</strong></p> 
  <p>Before the changes that you make to a policy take affect, you must update the policy with the Document Security service. Changes to policies that are protecting documents are updated the next time that the policy-protected document is synchronized with the Document Security service.</p> 
  <h3 id="modify_existing_policies_using_the_java_api">Modify existing policies using the Java API</h3> 
  <p></p> 
  <p>Modify an existing policy by using the Document Security API (Java):</p> 
  <ol> 
   <li><p>Include project files. </p><p>Include client JAR files, such as adobe-rightsmanagement-client.jar, in your Java project’s class path. </p></li> 
   <li><p>Create a Document Security Client API object. </p> 
    <ul> 
     <li><p>Create a <span class="code">ServiceClientFactory</span> object that contains connection properties. </p></li> 
     <li><p>Create a <span class="code">RightsManagementClient</span> object by using its constructor and passing the <span class="code">ServiceClientFactory</span> object.</p></li> 
    </ul></li> 
   <li><p>Retrieve an existing policy. </p> 
    <ul> 
     <li><p>Create a <span class="code">PolicyManager</span> object by invoking the <span class="code">RightsManagementClient</span> object’s <span class="code">getPolicyManager</span> method.</p></li> 
     <li><p>Create a <span class="code">Policy</span> object that represents the policy to update by invoking the <span class="code">PolicyManager</span> object’s <span class="code">getPolicy</span> method and passing the following values” </p> 
      <ul> 
       <li><p>A string value that represents the policy set name to which the policy belongs. You can specify <span class="code">null</span> that results in the <span class="code">MyPolicies</span> policy set being used. </p></li> 
       <li><p>A string value that represents the policy name. </p></li> 
      </ul></li> 
    </ul></li> 
   <li><p>Set the policy’s attributes. </p><p>Change the policy’s attributes to meet your business requirements. For example, to change the policy’s offline lease period, invoke the <span class="code">Policy</span> object’s <span class="code">setOfflineLeasePeriod</span> method. </p></li> 
   <li><p>Update the policy. </p><p>Update the policy by invoking <span class="code">PolicyManager</span> object’s <span class="code">updatePolicy</span> method. Pass the <span class="code">Policy</span> object that represents the policy to update.</p></li> 
  </ol> 
  <p><strong>Code examples</strong></p> 
  <p>For code examples using the Document Security service, see theQuick Start(SOAP mode): Modifying a policy using the Java API in <i><a href="/programming-with-aem-forms/#java_api_soap_quick_start_code_examples">API Quick Starts (Code Examples)</a></i>.</p> 
  <h3 id="modify_existing_policies_using_the_web_service_api">Modify existing policies using the web service API</h3> 
  <p></p> 
  <p>Modify an existing policy by using the Document Security API (web service):</p> 
  <ol> 
   <li><p>Include project files. </p><p>Create a Microsoft .NET project that uses MTOM. Ensure that you use the following WSDL definition: <span class="code">http://localhost:8080/soap/services/RightsManagementService?WSDL&amp;lc_version=9.0.1</span>. </p> 
    <note> 
     <p>Replace <span class="code">localhost</span> with the IP address of the server hosting AEM Forms. </p> 
    </note></li> 
   <li><p>Create a Document Security Client API object. </p> 
    <ul> 
     <li><p>Create a <span class="code">RightsManagementServiceClient</span> object by using its default constructor. </p></li> 
     <li><p>Create a <span class="code">RightsManagementServiceClient.Endpoint.Address</span> object by using the <span class="code">System.ServiceModel.EndpointAddress</span> constructor. Pass a string value that specifies the WSDL to the AEM Forms service (for example, <span class="code">http://localhost:8080/soap/services/RightsManagementService?WSDL</span>.) You do not need to use the <span class="code">lc_version</span> attribute. This attribute is used when you create a service reference.) </p></li> 
     <li><p>Create a <span class="code">System.ServiceModel.BasicHttpBinding</span> object by getting the value of the <span class="code">RightsManagementServiceClient.Endpoint.Binding</span> field. Cast the return value to <span class="code">BasicHttpBinding</span>. </p></li> 
     <li><p>Set the <span class="code">System.ServiceModel.BasicHttpBinding</span> object’s <span class="code">MessageEncoding</span> field to <span class="code">WSMessageEncoding.Mtom</span>. This value ensures that MTOM is used. </p></li> 
     <li><p>Enable basic HTTP authentication by performing the following tasks:</p> 
      <ul> 
       <li><p>Assign the AEM forms user name to the field <span class="code">RightsManagementServiceClient.ClientCredentials.UserName.UserName</span>.</p></li> 
       <li><p>Assign the corresponding password value to the field <span class="code">RightsManagementServiceClient.ClientCredentials.UserName.Password</span>.</p></li> 
       <li><p>Assign the constant value <span class="code">HttpClientCredentialType.Basic</span> to the field <span class="code">BasicHttpBindingSecurity.Transport.ClientCredentialType</span>. </p></li> 
      </ul></li> 
     <li><p>Assign the constant value <span class="code">BasicHttpSecurityMode.TransportCredentialOnly</span> to the field <span class="code">BasicHttpBindingSecurity.Security.Mode</span>. </p></li> 
    </ul></li> 
   <li><p>Retrieve an existing policy. </p><p>Create a <span class="code">PolicySpec</span> object that represents the policy to modify by invoking the <span class="code">RightsManagementServiceClient</span> object’s <span class="code">getPolicy</span> method and passing the following values:</p> 
    <ul> 
     <li><p>A string value that specifies the policy set name to which the policy belongs. You can specify <span class="code">null</span> that results in the <span class="code">MyPolicies</span> policy set being used. </p></li> 
     <li><p>A string value that specifies the name of the policy. </p></li> 
    </ul></li> 
   <li><p>Set the policy’s attributes. </p><p>Change the policy’s attributes to meet your business requirements. </p></li> 
   <li><p>Update the policy. </p><p>Update the policy by invoking the <span class="code">RightsManagementServiceClient</span> object’s <span class="code">updatePolicyFromSDK</span> method and passing the <span class="code">PolicySpec</span> object that represents the policy to update.</p></li> 
  </ol> 
  <p><strong>Code examples</strong></p> 
  <p>For code examples using the Document Security service, see the following Quick Starts in <i><a href="/programming-with-aem-forms/#java_api_soap_quick_start_code_examples">API Quick Starts (Code Examples)</a></i>:</p> 
  <ul> 
   <li><p>“Quick Start (MTOM): Modifying a policy using the web service API”</p></li> 
   <li><p>“Quick Start (SwaRef): Modifying a policy using the web service API”</p></li> 
  </ul> 
  <draft-comment type="remark">
    Content Referenced from lc_po_delete_policies_dp.xml#WS624e3cba99b79e12e69a9941333732bac8-7cbd.2_ver6.1 
  </draft-comment> 
  <h2 id="deleting_policies">Deleting Policies</h2> 
  <p></p> 
  <p>You can delete an existing policy using the Document Security Java API or web service API. After a policy is deleted, it can no longer be used to protect documents. However, existing policy-protected documents that are using the policy are still protected. You can delete a policy when a newer one becomes available.</p> 
  <note> 
   <p>For more information about the Document Security service, see <a href="http://www.adobe.com/go/learn_aemforms_services_63">Services Reference for AEM Forms</a>.</p> 
  </note> 
  <h3 id="summary_of_steps">Summary of steps</h3> 
  <p></p> 
  <p>To delete an existing policy, perform the following steps:</p> 
  <ol> 
   <li><p>Include project files</p></li> 
   <li><p>Create a Document Security Client API object.</p></li> 
   <li><p>Delete the policy. </p></li> 
  </ol> 
  <p><strong>Include project files</strong></p> 
  <p>Include necessary files into your development project. If you are creating a client application using Java, then include the necessary JAR files. If you are using web services, then make sure that you include the proxy files.</p> 
  <p><strong>Create a Document Security Client API object</strong></p> 
  <p>Before you can programmatically perform a Document Security service operation, you must create a Document Security service client object. If you are using the Java API, create a <span class="code">RightsManagementClient</span> object. If you are using the Document Security web service API, create a <span class="code">RightsManagementServiceService</span> object.</p> 
  <p><strong>Delete the policy</strong></p> 
  <p>To delete a policy, you specify the policy to delete and the policy set to which the policy belongs. The user whose settings are used to invoke AEM Forms must have permission to delete the policy; otherwise an exception occurs. Likewise, if you attempt to delete a policy that does not exist, an exception occurs. </p> 
  <h3 id="delete_policies_using_the_java_api">Delete policies using the Java API</h3> 
  <p></p> 
  <p>Delete a policy by using the Document Security API (Java):</p> 
  <ol> 
   <li><p>Include project files. </p><p>Include client JAR files, such as adobe-rightsmanagement-client.jar, in your Java project’s class path. </p></li> 
   <li><p>Create a Document Security Client API object. </p> 
    <ul> 
     <li><p>Create a <span class="code">ServiceClientFactory</span> object that contains connection properties. </p></li> 
     <li><p>Create a <span class="code">RightsManagementClient</span> object by using its constructor and passing the <span class="code">ServiceClientFactory</span> object.</p></li> 
    </ul></li> 
   <li><p>Delete the policy. </p> 
    <ul> 
     <li><p>Create a <span class="code">PolicyManager</span> object by invoking the <span class="code">RightsManagementClient</span> object’s <span class="code">getPolicyManager</span> method.</p></li> 
     <li><p>Delete the policy by invoking the <span class="code">PolicyManager</span> object’s <span class="code">deletePolicy</span> method and passing the following values:</p> 
      <ul> 
       <li><p>A string value that specifies the policy set name to which the policy belongs. You can specify <span class="code">null</span> that results in the <span class="code">MyPolicies</span> policy set being used. </p></li> 
       <li><p>A string value that specifies the name of the policy to delete.</p></li> 
      </ul></li> 
    </ul></li> 
  </ol> 
  <p><strong>Code examples</strong></p> 
  <p>For code examples using the Document Security service, see the following Quick Starts in <i><a href="/programming-with-aem-forms/#java_api_soap_quick_start_code_examples">API Quick Starts (Code Examples)</a></i>:</p> 
  <ul> 
   <li><p>“Quick Start (SOAP mode): Deleting a policy using the Java API”</p></li> 
  </ul> 
  <h3 id="delete_policies_using_the_web_service_api">Delete policies using the web service API</h3> 
  <p></p> 
  <p>Delete a policy by using the Document Security API (web service):</p> 
  <ol> 
   <li><p>Include project files. </p><p>Create a Microsoft .NET project that uses MTOM. Ensure that you use the following WSDL definition: <span class="code">http://localhost:8080/soap/services/RightsManagementService?WSDL&amp;lc_version=9.0.1</span>. </p> 
    <note> 
     <p>Replace <span class="code">localhost</span> with the IP address of the server hosting AEM Forms. </p> 
    </note></li> 
   <li><p>Create a Document Security Client API object. </p> 
    <ul> 
     <li><p>Create a <span class="code">RightsManagementServiceClient</span> object by using its default constructor. </p></li> 
     <li><p>Create a <span class="code">RightsManagementServiceClient.Endpoint.Address</span> object by using the <span class="code">System.ServiceModel.EndpointAddress</span> constructor. Pass a string value that specifies the WSDL to the AEM Forms service (for example, <span class="code">http://localhost:8080/soap/services/RightsManagementService?WSDL</span>.) You do not need to use the <span class="code">lc_version</span> attribute. This attribute is used when you create a service reference.) </p></li> 
     <li><p>Create a <span class="code">System.ServiceModel.BasicHttpBinding</span> object by getting the value of the <span class="code">RightsManagementServiceClient.Endpoint.Binding</span> field. Cast the return value to <span class="code">BasicHttpBinding</span>. </p></li> 
     <li><p>Set the <span class="code">System.ServiceModel.BasicHttpBinding</span> object’s <span class="code">MessageEncoding</span> field to <span class="code">WSMessageEncoding.Mtom</span>. This value ensures that MTOM is used. </p></li> 
     <li><p>Enable basic HTTP authentication by performing the following tasks:</p> 
      <ul> 
       <li><p>Assign the AEM forms user name to the field <span class="code">RightsManagementServiceClient.ClientCredentials.UserName.UserName</span>.</p></li> 
       <li><p>Assign the corresponding password value to the field <span class="code">RightsManagementServiceClient.ClientCredentials.UserName.Password</span>.</p></li> 
       <li><p>Assign the constant value <span class="code">HttpClientCredentialType.Basic</span> to the field <span class="code">BasicHttpBindingSecurity.Transport.ClientCredentialType</span>. </p></li> 
      </ul></li> 
     <li><p>Assign the constant value <span class="code">BasicHttpSecurityMode.TransportCredentialOnly</span> to the field <span class="code">BasicHttpBindingSecurity.Security.Mode</span>. </p></li> 
    </ul></li> 
   <li><p>Delete the policy. </p><p>Delete a policy by invoking the <span class="code">RightsManagementServiceClient</span> object’s <span class="code">deletePolicy</span> method and passing the following values:</p> 
    <ul> 
     <li><p>A string value that specifies the policy set name to which the policy belongs. You can specify <span class="code">null</span> that results in the <span class="code">MyPolicies</span> policy set being used. </p></li> 
     <li><p>A string value that specifies the name of the policy to delete. </p></li> 
    </ul></li> 
  </ol> 
  <p><strong>Code examples</strong></p> 
  <p>For code examples using the Document Security service, see the following Quick Starts in <i><a href="/programming-with-aem-forms/#java_api_soap_quick_start_code_examples">API Quick Starts (Code Examples)</a></i>:</p> 
  <ul> 
   <li><p>“Quick Start (MTOM): Deleting a policy using the web service API”</p></li> 
   <li><p>“Quick Start (SwaRef): Deleting a policy using the web service API”</p></li> 
  </ul> 
  <draft-comment type="remark">
    Content Referenced from lc_po_apply_policies_ap.xml#WS624e3cba99b79e12e69a9941333732bac8-7cbc.2_ver6.1 
  </draft-comment> 
  <h2 id="applying_policies_to_pdf_documents">Applying Policies to PDF Documents</h2> 
  <p></p> 
  <p>You can apply a policy to a PDF document in order to secure the document. By applying a policy to a PDF document, you restrict access to the document. You cannot apply a policy to a document if the document is already secured with a policy. </p> 
  <p>While the document is open, you can also restrict access to Acrobat and Adobe Reader features, including the ability to print and copy text, make changes, and add signatures and comments to a document. In addition, you can revoke a policy-protected PDF document when you no longer want users to access the document.</p> 
  <p>You can monitor the use of a policy-protected document after you distribute it. That is, you can see how the document is being used and who is using it. For example, you can find out when somebody has opened the document.</p> 
  <note> 
   <p>For more information about the Document Security service, see <a href="http://www.adobe.com/go/learn_aemforms_services_63">Services Reference for AEM Forms</a>.</p> 
  </note> 
  <h3 id="summary_of_steps">Summary of steps</h3> 
  <p></p> 
  <p>To apply a policy to a PDF document, perform the following steps:</p> 
  <ol> 
   <li><p>Include project files.</p></li> 
   <li><p>Create a Document Security Client API object.</p></li> 
   <li><p>Retrieve a PDF document to which a policy is applied.</p></li> 
   <li><p>Apply an existing policy to the PDF document.</p></li> 
   <li><p>Save the policy-protected PDF document.</p></li> 
  </ol> 
  <p><strong>Include project files</strong></p> 
  <p>Include necessary files into your development project. If you are creating a client application using Java, then include the necessary JAR files. If you are using web services, then make sure that you include the proxy files.</p> 
  <p><strong>Create a Document Security Client APIobject</strong></p> 
  <p>Before you can programmatically perform a Document Security service operation, create a Document Security service client object. If you are using the Java API, create a <span class="code">DocumentSecurityClient</span> object. If you are using the Document Security web service API, create a <span class="code">DocumentSecurityServiceService</span> object.</p> 
  <p><strong>Retrieve a PDF document</strong></p> 
  <p>You can retrieve a PDF document in order to apply a policy. After you apply a policy to the PDF document, users are restricted when using the document. For example, if the policy does not enable the document to be opened while offline, then users must be online to open the document.</p> 
  <p><strong>Apply an existing policy to the PDF document</strong></p> 
  <p>To apply a policy to a PDF document, reference an existing policy and specify which policy set the policy belongs to. The user who is setting the connection properties must have access to the specified policy. If not, an exception occurs. </p> 
  <p><strong>Save the PDF document </strong></p> 
  <p>After the Document Security service applies a policy to a PDF document, you can save the policy-protected PDF document as a PDF file.</p> 
  <p><strong>See also</strong></p> 
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-java#including_aem_forms_java_library_files">Including AEM Forms Java library files</a></p> 
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-java#setting_connection_properties">Setting connection properties</a></p> 
  <p><a href="protecting-documents-policies#revoking_access_to_documents">Revoking Access to Documents</a></p> 
  <h3 id="apply_a_policy_to_a_pdf_document_using_the_java_api">Apply a policy to a PDF document using the Java API</h3> 
  <p></p> 
  <p>Apply a policy to a PDF document by using the Document Security API (Java):</p> 
  <ol> 
   <li><p>Include project files. </p><p>Include client JAR files, such as adobe-rightsmanagement-client.jar, in your Java project’s class path. </p></li> 
   <li><p>Create a Document Security Client API object. </p> 
    <ul> 
     <li><p>Create a <span class="code">ServiceClientFactory</span> object that contains connection properties.</p></li> 
     <li><p>Create a <span class="code">RightsManagementClient</span> object by using its constructor and passing the <span class="code">ServiceClientFactory</span> object.</p></li> 
    </ul></li> 
   <li><p>Retrieve a PDF document. </p> 
    <ul> 
     <li><p>Create a <span class="code">java.io.FileInputStream</span> object that represents the PDF document by using its constructor. Pass a string value that specifies the location of the PDF document. </p></li> 
     <li><p>Create a <span class="code">com.adobe.idp.Document</span> object by using its constructor and passing the <span class="code">java.io.FileInputStream</span> object.</p></li> 
    </ul></li> 
   <li><p>Apply an existing policy to the PDF document. </p> 
    <ul> 
     <li><p>Create a <span class="code">DocumentManager</span> object by invoking the <span class="code">RightsManagementClient</span> object’s <span class="code">getDocumentManager</span> method.</p></li> 
     <li><p>Apply a policy to the PDF document by invoking the <span class="code">DocumentManager</span> object’s <span class="code">protectDocument</span> method and passing the following values:</p> 
      <ul> 
       <li><p>The <span class="code">com.adobe.idp.Document</span> object that contains the PDF document to which the policy is applied. </p></li> 
       <li><p>A string value that specifies the name of the document.</p></li> 
       <li><p>A string value that specifies the name of the policy set to which the policy belongs. You can specify a <span class="code">null</span> value that results in the <span class="code">MyPolicies</span> policy set being used. </p></li> 
       <li><p>A string value that specifies the policy name.</p></li> 
       <li><p>A string value that represents the name of the user manager domain of the user who is the publisher of the document. This parameter value is optional and can be null (if this parameter is null, then the next parameter value must be null).</p></li> 
       <li><p>A string value that represents the name of the canonical name of the user manager user who is the publisher of the document. This parameter value is optional and can be <span class="code">null</span> (if this parameter is null, then the previous parameter value must be <span class="code">null</span>).</p></li> 
       <li><p>A <span class="code">com.adobe.livecycle.rightsmanagement.Locale</span> that represents the locale that is used for selecting the MS Office template. This parameter value is optional and not used for PDF documents. To secure a PDF document, specify <span class="code">null</span>. </p></li> 
      </ul><p>The <span class="code">protectDocument</span> method returns a <span class="code">RMSecureDocumentResult</span> object that contains the policy-protected PDF document.</p></li> 
    </ul></li> 
   <li><p>Save the PDF document. </p> 
    <ul> 
     <li><p>Invoke the <span class="code">RMSecureDocumentResult</span> object’s <span class="code">getProtectedDoc</span> method to get the policy-protected PDF document. This method returns a <span class="code">com.adobe.idp.Document</span> object. </p></li> 
     <li><p>Create a <span class="code">java.io.File</span> object and ensure that the file extension is PDF.</p></li> 
     <li><p>Invoke the <span class="code">com.adobe.idp.Document</span> object’s <span class="code">copyToFile</span> method to copy the contents of the <span class="code">Document</span> object to the file (ensure that you use the <span class="code">Document</span> object that was returned by the <span class="code">getProtectedDoc</span> method).</p></li> 
    </ul></li> 
  </ol> 
  <p><strong>Code examples</strong></p> 
  <p>For code examples using the Document Security service, see the following Quick Starts in <i><a href="/programming-with-aem-forms/#java_api_soap_quick_start_code_examples">API Quick Starts (Code Examples)</a></i>:</p> 
  <ul> 
   <li><p>“Quick Start (EJB mode): Applying a policy to a PDF document using the Java API”</p></li> 
   <li><p>“Quick Start (SOAP mode): Applying a policy to a PDF document using the Java API”</p></li> 
  </ul> 
  <p><strong>See also</strong></p> 
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-java#including_aem_forms_java_library_files">Including AEM Forms Java library files</a></p> 
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-java#setting_connection_properties">Setting connection properties</a></p> 
  <h3 id="apply_a_policy_to_a_pdf_document_using_the_web_service_api">Apply a policy to a PDF document using the web service API</h3> 
  <p></p> 
  <p>Apply a policy to a PDF document by using the Document Security API (web service):</p> 
  <ol> 
   <li><p>Include project files. </p><p>Create a Microsoft .NET project that uses MTOM. Ensure that you use the following WSDL definition: <span class="code">http://localhost:8080/soap/services/RightsManagementService?WSDL&amp;lc_version=9.0.1</span>. </p> 
    <note> 
     <p>Replace <span class="code">localhost</span> with the IP address of the server hosting AEM Forms. </p> 
    </note></li> 
   <li><p>Create a Document Security Client API object. </p> 
    <ul> 
     <li><p>Create a <span class="code">RightsManagementServiceClient</span> object by using its default constructor. </p></li> 
     <li><p>Create a <span class="code">RightsManagementServiceClient.Endpoint.Address</span> object by using the <span class="code">System.ServiceModel.EndpointAddress</span> constructor. Pass a string value that specifies the WSDL to the Forms service (for example, <span class="code">http://localhost:8080/soap/services/RightsManagementService?WSDL</span>.) You do not need to use the <span class="code">lc_version</span> attribute. This attribute is used when you create a service reference.) </p></li> 
     <li><p>Create a <span class="code">System.ServiceModel.BasicHttpBinding</span> object by getting the value of the <span class="code">RightsManagementServiceClient.Endpoint.Binding</span> field. Cast the return value to <span class="code">BasicHttpBinding</span>. </p></li> 
     <li><p>Set the <span class="code">System.ServiceModel.BasicHttpBinding</span> object’s <span class="code">MessageEncoding</span> field to <span class="code">WSMessageEncoding.Mtom</span>. This value ensures that MTOM is used. </p></li> 
     <li><p>Enable basic HTTP authentication by performing the following tasks:</p> 
      <ul> 
       <li><p>Assign the AEM forms user name to the field <span class="code">RightsManagementServiceClient.ClientCredentials.UserName.UserName</span>.</p></li> 
       <li><p>Assign the corresponding password value to the field <span class="code">RightsManagementServiceClient.ClientCredentials.UserName.Password</span>.</p></li> 
       <li><p>Assign the constant value <span class="code">HttpClientCredentialType.Basic</span> to the field <span class="code">BasicHttpBindingSecurity.Transport.ClientCredentialType</span>. </p></li> 
      </ul></li> 
     <li><p>Assign the constant value <span class="code">BasicHttpSecurityMode.TransportCredentialOnly</span> to the field <span class="code">BasicHttpBindingSecurity.Security.Mode</span>. </p></li> 
    </ul></li> 
   <li><p>Retrieve a PDF document. </p> 
    <ul> 
     <li><p>Create a <span class="code">BLOB</span> object by using its constructor. The <span class="code">BLOB</span> object is used to store a PDF document to which a policy is applied.</p></li> 
     <li><p>Create a <span class="code">System.IO.FileStream</span> object by invoking its constructor and passing a string value that represents the file location of the PDF document and the mode in which to open the file.</p></li> 
     <li><p>Create a byte array that stores the content of the <span class="code">System.IO.FileStream</span> object. Determine the byte array size by getting the <span class="code">System.IO.FileStream</span> object’s <span class="code">Length</span> property.</p></li> 
     <li><p>Populate the byte array with stream data by invoking the <span class="code">System.IO.FileStream</span> object’s <span class="code">Read</span> method. Pass the byte array, the starting position, and the stream length to read.</p></li> 
     <li><p>Populate the <span class="code">BLOB</span> object by assigning its <span class="code">MTOM</span> field with the contents of the byte array.</p></li> 
    </ul></li> 
   <li><p>Apply an existing policy to the PDF document. </p><p>Apply a policy to the PDF document by invoking the <span class="code">RightsManagementServiceClient</span> object’s <span class="code">protectDocument</span> method and passing the following values:</p> 
    <ul> 
     <li><p>The <span class="code">BLOB</span> object that contains the PDF document to which the policy is applied.</p></li> 
     <li><p>A string value that specifies the name of the document.</p></li> 
     <li><p>A string value that specifies the name of the policy set to which the policy belongs. You can specify a <span class="code">null</span> value that results in the <span class="code">MyPolicies</span> policy set being used. </p></li> 
     <li><p>A string value that specifies the policy name.</p></li> 
     <li><p>A string value that represents the name of the user manager domain of the user who is the publisher of the document. This parameter value is optional and can be null (if this parameter is null, then the next parameter value must be <span class="code">null</span>).</p></li> 
     <li><p>A string value that represents the name of the canonical name of the user manager user who is the publisher of the document. This parameter value is optional and can be null (if this parameter is null, then the previous parameter value must be <span class="code">null</span>).</p></li> 
     <li><p>A <span class="code">RMLocale</span> value that specifies the locale value (for example, <span class="code">RMLocale.en</span>).</p></li> 
     <li><p>A string output parameter that is used to store the policy identifier value. </p></li> 
     <li><p>A string output parameter that is used to store the policy-protected identifier value. </p></li> 
     <li><p>A string output parameter that is used to store the mime type (for example, <span class="code">application/pdf</span>). </p></li> 
    </ul><p>The <span class="code">protectDocument</span> method returns a <span class="code">BLOB</span> object that contains the policy-protected PDF document.</p></li> 
   <li><p>Save the PDF document. </p> 
    <ul> 
     <li><p>Create a <span class="code">System.IO.FileStream</span> object by invoking its constructor and passing a string value that represents the file location of the policy-protected PDF document.</p></li> 
     <li><p>Create a byte array that stores the data content of the <span class="code">BLOB</span> object that was returned by the <span class="code">protectDocument</span> method. Populate the byte array by getting the value of the <span class="code">BLOB</span> object’s <span class="code">MTOM</span> data member.</p></li> 
     <li><p>Create a <span class="code">System.IO.BinaryWriter</span> object by invoking its constructor and passing the <span class="code">System.IO.FileStream</span> object.</p></li> 
     <li><p>Write the contents of the byte array to a PDF file by invoking the <span class="code">System.IO.BinaryWriter</span> object’s <span class="code">Write</span> method and passing the byte array.</p></li> 
    </ul></li> 
  </ol> 
  <p><strong>Code examples</strong></p> 
  <p>For code examples using the Document Security service, see the following Quick Starts in <i><a href="/programming-with-aem-forms/#java_api_soap_quick_start_code_examples">API Quick Starts (Code Examples)</a></i>:</p> 
  <ul> 
   <li><p>“Quick Start (MTOM): Applying a policy to a PDF document using the web service API”</p></li> 
   <li><p>“Quick Start (SwaRef): Applying a policy to a PDF document using the web service API ”</p></li> 
  </ul> 
  <draft-comment type="remark">
    Content Referenced from lc_po_remove_policies_rp.xml#WS624e3cba99b79e12e69a9941333732bac8-7cbb.2_ver6.1 
  </draft-comment> 
  <h2 id="removing_policies_from_pdf_documents">Removing Policies from PDF Documents</h2> 
  <p></p> 
  <p>You can remove a policy from a policy-protected document in order to remove security from the document. That is, if you no longer want the document to be protected by a policy. If you want to update a policy-protected document with a newer policy, then instead of removing the policy and adding the updated policy, it is more efficient to switch the policy.</p> 
  <note> 
   <p>For more information about the Document Security service, see <a href="http://www.adobe.com/go/learn_aemforms_services_63">Services Reference for AEM Forms</a>.</p> 
  </note> 
  <h3 id="summary_of_steps">Summary of steps</h3> 
  <p></p> 
  <p>To remove a policy from a policy-protected PDF document, perform the following steps:</p> 
  <ol> 
   <li><p>Include project files</p></li> 
   <li><p>Create a Document Security Client API object.</p></li> 
   <li><p>Retrieve a policy-protected PDF document.</p></li> 
   <li><p>Remove the policy from the PDF document.</p></li> 
   <li><p>Save the unsecured PDF document.</p></li> 
  </ol> 
  <p><strong>Include project files</strong></p> 
  <p>Include necessary files into your development project. If you are creating a client application using Java, then include the necessary JAR files. If you are using web services, then make sure that you include the proxy files.</p> 
  <p><strong>Create a Document Security Client API object</strong></p> 
  <p>Before you can programmatically perform a Document Security service operation, create a Document Security service client object. </p> 
  <p><strong>Retrieve a policy-protected PDF document</strong></p> 
  <p>You can retrieve a policy-protected PDF document in order to remove a policy. If you attempt to remove a policy from a PDF document that is not protected by a policy, you will cause an exception. </p> 
  <p><strong>Remove the policy from the PDF document</strong></p> 
  <p>You can remove a policy from a policy-protected PDF document provided that an administrator is specified in the connection settings. If not, then the policy used to secure a document must contain the <span class="code">SWITCH_POLICY</span> permission in order to remove a policy from a PDF document. Also, the user specified in the AEM Forms connection settings must also have that permission. Otherwise, an exception is thrown. </p> 
  <p><strong>Save the unsecured PDF document </strong></p> 
  <p>After the Document Security service removes a policy from a PDF document, you can save the unsecured PDF document as a PDF file.</p> 
  <p><strong>See also</strong></p> 
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-java#including_aem_forms_java_library_files">Including AEM Forms Java library files</a></p> 
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-java#setting_connection_properties">Setting connection properties</a></p> 
  <p><a href="protecting-documents-policies#applying_policies_to_pdf_documents">Applying Policies to PDF Documents</a></p> 
  <h3 id="remove_a_policy_from_a_pdf_document_using_the_java_api">Remove a policy from a PDF document using the Java API</h3> 
  <p></p> 
  <p>Remove a policy from a policy-protected PDF document by using the Document Security API (Java):</p> 
  <ol> 
   <li><p>Include project files. </p><p>Include client JAR files, such as adobe-rightsmanagement-client.jar, in your Java project’s class path. </p></li> 
   <li><p>Create a Document Security Client API object. </p> 
    <ul> 
     <li><p>Create a <span class="code">ServiceClientFactory</span> object that contains connection properties.</p></li> 
     <li><p>Create a <span class="code">DocumentSecurityClient</span> object by using its constructor and passing the <span class="code">ServiceClientFactory</span> object.</p></li> 
    </ul></li> 
   <li><p>Retrieve a policy-protected PDF document. </p> 
    <ul> 
     <li><p>Create a <span class="code">java.io.FileInputStream</span> object that represents the policy-protected PDF document by using its constructor and passing a string value that specifies the location of the PDF document. </p></li> 
     <li><p>Create a <span class="code">com.adobe.idp.Document</span> object by using its constructor and passing the <span class="code">java.io.FileInputStream</span> object.</p></li> 
    </ul></li> 
   <li><p>Remove the policy from the PDF document. </p> 
    <ul> 
     <li><p>Create a <span class="code">DocumentManager</span> object by invoking the <span class="code">DocumentSecurityClient</span> object’s <span class="code">getDocumentManager</span> method.</p></li> 
     <li><p>Remove a policy from the PDF document by invoking the <span class="code">DocumentManager</span> object’s <span class="code">removeSecurity</span> method and passing the <span class="code">com.adobe.idp.Document</span> object that contains the policy-protected PDF document. This method returns a <span class="code">com.adobe.idp.Document</span> object that contains an unsecured PDF document.</p></li> 
    </ul></li> 
   <li><p>Save the unsecured PDF document. </p> 
    <ul> 
     <li><p>Create a <span class="code">java.io.File</span> object and ensure that the file extension is PDF.</p></li> 
     <li><p>Invoke the <span class="code">Document</span> object’s <span class="code">copyToFile</span> method to copy the contents of the <span class="code">Document</span> object to the file (ensure that you use the <span class="code">Document</span> object that was returned by the <span class="code">removeSecurity</span> method).</p></li> 
    </ul></li> 
  </ol> 
  <p><strong>Code examples</strong></p> 
  <p>For code examples using the Document Security service, see the following Quick Starts in <i><a href="/programming-with-aem-forms/#java_api_soap_quick_start_code_examples">API Quick Starts (Code Examples)</a></i>:</p> 
  <ul> 
   <li><p>“Quick Start (SOAP mode): Removing a policy from a PDF document using the Java API”</p></li> 
  </ul> 
  <h3 id="remove_a_policy_using_the_web_service_api">Remove a policy using the web service API</h3> 
  <p></p> 
  <p>Remove a policy from a policy-protected PDF document using the Document Security API (web service):</p> 
  <ol> 
   <li><p>Include project files. </p><p>Create a Microsoft .NET project that uses MTOM. Ensure that you use the following WSDL definition: <span class="code">http://localhost:8080/soap/services/RightsManagementService?WSDL&amp;lc_version=9.0.1</span>. </p> 
    <note> 
     <p>Replace <span class="code">localhost</span> with the IP address of the server hosting AEM Forms. </p> 
    </note></li> 
   <li><p>Create a Document Security Client API object. </p> 
    <ul> 
     <li><p>Create a <span class="code">DocumentSecurityServiceClient</span> object by using its default constructor. </p></li> 
     <li><p>Create a <span class="code">DocumentSecurityServiceClient.Endpoint.Address</span> object by using the <span class="code">System.ServiceModel.EndpointAddress</span> constructor. Pass a string value that specifies the WSDL to the AEM Forms service (for example, <span class="code">http://localhost:8080/soap/services/RightsManagementService?WSDL</span>.) You do not need to use the <span class="code">lc_version</span> attribute. This attribute is used when you create a service reference.) </p></li> 
     <li><p>Create a <span class="code">System.ServiceModel.BasicHttpBinding</span> object by getting the value of the <span class="code">DocumentSecurityServiceClient.Endpoint.Binding</span> field. Cast the return value to <span class="code">BasicHttpBinding</span>. </p></li> 
     <li><p>Set the <span class="code">System.ServiceModel.BasicHttpBinding</span> object’s <span class="code">MessageEncoding</span> field to <span class="code">WSMessageEncoding.Mtom</span>. This value ensures that MTOM is used. </p></li> 
     <li><p>Enable basic HTTP authentication by performing the following tasks:</p> 
      <ul> 
       <li><p>Assign the AEM forms user name to the field <span class="code">DocumentSecurityServiceClient.ClientCredentials.UserName.UserName</span>.</p></li> 
       <li><p>Assign the corresponding password value to the field <span class="code">DocumentSecurityServiceClient.ClientCredentials.UserName.Password</span>.</p></li> 
       <li><p>Assign the constant value <span class="code">HttpClientCredentialType.Basic</span> to the field <span class="code">BasicHttpBindingSecurity.Transport.ClientCredentialType</span>. </p></li> 
      </ul></li> 
     <li><p>Assign the constant value <span class="code">BasicHttpSecurityMode.TransportCredentialOnly</span> to the field <span class="code">BasicHttpBindingSecurity.Security.Mode</span>. </p></li> 
    </ul></li> 
   <li><p>Retrieve a policy-protected PDF document. </p> 
    <ul> 
     <li><p>Create a <span class="code">BLOB</span> object by using its constructor. The <span class="code">BLOB</span> object is used to store the policy-protected PDF document from which the policy is removed.</p></li> 
     <li><p>Create a <span class="code">System.IO.FileStream</span> object by invoking its constructor and passing a string value that represents the file location of the PDF document and the mode in which to open the file. </p></li> 
     <li><p>Create a byte array that stores the content of the <span class="code">System.IO.FileStream</span> object. You can determine the size of the byte array by getting the <span class="code">System.IO.FileStream</span> object’s <span class="code">Length</span> property. </p></li> 
     <li><p>Populate the byte array with stream data by invoking the <span class="code">System.IO.FileStream</span> object’s <span class="code">Read</span> method and passing the byte array, the starting position, and the stream length to read.</p></li> 
     <li><p>Populate the <span class="code">BLOB</span> object by assigning its <span class="code">MTOM</span> field with the contents of the byte array.</p></li> 
    </ul></li> 
   <li><p>Remove the policy from the PDF document. </p><p>Remove the policy from the PDF document by invoking the <span class="code">DocumentSecurityServiceClient</span> object’s <span class="code">removePolicySecurity</span> method and passing the <span class="code">BLOB</span> object that contains the policy-protected PDF document. This method returns a <span class="code">BLOB</span> object that contains an unsecured PDF document.</p></li> 
   <li><p>Save the unsecured PDF document. </p> 
    <ul> 
     <li><p>Create a <span class="code">System.IO.FileStream</span> object by invoking its constructor and passing a string value that represents the file location of the unsecured PDF document.</p></li> 
     <li><p>Create a byte array that stores the data content of the <span class="code">BLOB</span> object that was returned by the <span class="code">removePolicySecurity</span> method. Populate the byte array by getting the value of the <span class="code">BLOB</span> object’s <span class="code">MTOM</span> field.</p></li> 
     <li><p>Create a <span class="code">System.IO.BinaryWriter</span> object by invoking its constructor and passing the <span class="code">System.IO.FileStream</span> object.</p></li> 
    </ul></li> 
  </ol> 
  <p><strong>Code examples</strong></p> 
  <p>For code examples using the Document Security service, see the following Quick Starts in <i><a href="/programming-with-aem-forms/#java_api_soap_quick_start_code_examples">API Quick Starts (Code Examples)</a></i>:</p> 
  <ul> 
   <li><p>“Quick Start (MTOM): Removing a policy from a PDF document using the web service API ”</p></li> 
   <li><p>“Quick Start (SwaRef): Removing a policy from a PDF document using the web service API”</p></li> 
  </ul> 
  <p><strong>See also</strong></p> 
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-web#invoking_aem_forms_using_mtom">Invoking AEM Forms using MTOM</a></p> 
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-web#invoking_aem_forms_using_swaref">Invoking AEM Forms using SwaRef</a></p> 
  <draft-comment type="remark">
    Content Referenced from lc_po_revoke_access_ra.xml#WS624e3cba99b79e12e69a9941333732bac8-7cba.2_ver6.1 
  </draft-comment> 
  <h2 id="revoking_access_to_documents">Revoking Access to Documents</h2> 
  <p></p> 
  <p>You can revoke access to a policy-protected PDF document resulting in all copies of the document being inaccessible to users. When a user attempts to open a revoked PDF document, they are redirected to a specified URL where a revised document can be viewed. The URL to where the user is redirected must be programmatically specified. When you revoke access to a document, the change takes effect the next time the user synchronizes with the Document Security service by opening the policy-protected document online.</p> 
  <p>The ability to revoke access to a document provides additional security. For example, assume a newer version of a document is available and you no longer want anyone viewing the outdated version. In this situation, access to the older document can be revoked, and nobody can view the document unless access is reinstated. </p> 
  <note> 
   <p>For more information about the Document Security service, see <a href="http://www.adobe.com/go/learn_aemforms_services_63">Services Reference for AEM Forms</a>.</p> 
  </note> 
  <h3 id="summary_of_steps">Summary of steps</h3> 
  <p></p> 
  <p>To revoke a policy-protected document, perform the following steps:</p> 
  <ol> 
   <li><p>Include project files.</p></li> 
   <li><p>Create a Document Security Client API object.</p></li> 
   <li><p>Retrieve a policy-protected PDF document.</p></li> 
   <li><p>Revoke the policy-protected document. </p></li> 
  </ol> 
  <p><strong>Include project files</strong></p> 
  <p>Include necessary files into your development project. If you are creating a client application using Java, then include the necessary JAR files. If you are using web services, then make sure that you include the proxy files.</p> 
  <p><strong>Create a Document Security Client API object</strong></p> 
  <p>Before you can programmatically perform a Document Security service operation, you must create a Document Security service client object. </p> 
  <p><strong>Retrieve a policy-protected PDF document</strong></p> 
  <p>You must retrieve a policy-protected PDF document in order to revoke it. You cannot revoke a document that has already been revoked or is not a policy-protected document.</p> 
  <p>If you know the license identifier value of the policy-protected document, then it is not necessary to retrieve the policy-protected PDF document. However, in most cases, you will need to retrieve the PDF document in order to obtain the license identifier value. </p> 
  <p><strong>Revoke the policy-protected document</strong></p> 
  <p>To revoke a policy-protected document, specify the license identifier of the policy-protected document. In addition, you can specify the URL of a document that the user can view when they attempt to open the revoked document. That is, assume that an outdated document is revoked. When a user attempts to open the revoked document, they will see an updated document instead of the revoked document.</p> 
  <note> 
   <p>If you attempt to revoke a document that is already revoked, an exception is thrown. </p> 
  </note> 
  <p><strong>See also</strong></p> 
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-java#including_aem_forms_java_library_files">Including AEM Forms Java library files</a></p> 
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-java#setting_connection_properties">Setting connection properties</a></p> 
  <p><a href="protecting-documents-policies#applying_policies_to_pdf_documents">Applying Policies to PDF Documents</a></p> 
  <p><a href="protecting-documents-policies#reinstating_access_to_revoked_documents">Reinstating Access to Revoked Documents</a></p> 
  <h3 id="revoke_access_to_documents_using_the_java_api">Revoke access to documents using the Java API</h3> 
  <p></p> 
  <p>Revoke access to a policy-protected PDF document by using the Document Security API (Java):</p> 
  <ol> 
   <li><p>Include project files </p><p>Include client JAR files, such as adobe-rightsmanagement-client.jar, in your Java project’s class path.</p></li> 
   <li><p>Create a Document Security Client API object </p> 
    <ul> 
     <li><p>Create a <span class="code">ServiceClientFactory</span> object that contains connection properties. </p></li> 
     <li><p>Create a <span class="code">DocumentSecurityClient</span> object by using its constructor and passing the <span class="code">ServiceClientFactory</span> object.</p></li> 
    </ul></li> 
   <li><p>Retrieve a policy-protected PDF document </p> 
    <ul> 
     <li><p>Create a <span class="code">java.io.FileInputStream</span> object that represent the policy-protected PDF document by using its constructor and passing a string value that specifies the location of the PDF document.</p></li> 
     <li><p>Create a <span class="code">com.adobe.idp.Document</span> object by using its constructor and passing the <span class="code">java.io.FileInputStream</span> object.</p></li> 
    </ul></li> 
   <li><p>Revoke the policy-protected document </p> 
    <ul> 
     <li><p>Create a <span class="code">DocumentManager</span> object by invoking the <span class="code">DocumentSecurityClient</span> object’s <span class="code">getDocumentManager</span> method.</p></li> 
     <li><p>Retrieve the license identifier value of the policy-protected document by invoking the <span class="code">DocumentManager</span> object’s <span class="code">getLicenseId</span> method. Pass the <span class="code">com.adobe.idp.Document</span> object that represents the policy-protected document. This method returns a string value that represents the license identifier value.</p></li> 
     <li><p>Create a <span class="code">LicenseManager</span> object by invoking the <span class="code">DocumentSecurityClient</span> object’s <span class="code">getLicenseManager</span> method. </p></li> 
     <li><p>Revoke the policy-protected document by invoking the <span class="code">LicenseManager</span> object’s <span class="code">revokeLicense</span> method and passing the following values:</p> 
      <ul> 
       <li><p>A string value that specifies the license identifier value of the policy-protected document (specify the return value of the <span class="code">DocumentManager</span> object’s <span class="code">getLicenseId</span> method). </p></li> 
       <li><p>A static data member of the <span class="code">License</span> interface that specifies the reason to revoke the document. For example, you can specify <span class="code">License.DOCUMENT_REVISED</span>. </p></li> 
       <li><p>A <span class="code">java.net.URL</span> value that specifies the location to where a revised document is located. If you do not want to redirect a user to another URL, then you can pass <span class="code">null</span>. </p></li> 
      </ul></li> 
    </ul></li> 
  </ol> 
  <p><strong>Code examples</strong></p> 
  <p>For code examples using the Document Security service, see the following Quick Starts in <i><a href="/programming-with-aem-forms/#java_api_soap_quick_start_code_examples">API Quick Starts (Code Examples)</a></i>:</p> 
  <ul> 
   <li><p>“Quick Start (SOAP mode): Revoking a document using the Java API”</p></li> 
  </ul> 
  <h3 id="revoke_access_to_documents_using_the_web_service_api">Revoke access to documents using the web service API</h3> 
  <p></p> 
  <p>Revoke access to a policy-protected PDF document by using the Document Security API (web service):</p> 
  <ol> 
   <li><p>Include project files </p><p>Create a Microsoft .NET project that uses MTOM. Ensure that you use the following WSDL definition: <span class="code">http://localhost:8080/soap/services/RightsManagementService?WSDL&amp;lc_version=9.0.1</span>. </p> 
    <note> 
     <p>Replace <span class="code">localhost</span> with the IP address of the server hosting AEM Forms. </p> 
    </note></li> 
   <li><p>Create a Document Security Client API object </p> 
    <ul> 
     <li><p>Create a <span class="code">DocumentSecurityServiceClient</span> object by using its default constructor. </p></li> 
     <li><p>Create a <span class="code">DocumentSecurityServiceClient.Endpoint.Address</span> object by using the <span class="code">System.ServiceModel.EndpointAddress</span> constructor. Pass a string value that specifies the WSDL to the AEM Forms service (for example, <span class="code">http://localhost:8080/soap/services/RightsManagementService?WSDL</span>.) You do not need to use the <span class="code">lc_version</span> attribute. This attribute is used when you create a service reference.) </p></li> 
     <li><p>Create a <span class="code">System.ServiceModel.BasicHttpBinding</span> object by getting the value of the <span class="code">DocumentSecurityServiceClient.Endpoint.Binding</span> field. Cast the return value to <span class="code">BasicHttpBinding</span>. </p></li> 
     <li><p>Set the <span class="code">System.ServiceModel.BasicHttpBinding</span> object’s <span class="code">MessageEncoding</span> field to <span class="code">WSMessageEncoding.Mtom</span>. This value ensures that MTOM is used. </p></li> 
     <li><p>Enable basic HTTP authentication by performing the following tasks:</p> 
      <ul> 
       <li><p>Assign the AEM forms user name to the field <span class="code">DocumentSecurityServiceClient.ClientCredentials.UserName.UserName</span>.</p></li> 
       <li><p>Assign the corresponding password value to the field <span class="code">DocumentSecurityServiceClient.ClientCredentials.UserName.Password</span>.</p></li> 
       <li><p>Assign the constant value <span class="code">HttpClientCredentialType.Basic</span> to the field <span class="code">BasicHttpBindingSecurity.Transport.ClientCredentialType</span>. </p></li> 
      </ul></li> 
     <li><p>Assign the constant value <span class="code">BasicHttpSecurityMode.TransportCredentialOnly</span> to the field <span class="code">BasicHttpBindingSecurity.Security.Mode</span>. </p></li> 
    </ul></li> 
   <li><p>Retrieve a policy-protected PDF document </p> 
    <ul> 
     <li><p>Create a <span class="code">BLOB</span> object by using its constructor. The <span class="code">BLOB</span> object is used to store a policy-protected PDF document that is revoked.</p></li> 
     <li><p>Create a <span class="code">System.IO.FileStream</span> object by invoking its constructor and passing a string value that represents the file location of the policy-protected PDF document to revoke and the mode in which to open the file.</p></li> 
     <li><p>Create a byte array that stores the content of the <span class="code">System.IO.FileStream</span> object. You can determine the size of the byte array by getting the <span class="code">System.IO.FileStream</span> object’s <span class="code">Length</span> property. </p></li> 
     <li><p>Populate the byte array with stream data by invoking the <span class="code">System.IO.FileStream</span> object’s <span class="code">Read</span> method and passing the byte array, the starting position, and the stream length to read.</p></li> 
     <li><p>Populate the <span class="code">BLOB</span> object by assigning its <span class="code">MTOM</span> field with the contents of the byte array.</p></li> 
    </ul></li> 
   <li><p>Revoke the policy-protected document </p> 
    <ul> 
     <li><p>Retrieve the license identifier value of the policy-protected document by invoking the <span class="code">DocumentSecurityServiceClient</span> object’s <span class="code">getLicenseID</span> method and passing the <span class="code">BLOB</span> object that represents the policy-protected document. This method returns a string value that represents the license identifier.</p></li> 
     <li><p>Revoke the policy-protected document by invoking the <span class="code">DocumentSecurityServiceClient</span> object’s <span class="code">revokeLicense</span> method and passing the following values:</p> 
      <ul> 
       <li><p>A string value that specifies the license identifier value of the policy-protected document (specify the return value of the <span class="code">DocumentSecurityServiceService</span> object’s <span class="code">getLicenseId</span> method). </p></li> 
       <li><p>A static data member of the <span class="code">Reason</span> enum that specifies the reason to revoke the document. For example, you can specify <span class="code">Reason.DOCUMENT_REVISED</span>.</p></li> 
       <li><p>A <span class="code">string</span> value that specifies the URL location to where a revised document is located. If you do not want to redirect a user to another URL, then you can pass <span class="code">null</span>. </p></li> 
      </ul></li> 
    </ul></li> 
  </ol> 
  <p><strong>Code examples</strong></p> 
  <p>For code examples using the Document Security service, see the following Quick Starts in <i><a href="/programming-with-aem-forms/#java_api_soap_quick_start_code_examples">API Quick Starts (Code Examples)</a></i>:</p> 
  <ul> 
   <li><p>“Quick Start (MTOM): Revoking a document using the web service API”</p></li> 
   <li><p>“Quick Start (SwaRef): Revoking a document using the web service API”</p></li> 
  </ul> 
  <p><strong>See also</strong></p> 
  <p><a href="protecting-documents-policies#removing_policies_from_word_documents">Removing Policies from Word Documents</a></p> 
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-web#invoking_aem_forms_using_mtom">Invoking AEM Forms using MTOM</a></p> 
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-web#invoking_aem_forms_using_swaref">Invoking AEM Forms using SwaRef</a></p> 
  <draft-comment type="remark">
    Content Referenced from lc_po_reinstate_access_ra.xml#WS624e3cba99b79e12e69a9941333732bac8-7cb9.2_ver6.1 
  </draft-comment> 
  <h2 id="reinstating_access_to_revoked_documents">Reinstating Access to Revoked Documents</h2> 
  <p></p> 
  <p>You can reinstate access to a revoked PDF document, resulting in all copies of the revoked document being accessible to users. When a user opens a reinstated document that was revoked, the user is able to view the document.</p> 
  <note> 
   <p>For more information about the Document Security service, see <a href="http://www.adobe.com/go/learn_aemforms_services_63">Services Reference for AEM Forms</a>.</p> 
  </note> 
  <h3 id="summary_of_steps">Summary of steps</h3> 
  <p></p> 
  <p>To reinstate access to a revoked PDF document, perform the following steps:</p> 
  <ol> 
   <li><p>Include project files.</p></li> 
   <li><p>Create a Document Security Client API object.</p></li> 
   <li><p>Retrieve the license identifier of the revoked PDF document.</p></li> 
   <li><p>Reinstate access to the revoked PDF document.</p></li> 
  </ol> 
  <p><strong>Include project files</strong></p> 
  <p>Include necessary files into your development project. If you are creating a client application using Java, then include the necessary JAR files. If you are using web services, then make sure that you include the proxy files.</p> 
  <p><strong>Create a Document Security Client API object</strong></p> 
  <p>Before you can programmatically perform a Document Security service operation, you must create a Document Security service client object. If you are using the Java API, create a <span class="code">DocumentSecurityClient</span> object. If you are using the Document Security web service API, create a <span class="code">DocumentSecurityServiceService</span> object.</p> 
  <p><strong>Retrieve the license identifier of the revoked PDF document</strong></p> 
  <p>You must retrieve the license identifier of the revoked PDF document in order to reinstate a revoked PDF document. After you obtain the license identifier value, you can reinstate a revoked document. If you attempt to reinstate a document that is not revoked, you will cause an exception. </p> 
  <p><strong>Reinstate access to the revoked PDF document</strong></p> 
  <p>To reinstate access to a revoked PDF document, you must specify the license identifier of the revoked document. If you attempt to reinstate access to a PDF document that is not revoked, you will cause an exception. </p> 
  <p><strong>See also</strong></p> 
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-java#including_aem_forms_java_library_files">Including AEM Forms Java library files</a></p> 
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-java#setting_connection_properties">Setting connection properties</a></p> 
  <p><a href="protecting-documents-policies#applying_policies_to_pdf_documents">Applying Policies to PDF Documents</a></p> 
  <p><a href="protecting-documents-policies#revoking_access_to_documents">Revoking Access to Documents</a></p> 
  <h3 id="reinstate_access_to_revoked_documents_using_the_java_api">Reinstate access to revoked documents using the Java API</h3> 
  <p></p> 
  <p>Reinstate access to a revoked document by using the Document Security API (Java):</p> 
  <ol> 
   <li><p>Include project files. </p><p>Include client JAR files, such as adobe-rightsmanagement-client.jar, in your Java project’s class path.</p></li> 
   <li><p>Create a Document Security Client API object. </p> 
    <ul> 
     <li><p>Create a <span class="code">ServiceClientFactory</span> object that contains connection properties.</p></li> 
     <li><p>Create a <span class="code">DocumentSecurityClient</span> object by using its constructor and passing the <span class="code">ServiceClientFactory</span> object.</p></li> 
    </ul></li> 
   <li><p>Retrieve the license identifier of the revoked PDF document. </p> 
    <ul> 
     <li><p>Create a <span class="code">java.io.FileInputStream</span> object that represents the revoked PDF document by using its constructor and passing a string value that specifies the location of the PDF document. </p></li> 
     <li><p>Create a <span class="code">com.adobe.idp.Document</span> object by using its constructor and passing the <span class="code">java.io.FileInputStream</span> object.</p></li> 
     <li><p>Create a <span class="code">DocumentManager</span> object by invoking the <span class="code">DocumentSecurityClient</span> object’s <span class="code">getDocumentManager</span> method.</p></li> 
     <li><p>Retrieve the license identifier value of the revoked document by invoking the <span class="code">DocumentManager</span> object’s <span class="code">getLicenseId</span> method and passing the <span class="code">com.adobe.idp.Document</span> object that represents the revoked document. This method returns a string value that represents the license identifier.</p></li> 
    </ul></li> 
   <li><p>Reinstate access to the revoked PDF document. </p> 
    <ul> 
     <li><p>Create a <span class="code">LicenseManager</span> object by invoking the <span class="code">DocumentSecurityClient</span> object’s <span class="code">getLicenseManager</span> method. </p></li> 
     <li><p>Reinstate access to the revoked PDF document by invoking the <span class="code">LicenseManager</span> object’s <span class="code">unrevokeLicense</span> method and passing the license identifier value of the revoked document.</p></li> 
    </ul></li> 
  </ol> 
  <p><strong>Code examples</strong></p> 
  <p>For code examples using the Document Security service, see the following Quick Starts in <i><a href="/programming-with-aem-forms/#java_api_soap_quick_start_code_examples">API Quick Starts (Code Examples)</a></i>:</p> 
  <ul> 
   <li><p>“Quick Start (SOAP mode): Reinstating access to a revoked document using the web service API”</p></li> 
  </ul> 
  <h3 id="reinstate_access_to_revoked_documents_using_the_web_service_api">Reinstate access to revoked documents using the web service API</h3> 
  <p></p> 
  <p>Reinstate access to a revoked document using the Document Security API (web service):</p> 
  <ol> 
   <li><p>Include project files. </p><p>Create a Microsoft .NET project that uses MTOM. Ensure that you use the following WSDL definition: <span class="code">http://localhost:8080/soap/services/RightsManagementService?WSDL&amp;lc_version=9.0.1</span>. </p> 
    <note> 
     <p>Replace <span class="code">localhost</span> with the IP address of the server hosting AEM Forms. </p> 
    </note></li> 
   <li><p>Create a Document Security Client API object. </p> 
    <ul> 
     <li><p>Create a <span class="code">DocumentSecurityServiceClient</span> object by using its default constructor. </p></li> 
     <li><p>Create a <span class="code">DocumentSecurityServiceClient.Endpoint.Address</span> object by using the <span class="code">System.ServiceModel.EndpointAddress</span> constructor. Pass a string value that specifies the WSDL to the AEM Forms service (for example, <span class="code">http://localhost:8080/soap/services/RightsManagementService?WSDL</span>.) You do not need to use the <span class="code">lc_version</span> attribute. This attribute is used when you create a service reference.) </p></li> 
     <li><p>Create a <span class="code">System.ServiceModel.BasicHttpBinding</span> object by getting the value of the <span class="code">DocumentSecurityServiceClient.Endpoint.Binding</span> field. Cast the return value to <span class="code">BasicHttpBinding</span>. </p></li> 
     <li><p>Set the <span class="code">System.ServiceModel.BasicHttpBinding</span> object’s <span class="code">MessageEncoding</span> field to <span class="code">WSMessageEncoding.Mtom</span>. This value ensures that MTOM is used. </p></li> 
     <li><p>Enable basic HTTP authentication by performing the following tasks:</p> 
      <ul> 
       <li><p>Assign the AEM forms user name to the field <span class="code">DocumentSecurityServiceClient.ClientCredentials.UserName.UserName</span>.</p></li> 
       <li><p>Assign the corresponding password value to the field <span class="code">DocumentSecurityServiceClient.ClientCredentials.UserName.Password</span>.</p></li> 
       <li><p>Assign the constant value <span class="code">HttpClientCredentialType.Basic</span> to the field <span class="code">BasicHttpBindingSecurity.Transport.ClientCredentialType</span>. </p></li> 
      </ul></li> 
     <li><p>Assign the constant value <span class="code">BasicHttpSecurityMode.TransportCredentialOnly</span> to the field <span class="code">BasicHttpBindingSecurity.Security.Mode</span>. </p></li> 
    </ul></li> 
   <li><p>Retrieve the license identifier of the revoked PDF document. </p> 
    <ul> 
     <li><p>Create a <span class="code">BLOB</span> object by using its constructor. The <span class="code">BLOB</span> object is used to store a revoked PDF document to which access is reinstated.</p></li> 
     <li><p>Create a <span class="code">System.IO.FileStream</span> object by invoking its constructor and passing a string value that represents the file location of the revoked PDF document and the mode in which to open the file.</p></li> 
     <li><p>Create a byte array that stores the content of the <span class="code">System.IO.FileStream</span> object. You can determine the size of the byte array by getting the <span class="code">System.IO.FileStream</span> object’s <span class="code">Length</span> property. </p></li> 
     <li><p>Populate the byte array with stream data by invoking the <span class="code">System.IO.FileStream</span> object’s <span class="code">Read</span> method and passing the byte array, the starting position, and the stream length to read.</p></li> 
     <li><p>Populate the <span class="code">BLOB</span> object by assigning its <span class="code">MTOM</span> field with the contents of the byte array.</p></li> 
    </ul></li> 
   <li><p>Reinstate access to the revoked PDF document. </p> 
    <ul> 
     <li><p>Retrieve the license identifier value of the revoked document by invoking the <span class="code">DocumentSecurityServiceClient</span> object’s <span class="code">getLicenseID</span> method and passing the <span class="code">BLOB</span> object that represents the revoked document. This method returns a string value that represents the license identifier.</p></li> 
     <li><p>Reinstate access to the revoked PDF document by invoking the <span class="code">DocumentSecurityServiceClient</span> object’s <span class="code">unrevokeLicense</span> method and passing a string value that specifies the license identifier value of the revoked PDF document (pass the return value of the <span class="code">DocumentSecurityServiceClient</span> object’s <span class="code">getLicenseId</span> method). </p></li> 
    </ul></li> 
  </ol> 
  <p><strong>Code examples</strong></p> 
  <p>For code examples using the Document Security service, see the following Quick Starts in <i><a href="/programming-with-aem-forms/#java_api_soap_quick_start_code_examples">API Quick Starts (Code Examples)</a></i>:</p> 
  <ul> 
   <li><p>“Quick Start (MTOM): Reinstating access to a revoked document using the web service API”</p></li> 
   <li><p>“Quick Start (SwaRef): Reinstating access to a revoked document using the web service API”</p></li> 
  </ul> 
  <p><strong>See also</strong></p> 
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-web#invoking_aem_forms_using_mtom">Invoking AEM Forms using MTOM</a></p> 
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-web#invoking_aem_forms_using_swaref">Invoking AEM Forms using SwaRef</a></p> 
  <draft-comment type="remark">
    Content Referenced from lc_po_inspect_policy_protected_documents_ip.xml#WS624e3cba99b79e12e69a9941333732bac8-7ff0.2_ver6.1 
  </draft-comment> 
  <h2 id="inspecting_policy_protected_pdf_documents">Inspecting Policy Protected PDF Documents</h2> 
  <p></p> 
  <p>You can use the Document Security Service API (Java and web service) to inspect policy-protected PDF documents. Inspecting policy-protected PDF documents returns information about the policy-protected PDF document. You can, for example, determine the policy that was used to secure the document and the date when the document was secured. </p> 
  <p>You cannot perform this task if your version of LiveCycle is 8.x or an earlier version. Support for inspecting policy-protected documents is added in AEM Forms. If you attempt to inspect a policy-protected document using LiveCycle 8.x (or earlier), an exception is thrown. </p> 
  <note> 
   <p>For more information about the Document Security service, see <a href="http://www.adobe.com/go/learn_aemforms_services_63">Services Reference for AEM Forms</a>.</p> 
  </note> 
  <h3 id="summary_of_steps">Summary of steps</h3> 
  <p></p> 
  <p>To inspect a policy-protected PDF document, perform the following steps:</p> 
  <ol> 
   <li><p>Include project files.</p></li> 
   <li><p>Create a Document Security Client API object. </p></li> 
   <li><p>Retrieve a policy-protected document to inspect. </p></li> 
   <li><p>Obtain information about the policy-protected document. </p></li> 
  </ol> 
  <p><strong>Include project files</strong></p> 
  <p>Include necessary files into your development project. If you are creating a client application using Java, include the necessary JAR files. If you are using web services, make sure that you include the proxy files.</p> 
  <p><strong>Create a Document Security Client API object</strong></p> 
  <p>Before you can programmatically perform a Document Security service operation, create a Document Security service client object. If you are using the Java API, create a <span class="code">RightsManagementClient</span> object. If you are using the Document Security web service API, create a <span class="code">RightsManagementServiceService</span> object.</p> 
  <p><strong>Retrieve a policy-protected document to inspect</strong></p> 
  <p>To inspect a policy-protected document, retrieve it. If you attempt to inspect a document that is not secured with a policy or is revoked, an exception is thrown. </p> 
  <p><strong>Inspect the document</strong></p> 
  <p>After you retrieve a polciy-protected document, you can inspect it. </p> 
  <p><strong>Obtain information about the policy-protected document</strong></p> 
  <p>After you inspect a policy-protected PDF document, you can obtain information about it. For example, you can determine the policy that is used to secure the document. </p> 
  <p>If you secure a document with a policy that belongs to My Policies and then call <span class="code">RMInspectResult.getPolicysetName</span> or <span class="code">RMInspectResult.getPolicysetId</span>, null is returned. </p> 
  <p>If the document is secured using a policy that is contained in a policy set (other than My Policies) then <span class="code">RMInspectResult.getPolicysetName</span> and <span class="code">RMInspectResult.getPolicysetId</span> return valid strings.</p> 
  <p><strong>See also</strong></p> 
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-java#including_aem_forms_java_library_files">Including AEM Forms Java library files</a></p> 
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-java#setting_connection_properties">Setting connection properties</a></p> 
  <h3 id="inspect_policy_protected_pdf_documents_using_the_java_api">Inspect Policy Protected PDF Documents using the Java API</h3> 
  <p></p> 
  <p>Inspect a policy-protected PDF document by using the Document Security Service API (Java): </p> 
  <ol> 
   <li><p>Include project files. </p><p>Include client JAR files, such as the adobe-rightsmanagement-client.jar, in your Java project’s class path. For information about the location of these files, see <a href="/programming-with-aem-forms/invoking-aem-forms-using-java#including_aem_forms_java_library_files">Including AEM Forms Java library files</a>.</p></li> 
   <li><p>Create a Document Security Client API object. </p> 
    <ul> 
     <li><p>Create a <span class="code">ServiceClientFactory</span> object that contains connection properties. (See <a href="/programming-with-aem-forms/invoking-aem-forms-using-java#setting_connection_properties">Setting connection properties</a>.)</p></li> 
     <li><p>Create a <span class="code">RightsManagementClient</span> object by using its constructor and passing the <span class="code">ServiceClientFactory</span> object.</p></li> 
    </ul></li> 
   <li><p>Retrieve a policy-protected document to inspect. </p> 
    <ul> 
     <li><p>Create a <span class="code">java.io.FileInputStream</span> object that represents the policy-protected PDF document by using its constructor. Pass a string value that specifies the location of the PDF document.</p></li> 
     <li><p>Create a <span class="code">com.adobe.idp.Document</span> object by using its constructor and passing the <span class="code">java.io.FileInputStream</span> object.</p></li> 
    </ul></li> 
   <li><p>Inspect the document. </p> 
    <ul> 
     <li><p>Create a <span class="code">DocumentManager</span> object by invoking the <span class="code">RightsManagementClient</span> object’s <span class="code">getDocumentManager</span> method.</p></li> 
     <li><p>Inspect the policy-protected document by invoking the <span class="code">LicenseManager</span> object’s <span class="code">inspectDocument</span> method. Pass the <span class="code">com.adobe.idp.Document</span> object that contains the policy-protected PDF document. This method returns a <span class="code">RMInspectResult</span> object that contains information about the policy-protected document. </p></li> 
    </ul></li> 
   <li><p>Obtain information about the policy-protected document. </p><p>To obtain information about the policy-protected document, invoke the appropriate method that belongs <span class="code">RMInspectResult</span> object. For example, to retrieve the policy name, invoke the <span class="code">RMInspectResult</span> object’s <span class="code">getPolicyName</span> method. </p></li> 
  </ol> 
  <p><strong>Code examples</strong></p> 
  <p>For code examples using the Document Security service, see the following Quick Starts in <i><a href="/programming-with-aem-forms/#java_api_soap_quick_start_code_examples">API Quick Starts (Code Examples)</a></i>:</p> 
  <ul> 
   <li><p>“Quick Start (SOAP mode): Inspecting policy protected PDF documents using the Java API”</p></li> 
  </ul> 
  <h3 id="inspect_policy_protected_pdf_documents_using_the_web_service_api">Inspect Policy Protected PDF Documents using the web service API</h3> 
  <p></p> 
  <p>Inspect a policy-protected PDF document by using the Document Security Service API (web service):</p> 
  <ol> 
   <li><p>Include project files. </p><p>Create a Microsoft .NET project that uses MTOM. Ensure that you use the following WSDL definition: <span class="code">http://localhost:8080/soap/services/RightsManagementService?WSDL&amp;lc_version=9.0.1</span>. </p> 
    <note> 
     <p>Replace <span class="code">localhost</span> with the IP address of the server hosting AEM Forms. </p> 
    </note></li> 
   <li><p>Create a Document Security Client API object. </p> 
    <ul> 
     <li><p>Create a <span class="code">RightsManagementServiceClient</span> object by using its default constructor. </p></li> 
     <li><p>Create a <span class="code">RightsManagementServiceClient.Endpoint.Address</span> object by using the <span class="code">System.ServiceModel.EndpointAddress</span> constructor. Pass a string value that specifies the WSDL to the AEM Forms service (for example, <span class="code">http://localhost:8080/soap/services/RightsManagementService?WSDL</span>.) You do not need to use the <span class="code">lc_version</span> attribute. This attribute is used when you create a service reference.) </p></li> 
     <li><p>Create a <span class="code">System.ServiceModel.BasicHttpBinding</span> object by getting the value of the <span class="code">RightsManagementServiceClient.Endpoint.Binding</span> field. Cast the return value to <span class="code">BasicHttpBinding</span>. </p></li> 
     <li><p>Set the <span class="code">System.ServiceModel.BasicHttpBinding</span> object’s <span class="code">MessageEncoding</span> field to <span class="code">WSMessageEncoding.Mtom</span>. This value ensures that MTOM is used. </p></li> 
     <li><p>Enable basic HTTP authentication by performing the following tasks:</p> 
      <ul> 
       <li><p>Assign the AEM forms user name to the field <span class="code">RightsManagementServiceClient.ClientCredentials.UserName.UserName</span>.</p></li> 
       <li><p>Assign the corresponding password value to the field <span class="code">RightsManagementServiceClient.ClientCredentials.UserName.Password</span>.</p></li> 
       <li><p>Assign the constant value <span class="code">HttpClientCredentialType.Basic</span> to the field <span class="code">BasicHttpBindingSecurity.Transport.ClientCredentialType</span>. </p></li> 
      </ul></li> 
     <li><p>Assign the constant value <span class="code">BasicHttpSecurityMode.TransportCredentialOnly</span> to the field <span class="code">BasicHttpBindingSecurity.Security.Mode</span>. </p></li> 
    </ul></li> 
   <li><p>Retrieve a policy-protected document to inspect. </p> 
    <ul> 
     <li><p>Create a <span class="code">BLOB</span> object by using its constructor. The <span class="code">BLOB</span> object is used to store a PDF document to inspect.</p></li> 
     <li><p>Create a <span class="code">System.IO.FileStream</span> object by invoking its constructor. Pass a string value that represents the file location of the PDF document and the mode to open the file in.</p></li> 
     <li><p>Create a byte array that stores the content of the <span class="code">System.IO.FileStream</span> object. You can determine the size of the byte array by getting the <span class="code">System.IO.FileStream</span> object’s <span class="code">Length</span> property.</p></li> 
     <li><p>Populate the byte array with stream data by invoking the <span class="code">System.IO.FileStream</span> object’s <span class="code">Read</span> method. Pass the byte array, starting position, and stream length to read.</p></li> 
     <li><p>Populate the <span class="code">BLOB</span> object by assigning its <span class="code">MTOM</span> field with the contents of the byte array.</p></li> 
    </ul></li> 
   <li><p>Inspect the document. </p><p>Inspect the policy-protected document by invoking the <span class="code">RightsManagementServiceClient</span> object’s <span class="code">inspectDocument</span> method. Pass the <span class="code">BLOB</span> object that contains the policy-protected PDF document. This method returns a <span class="code">RMInspectResult</span> object that contains information about the policy-protected document. </p></li> 
   <li><p>Obtain information about the policy-protected document. </p><p>To obtain information about the policy-protected document, get the value of the appropriate field that belongs to the <span class="code">RMInspectResult</span> object. For example, to retrieve the policy name, get the value of the <span class="code">RMInspectResult</span> object’s <span class="code">policyName</span> field.</p></li> 
  </ol> 
  <p><strong>Code examples</strong></p> 
  <p>For code examples using the Document Security service, see the following Quick Starts in <i><a href="/programming-with-aem-forms/#java_api_soap_quick_start_code_examples">API Quick Starts (Code Examples)</a></i>:</p> 
  <ul> 
   <li><p>“Quick Start (MTOM): Inspecting policy protected PDF documents using the web service API”</p></li> 
   <li><p>“Quick Start (SwaRef): Inspecting policy protected PDF documents using the web service API”</p></li> 
  </ul> 
  <p><strong>See also</strong></p> 
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-web#invoking_aem_forms_using_mtom">Invoking AEM Forms using MTOM</a></p> 
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-web#invoking_aem_forms_using_swaref">Invoking AEM Forms using SwaRef</a></p> 
  <draft-comment type="remark">
    Content Referenced from lc_po_create_watermarks_cw.xml#WS624e3cba99b79e12e69a9941333732bac8-7cb8.2_ver6.1 
  </draft-comment> 
  <h2 id="creating_watermarks">Creating Watermarks</h2> 
  <p></p> 
  <p>Watermarks help ensure the security of a document by uniquely identifying the document and controlling copyright infringement. For example, you can create and place a watermark that states Confidential on all pages of a document. After a watermark is created, you can include it as part of a policy. That is, you can set the policy’s watermark attribute with the newly created watermark. After a policy that contains a watermark is applied to a document, the watermark appears in the policy-protected document.</p> 
  <note> 
   <p>Only users with Document Security administrative privileges can create watermarks. That is, you must specify such a user when defining connection settings required to create a Document Security service client object. </p> 
  </note> 
  <note> 
   <p>For more information about the Document Security service, see <a href="http://www.adobe.com/go/learn_aemforms_services_63">Services Reference for AEM Forms</a>.</p> 
  </note> 
  <h3 id="summary_of_steps">Summary of steps</h3> 
  <p></p> 
  <p>To create a watermark, perform the following steps:</p> 
  <ol> 
   <li><p>Include project files.</p></li> 
   <li><p>Create a Document Security Client API object.</p></li> 
   <li><p>Set the watermarks attributes. </p></li> 
   <li><p>Register the watermark with the Document Security service. </p></li> 
  </ol> 
  <p><strong>Include project files</strong></p> 
  <p>Include necessary files into your development project. If you are creating a client application using Java, then include the necessary JAR files. If you are using web services, then make sure that you include the proxy files.</p> 
  <p><strong>Create a Document Security Client API object</strong></p> 
  <p>Before you can programmatically perform a Document Security service operation, you must create a Document Security service client object. If you are using the Java API, create a <span class="code">RightsManagementClient</span> object. If you are using the Document Security web service API, create a <span class="code">RightsManagementServiceService</span> object.</p> 
  <p><strong>Set the watermarks attributes</strong></p> 
  <p>To create a new watermark, you must set watermark attributes. The name attribute must always be defined. In addition to the name attribute, you must set at least one of the following attributes:</p> 
  <ul> 
   <li><p>Custom Text</p></li> 
   <li><p>DateIncluded </p></li> 
   <li><p>UserIdIncluded</p></li> 
   <li><p>UserNameIncluded</p></li> 
  </ul> 
  <p>The following table lists key and value pairs that are required when creating a watermark using web services. </p> 
  <table cellpadding="4" cellspacing="0"> 
   <thead align="left"> 
    <tr> 
     <th class="cellrowborder" id="d19e49370" valign="top" width="NaN%"><p>Key Name</p></th> 
     <th class="cellrowborder" id="d19e49373" valign="top" width="NaN%"><p>Description</p></th> 
     <th class="cellrowborder" id="d19e49376" valign="top" width="NaN%"><p>Value</p></th> 
    </tr> 
   </thead> 
   <tbody> 
    <tr> 
     <td class="cellrowborder" headers="d19e49370 " valign="top" width="NaN%"><p><span class="code">WaterBackCmd:IS_USERNAME_ENABLED</span></p></td> 
     <td class="cellrowborder" headers="d19e49373 " valign="top" width="NaN%"><p>Specifies if the user name of the user opening the document is part of the watermark.</p></td> 
     <td class="cellrowborder" headers="d19e49376 " valign="top" width="NaN%"><p>True or False</p></td> 
    </tr> 
    <tr> 
     <td class="cellrowborder" headers="d19e49370 " valign="top" width="NaN%"><p><span class="code">WaterBackCmd:IS_USERID_ENABLED</span></p></td> 
     <td class="cellrowborder" headers="d19e49373 " valign="top" width="NaN%"><p>Specifies if the identification of the user opening the document is part of the watermark.</p></td> 
     <td class="cellrowborder" headers="d19e49376 " valign="top" width="NaN%"><p>True or False</p></td> 
    </tr> 
    <tr> 
     <td class="cellrowborder" headers="d19e49370 " valign="top" width="NaN%"><p><span class="code">WaterBackCmd:IS_CURRENTDATE_ENABLED</span></p></td> 
     <td class="cellrowborder" headers="d19e49373 " valign="top" width="NaN%"><p>Specifies if the current date is part of the watermark.</p></td> 
     <td class="cellrowborder" headers="d19e49376 " valign="top" width="NaN%"><p>True or False</p></td> 
    </tr> 
    <tr> 
     <td class="cellrowborder" headers="d19e49370 " valign="top" width="NaN%"><p><span class="code">WaterBackCmd:IS_CUSTOMTEXT_ENABLED</span></p></td> 
     <td class="cellrowborder" headers="d19e49373 " valign="top" width="NaN%"><p>If this value is true, then the value of the custom text must be specified using <span class="code">WaterBackCmd:SRCTEXT</span>.</p></td> 
     <td class="cellrowborder" headers="d19e49376 " valign="top" width="NaN%"><p>True or False</p></td> 
    </tr> 
    <tr> 
     <td class="cellrowborder" headers="d19e49370 " valign="top" width="NaN%"><p><span class="code">WaterBackCmd:OPACITY</span></p></td> 
     <td class="cellrowborder" headers="d19e49373 " valign="top" width="NaN%"><p>Specifies the opacity of the watermark. The default value is 0.5 if it is not specified.</p></td> 
     <td class="cellrowborder" headers="d19e49376 " valign="top" width="NaN%"><p>A value between 0.0 and 1.0.</p></td> 
    </tr> 
    <tr> 
     <td class="cellrowborder" headers="d19e49370 " valign="top" width="NaN%"><p><span class="code">WaterBackCmd:ROTATION</span></p></td> 
     <td class="cellrowborder" headers="d19e49373 " valign="top" width="NaN%"><p>Specifies the rotation of the watermark. The default value is 0 degrees.</p></td> 
     <td class="cellrowborder" headers="d19e49376 " valign="top" width="NaN%"><p>A value between 0 and 359.</p></td> 
    </tr> 
    <tr> 
     <td class="cellrowborder" headers="d19e49370 " valign="top" width="NaN%"><p><span class="code">WaterBackCmd:SCALE</span></p></td> 
     <td class="cellrowborder" headers="d19e49373 " valign="top" width="NaN%"><p>If this value is specified, then <span class="code">WaterBackCmd:IS_SIZE_ENABLED</span> must be present and the value must be true. If this attribute is not specified, the default behavior is fit to page.</p></td> 
     <td class="cellrowborder" headers="d19e49376 " valign="top" width="NaN%"><p>A value greater than 0.0 and less than or equal to 1.0.</p></td> 
    </tr> 
    <tr> 
     <td class="cellrowborder" headers="d19e49370 " valign="top" width="NaN%"><p><span class="code">WaterBackCmd:HORIZ_ALIGN</span></p></td> 
     <td class="cellrowborder" headers="d19e49373 " valign="top" width="NaN%"><p>Specifies the watermark’s horizontal alignment. The default value is center.</p></td> 
     <td class="cellrowborder" headers="d19e49376 " valign="top" width="NaN%"><p>left, center, or right</p></td> 
    </tr> 
    <tr> 
     <td class="cellrowborder" headers="d19e49370 " valign="top" width="NaN%"><p><span class="code">WaterBackCmd:VERT_ALIGN</span></p></td> 
     <td class="cellrowborder" headers="d19e49373 " valign="top" width="NaN%"><p>Specifies the watermark’s vertical alignment. The default value is center.</p></td> 
     <td class="cellrowborder" headers="d19e49376 " valign="top" width="NaN%"><p>top, center, or bottom</p></td> 
    </tr> 
    <tr> 
     <td class="cellrowborder" headers="d19e49370 " valign="top" width="NaN%"><p><span class="code">WaterBackCmd:IS_USE_BACKGROUND</span></p></td> 
     <td class="cellrowborder" headers="d19e49373 " valign="top" width="NaN%"><p>Specifies if the watermark is a background. The default value is false.</p></td> 
     <td class="cellrowborder" headers="d19e49376 " valign="top" width="NaN%"><p>True or False</p></td> 
    </tr> 
    <tr> 
     <td class="cellrowborder" headers="d19e49370 " valign="top" width="NaN%"><p><span class="code">WaterBackCmd:IS_SIZE_ENABLED</span></p></td> 
     <td class="cellrowborder" headers="d19e49373 " valign="top" width="NaN%"><p>True if a custom scale is specified. If this value is true, SCALE must also be specified. If this value is false, then the default is fit to page.</p></td> 
     <td class="cellrowborder" headers="d19e49376 " valign="top" width="NaN%"><p>True or False</p></td> 
    </tr> 
    <tr> 
     <td class="cellrowborder" headers="d19e49370 " valign="top" width="NaN%"><p><span class="code">WaterBackCmd:SRCTEXT</span></p></td> 
     <td class="cellrowborder" headers="d19e49373 " valign="top" width="NaN%"><p>Specifies the custom text for a watermark. If this value is present, then <span class="code">WaterBackCmd:IS_CUSTOMTEXT_ENABLED</span> must also be present and set to true.</p></td> 
     <td class="cellrowborder" headers="d19e49376 " valign="top" width="NaN%"><p>True or False</p></td> 
    </tr> 
   </tbody> 
  </table> 
  <p>All watermarks must have one of the following attributes defined:</p> 
  <ul> 
   <li></li> 
   <li></li> 
   <li></li> 
   <li></li> 
  </ul> 
  <p>All other attributes are optional.</p> 
  <p><strong>Register the watermark</strong></p> 
  <p>A new watermark must be registered with the Document Security service before it can be used. After you register a watermark, you can use it within policies.</p> 
  <p><strong>See also</strong></p> 
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-java#including_aem_forms_java_library_files">Including AEM Forms Java library files</a></p> 
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-java#setting_connection_properties">Setting connection properties</a></p> 
  <p><a href="protecting-documents-policies#applying_policies_to_pdf_documents">Applying Policies to PDF Documents</a></p> 
  <h3 id="create_watermarks_using_the_java_api">Create watermarks using the Java API</h3> 
  <p></p> 
  <p>Create a watermark by using the Document Security API (Java):</p> 
  <ol> 
   <li><p>Include project files. </p><p>Include client JAR files, such as the adobe-rightsmanagement-client.jar, in your Java project’s class path. </p></li> 
   <li><p>Create a Document Security Client API object. </p> 
    <ul> 
     <li><p>Create a <span class="code">ServiceClientFactory</span> object that contains connection properties. </p></li> 
     <li><p>Create a <span class="code">RightsManagementClient</span> object by using its constructor and passing the <span class="code">ServiceClientFactory</span> object.</p></li> 
    </ul></li> 
   <li><p>Set the watermark attributes </p> 
    <ul> 
     <li><p>Create a <span class="code">Watermark</span> object by invoking the <span class="code">InfomodelObjectFactory</span> object’s static <span class="code">createWatermark</span> method. This method returns a <span class="code">Watermark</span> object.</p></li> 
     <li><p>Set the watermark’s name attribute by invoking the <span class="code">Watermark</span> object’s <span class="code">setName</span> method and passing a string value that specifies the policy name. </p></li> 
     <li><p>Set the watermark’s background attribute by invoking the <span class="code">Watermark</span> object’s <span class="code">setBackground</span> method and passing <span class="code">true</span>. By setting this attribute, the watermark appears in the background of the document.</p></li> 
     <li><p>Set the watermark’s custom text attribute by invoking the <span class="code">Watermark</span> object’s <span class="code">setCustomText</span> method and passing a string value that represents the watermark’s text.</p></li> 
     <li><p>Set the watermark’s opacity attribute by invoking the <span class="code">Watermark</span> object’s <span class="code">setOpacity</span> method and passing an integer value that specifies the opacity level. A value of 100 indicates the watermark is completely opaque and a value of 0 indicates the watermark is completely transparent.</p></li> 
    </ul></li> 
   <li><p>Register the watermark. </p> 
    <ul> 
     <li><p>Create a <span class="code">WatermarkManager</span> object by invoking the <span class="code">RightsManagementClient</span> object’s <span class="code">getWatermarkManager</span> method. This method returns a <span class="code">WatermarkManager</span> object.</p></li> 
     <li><p>Register the watermark by invoking the <span class="code">WatermarkManager</span> object’s <span class="code">registerWatermark</span> method and passing the <span class="code">Watermark</span> object that represents the watermark to register. This method returns a string value that represents the watermark’s identification value. </p></li> 
    </ul></li> 
  </ol> 
  <p><strong>Code examples</strong></p> 
  <p>For code examples using the Document Security service, see the following Quick Starts in <i><a href="/programming-with-aem-forms/#java_api_soap_quick_start_code_examples">API Quick Starts (Code Examples)</a></i>:</p> 
  <ul> 
   <li><p>“Quick Start (SOAP mode): Creating a watermark using the Java API”</p></li> 
  </ul> 
  <h3 id="create_watermarks_using_the_web_service_api">Create watermarks using the web service API</h3> 
  <p></p> 
  <p>Create a watermark by using the Document Security API (web service):</p> 
  <ol> 
   <li><p>Create a Document Security Client API object. </p><p>Create a Microsoft .NET project that uses MTOM. Ensure that you use the following WSDL definition: <span class="code">http://localhost:8080/soap/services/RightsManagementService?WSDL&amp;lc_version=9.0.1</span>. </p> 
    <note> 
     <p>Replace <span class="code">localhost</span> with the IP address of the server hosting AEM Forms. </p> 
    </note></li> 
   <li><p>Create a Document Security Client API object. </p> 
    <ul> 
     <li><p>Create a <span class="code">RightsManagementServiceClient</span> object by using its default constructor. </p></li> 
     <li><p>Create a <span class="code">RightsManagementServiceClient.Endpoint.Address</span> object by using the <span class="code">System.ServiceModel.EndpointAddress</span> constructor. Pass a string value that specifies the WSDL to the AEM Forms service (for example, <span class="code">http://localhost:8080/soap/services/RightsManagementService?WSDL</span>.) You do not need to use the <span class="code">lc_version</span> attribute. This attribute is used when you create a service reference.) </p></li> 
     <li><p>Create a <span class="code">System.ServiceModel.BasicHttpBinding</span> object by getting the value of the <span class="code">RightsManagementServiceClient.Endpoint.Binding</span> field. Cast the return value to <span class="code">BasicHttpBinding</span>. </p></li> 
     <li><p>Set the <span class="code">System.ServiceModel.BasicHttpBinding</span> object’s <span class="code">MessageEncoding</span> field to <span class="code">WSMessageEncoding.Mtom</span>. This value ensures that MTOM is used. </p></li> 
     <li><p>Enable basic HTTP authentication by performing the following tasks:</p> 
      <ul> 
       <li><p>Assign the AEM forms user name to the field <span class="code">RightsManagementServiceClient.ClientCredentials.UserName.UserName</span>.</p></li> 
       <li><p>Assign the corresponding password value to the field <span class="code">RightsManagementServiceClient.ClientCredentials.UserName.Password</span>.</p></li> 
       <li><p>Assign the constant value <span class="code">HttpClientCredentialType.Basic</span> to the field <span class="code">BasicHttpBindingSecurity.Transport.ClientCredentialType</span>. </p></li> 
      </ul></li> 
     <li><p>Assign the constant value <span class="code">BasicHttpSecurityMode.TransportCredentialOnly</span> to the field <span class="code">BasicHttpBindingSecurity.Security.Mode</span>. </p></li> 
    </ul></li> 
   <li><p>Set the watermark attributes. </p> 
    <ul> 
     <li><p>Create a <span class="code">WatermarkSpec</span> object by invoking the <span class="code">WatermarkSpec</span> constructor.</p></li> 
     <li><p>Set the watermark’s name by assigning a string value to the <span class="code">WatermarkSpec</span> object’s <span class="code">name</span> data member.</p></li> 
     <li><p>Set the watermark’s <span class="code">id</span> attribute by assigning a string value to the <span class="code">WatermarkSpec</span> object’s <span class="code">id</span> data member.</p></li> 
     <li><p>For each watermark property to set, create a separate <span class="code">MyMapOf_xsd_string_To_xsd_anyType_Item</span> object. </p></li> 
     <li><p>Set the key value by assigning a value to the <span class="code">MyMapOf_xsd_string_To_xsd_anyType_Item</span> object’s <span class="code">key</span> data member (for example, <span class="code">WaterBackCmd:OPACITY)</span>. </p></li> 
     <li><p>Set the value by assigning a value to the <span class="code">MyMapOf_xsd_string_To_xsd_anyType_Item</span> object’s <span class="code">value</span> data member (for example, <span class="code">.25</span>). </p></li> 
     <li><p>Create a <span class="code">MyArrayOf_xsd_anyType</span> object. For each <span class="code">MyMapOf_xsd_string_To_xsd_anyType_Item</span> object, invoke the <span class="code">MyArrayOf_xsd_anyType</span> object’s <span class="code">Add</span> method. Pass the <span class="code">MyMapOf_xsd_string_To_xsd_anyType_Item</span> object. </p></li> 
     <li><p>Assign the <span class="code">MyArrayOf_xsd_anyType</span> object to the <span class="code">WatermarkSpec</span> object’s <span class="code">values</span> data member.</p></li> 
    </ul></li> 
   <li><p>Register the watermark. </p><p>Register the watermark by invoking the <span class="code">RightsManagementServiceClient</span> object’s <span class="code">registerWatermark</span> method and passing the <span class="code">WatermarkSpec</span> object that represents the watermark to register.</p></li> 
  </ol> 
  <p><strong>Code examples</strong></p> 
  <p>For code examples using the Document Security service, see the following Quick Starts in <i><a href="/programming-with-aem-forms/#java_api_soap_quick_start_code_examples">API Quick Starts (Code Examples)</a></i>:</p> 
  <ul> 
   <li><p>“Quick Start (MTOM): Creating a watermark using the web service API”</p></li> 
   <li><p>“Quick Start (SwaRef): Creating a watermark using the web service API”</p></li> 
  </ul> 
  <p><strong>See also</strong></p> 
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-web#invoking_aem_forms_using_mtom">Invoking AEM Forms using MTOM</a></p> 
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-web#invoking_aem_forms_using_swaref">Invoking AEM Forms using SwaRef</a></p> 
  <draft-comment type="remark">
    Content Referenced from lc_po_modify_watermarks_mw.xml#WS624e3cba99b79e12e69a9941333732bac8-7cb7.2_ver6.1 
  </draft-comment> 
  <h2 id="modifying_watermarks">Modifying Watermarks</h2> 
  <p></p> 
  <p>You can modify an existing watermark using the Document Security Java API or web service API. To make changes to an existing watermark, you retrieve it, modify its attributes, and then update it on the server. For example, assume that you retrieve an watermark and modify its opacity attribute. Before the change takes effect, you must update the watermark.</p> 
  <p>When you modify a watermark, the change impacts future documents that have the watermark applied to them. That is, existing PDF documents that contain the watermark are not affected. </p> 
  <note> 
   <p>Only users with Document Security administrative privileges can modify watermarks. That is, you must specify such a user when defining connection settings required to create a Document Security service client object. </p> 
  </note> 
  <note> 
   <p>For more information about the Document Security service, see <a href="http://www.adobe.com/go/learn_aemforms_services_63">Services Reference for AEM Forms</a>.</p> 
  </note> 
  <h3 id="summary_of_steps">Summary of steps</h3> 
  <p></p> 
  <p>To modify a watermark, perform the following steps:</p> 
  <ol> 
   <li><p>Include project files.</p></li> 
   <li><p>Create a Document Security Client API object.</p></li> 
   <li><p>Retrieve the watermark to modify. </p></li> 
   <li><p>Set the watermarks attributes. </p></li> 
   <li><p>Update the watermark.</p></li> 
  </ol> 
  <p><strong>Include project files</strong></p> 
  <p>Include necessary files into your development project. If you are creating a client application using Java, then include the necessary JAR files. If you are using web services, then make sure that you include the proxy files.</p> 
  <p><strong>Create a Document Security Client API object</strong></p> 
  <p>Before you can programmatically perform a Document Security service operation, you must create a Document Security service client object. If you are using the Java API, create a <span class="code">DocumentSecurityClient</span> object. If you are using the Document Security web service API, create a <span class="code">DocumentSecurityServiceService</span> object.</p> 
  <p><strong>Retrieve the watermark to modify</strong></p> 
  <p>To modify a watermark, you must retrieve an existing watermark. You can retrieve a watermark by specifying its name or by specifying its identifier value.</p> 
  <p><strong>Set the watermarks attributes</strong></p> 
  <p>To modify an existing watermark, change the value of one or more watermark attributes. When programmatically updating a watermark using a web service, you must set all of the attributes that were originally set, even if the value does not change. For example, assume the following watermark attributes are set: <span class="code">WaterBackCmd:IS_USERID_ENABLED</span>, <span class="code">WaterBackCmd:IS_CUSTOMTEXT_ENABLED</span>, <span class="code">WaterBackCmd:OPACITY</span>, and <span class="code">WaterBackCmd:SRCTEXT</span>. Although the only attribute that you want to modify is <span class="code">WaterBackCmd:OPACITY</span>, you must set the other values are well.</p> 
  <note> 
   <p>When using the Java API to modify a watermark, you do not need to specify all attributes. Set the watermark attribute that you want to modify.</p> 
  </note> 
  <note> 
   <p>For information about the watermark attribute names, see <a href="protecting-documents-policies#creating_watermarks">Creating Watermarks</a>.</p> 
  </note> 
  <p><strong>Update the watermark</strong></p> 
  <p>After you modify a watermark’s attributes, you must update the watermark. </p> 
  <p><strong>See also</strong></p> 
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-java#including_aem_forms_java_library_files">Including AEM Forms Java library files</a></p> 
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-java#setting_connection_properties">Setting connection properties</a></p> 
  <p><a href="protecting-documents-policies#creating_watermarks">Creating Watermarks</a></p> 
  <h3 id="modify_watermarks_using_the_java_api">Modify watermarks using the Java API</h3> 
  <p></p> 
  <p>Modify a watermark by using the Document Security API (Java):</p> 
  <ol> 
   <li><p>Include project files. </p><p>Include client JAR files, such as the adobe-rightsmanagement-client.jar, in your Java project’s class path.</p></li> 
   <li><p>Create a Document Security Client API object. </p> 
    <ul> 
     <li><p>Create a <span class="code">ServiceClientFactory</span> object that contains connection properties. </p></li> 
     <li><p>Create a <span class="code">DocumentSecurityClient</span> object by using its constructor and passing the <span class="code">ServiceClientFactory</span> object.</p></li> 
    </ul></li> 
   <li><p>Retrieve the watermark to modify. </p><p>Create a <span class="code">WatermarkManager</span> object by invoking the <span class="code">DocumentSecurityClient</span> object’s <span class="code">getWatermarkManager</span> method and pass a string value that specifies the watermark name. This method returns a <span class="code">Watermark</span> object that represents the watermark to modify. </p></li> 
   <li><p>Set the watermark attributes. </p><p>Set the watermark’s opacity attribute by invoking the <span class="code">Watermark</span> object’s <span class="code">setOpacity</span> method and passing an integer value that specifies the opacity level. A value of 100 indicates the watermark is completely opaque and a value of 0 indicates the watermark is completely transparent.</p> 
    <note> 
     <p>This example modifies only the opacity attribute.</p> 
    </note></li> 
   <li><p>Update the watermark. </p> 
    <ul> 
     <li><p>Update the watermark by invoking the <span class="code">WatermarkManager</span> object’s <span class="code">updateWatermark</span> method and pass the <span class="code">Watermark</span> object whose attribute was modified. </p></li> 
    </ul></li> 
  </ol> 
  <p><strong>Code examples</strong></p> 
  <p>For code examples using the Document Security service, see the Quick Start(SOAP mode): Modifying a watermark using the Java API in <i><a href="/programming-with-aem-forms/#java_api_soap_quick_start_code_examples">API Quick Starts (Code Examples)</a></i></p> 
  <h3 id="modify_watermarks_using_the_web_service_api">Modify watermarks using the web service API</h3> 
  <p></p> 
  <p>Modify a watermark by using the Document Security API (web service):</p> 
  <ol> 
   <li><p>Include project files. </p><p>Create a Microsoft .NET project that uses MTOM. Ensure that you use the following WSDL definition: <span class="code">http://localhost:8080/soap/services/RightsManagementService?WSDL&amp;lc_version=9.0.1</span>. </p> 
    <note> 
     <p>Replace <span class="code">localhost</span> with the IP address of the server hosting AEM Forms.</p> 
    </note></li> 
   <li><p>Create a Document Security Client API object. </p> 
    <ul> 
     <li><p>Create a <span class="code">DocumentSecurityServiceClient</span> object by using its default constructor. </p></li> 
     <li><p>Create a <span class="code">RightsManagementServiceClient.Endpoint.Address</span> object by using the <span class="code">System.ServiceModel.EndpointAddress</span> constructor. Pass a string value that specifies the WSDL to the AEM Forms service (for example, <span class="code">http://localhost:8080/soap/services/DocumentSecurityService?WSDL</span>.) You do not need to use the <span class="code">lc_version</span> attribute. This attribute is used when you create a service reference.) </p></li> 
     <li><p>Create a <span class="code">System.ServiceModel.BasicHttpBinding</span> object by getting the value of the <span class="code">DocumentSecurityServiceClient.Endpoint.Binding</span> field. Cast the return value to <span class="code">BasicHttpBinding</span>. </p></li> 
     <li><p>Set the <span class="code">System.ServiceModel.BasicHttpBinding</span> object’s <span class="code">MessageEncoding</span> field to <span class="code">WSMessageEncoding.Mtom</span>. This value ensures that MTOM is used. </p></li> 
     <li><p>Enable basic HTTP authentication by performing the following tasks:</p> 
      <ul> 
       <li><p>Assign the AEM forms user name to the field <span class="code">DocumentSecurityServiceClient.ClientCredentials.UserName.UserName</span>.</p></li> 
       <li><p>Assign the corresponding password value to the field <span class="code">DocumentSecurityServiceClient.ClientCredentials.UserName.Password</span>.</p></li> 
       <li><p>Assign the constant value <span class="code">HttpClientCredentialType.Basic</span> to the field <span class="code">BasicHttpBindingSecurity.Transport.ClientCredentialType</span>. </p></li> 
      </ul></li> 
     <li><p>Assign the constant value <span class="code">BasicHttpSecurityMode.TransportCredentialOnly</span> to the field <span class="code">BasicHttpBindingSecurity.Security.Mode</span>. </p></li> 
    </ul></li> 
   <li><p>Retrieve the watermark to modify. </p><p>Retrieve the watermark to modify by invoking the <span class="code">DocumentSecurityServiceClient</span> object’s <span class="code">getWatermarkByName</span> method. Pass a string value that specifies the watermark name. This method returns a <span class="code">WatermarkSpec</span> object that represents the watermark to modify.</p></li> 
   <li><p>Set the watermark attributes. </p> 
    <ul> 
     <li><p>For each watermark property to update, create a separate <span class="code">MyMapOf_xsd_string_To_xsd_anyType_Item</span> object. </p></li> 
     <li><p>Set the key value by assigning a value to the <span class="code">MyMapOf_xsd_string_To_xsd_anyType_Item</span> object’s <span class="code">key</span> data member (for example, <span class="code">WaterBackCmd:OPACITY)</span>. </p></li> 
     <li><p>Set the value by assigning a value to the <span class="code">MyMapOf_xsd_string_To_xsd_anyType_Item</span> object’s <span class="code">value</span> data member (for example, <span class="code">.50</span>). </p></li> 
     <li><p>Create a <span class="code">MyArrayOf_xsd_anyType</span> object. For each <span class="code">MyMapOf_xsd_string_To_xsd_anyType_Item</span> object, invoke the <span class="code">MyArrayOf_xsd_anyType</span> object’s <span class="code">Add</span> method. Pass the <span class="code">MyMapOf_xsd_string_To_xsd_anyType_Item</span> object. </p></li> 
     <li><p>Assign the <span class="code">MyArrayOf_xsd_anyType</span> object to the <span class="code">WatermarkSpec</span> object’s <span class="code">values</span> data member.</p></li> 
    </ul></li> 
   <li><p>Update the watermark. </p><p>Update the watermark by invoking the <span class="code">DocumentSecurityServiceClient</span> object’s <span class="code">updateWatermark</span> method and passing the <span class="code">WatermarkSpec</span> object that represents the watermark to modify.</p></li> 
  </ol> 
  <p><strong>Code examples</strong></p> 
  <p>For code examples using the Document Security service, see the following Quick Start in <i><a href="/programming-with-aem-forms/#java_api_soap_quick_start_code_examples">API Quick Starts (Code Examples)</a></i>:</p> 
  <ul> 
   <li><p>“Quick Start (MTOM): Modifying a watermark using the web service API”</p></li> 
  </ul> 
  <draft-comment type="remark">
    Content Referenced from lc_po_search_events_se.xml#WS624e3cba99b79e12e69a9941333732bac8-7cb6.2_ver6.1 
  </draft-comment> 
  <h2 id="searching_for_events">Searching for Events</h2> 
  <p></p> 
  <p>The Rights Management service tracks specific actions as they occur, such as applying a policy to a document, opening a policy-protected document, and revoking access to documents. Event auditing must be enabled for the Rights Management service or events are not tracked.</p> 
  <p>Events fall into one of the following categories:</p> 
  <ul> 
   <li><p>Administrator events are actions related to an administrator, such as creating a new administrator account.</p></li> 
   <li><p>Document events are actions related to a document, such as closing a policy-protected document.</p></li> 
   <li><p>Policy events are actions related to a policy, such as creating a new policy.</p></li> 
   <li><p>Service events are actions related to the Rights Management service, such as synchronizing with the user directory.</p></li> 
  </ul> 
  <p>You can search for specify specific events by using the Rights Management Java API or web service API. By searching for events, you can perform tasks, such as creating a log file of certain events.</p> 
  <note> 
   <p>For more information about the Rights Management service, see <a href="http://www.adobe.com/go/learn_aemforms_services_63">Services Reference for AEM Forms</a>.</p> 
  </note> 
  <h3 id="summary_of_steps">Summary of steps</h3> 
  <p></p> 
  <p>To search for a Rights Management event, perform the following steps:</p> 
  <ol> 
   <li><p>Include project files.</p></li> 
   <li><p>Create a Rights Management Client API object.</p></li> 
   <li><p>Specify the event for which to search. </p></li> 
   <li><p>Search for the event.</p></li> 
  </ol> 
  <p><strong>Include project files</strong></p> 
  <p>Include necessary files into your development project. If you are creating a client application using Java, then include the necessary JAR files. If you are using web services, then make sure that you include the proxy files.</p> 
  <p><strong>Create a Rights Management Client API object</strong></p> 
  <p>Before you can programmatically perform a Rights Management service operation, you must create a Rights Management service client object. If you are using the Java API, create a <span class="code">DocumentSecurityClient</span> object. If you are using the Rights Management web service API, create a <span class="code">DocumentSecurityServiceService</span> object.</p> 
  <p><strong>Specify the events to search for</strong></p> 
  <p>You must specify the event to search for. For example, you can search for the policy create event, which occurs when a new policy is created. </p> 
  <p><strong>Search for the event</strong></p> 
  <p>After you specify the event to search for, you can use either the Rights Management Java API or the Rights Management web service API to search for the event.</p> 
  <p><strong>See also</strong></p> 
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-java#including_aem_forms_java_library_files">Including AEM Forms Java library files</a></p> 
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-java#setting_connection_properties">Setting connection properties</a></p> 
  <h3 id="search_for_events_using_the_java_api">Search for events using the Java API</h3> 
  <p></p> 
  <p>Search for events by using the Rights Management API (Java):</p> 
  <ol> 
   <li><p>Include project files </p><p>Include client JAR files, such as adobe-rightsmanagement-client.jar, in your Java project’s class path. </p></li> 
   <li><p>Create a Rights Management Client API object </p><p>Create a <span class="code">DocumentSecurityClient</span> object by using its constructor and passing a <span class="code">ServiceClientFactory</span> object that contains connection properties.</p></li> 
   <li><p>Specify the events to search for </p> 
    <ul> 
     <li><p>Create an <span class="code">EventManager</span> object by invoking the <span class="code">DocumentSecurityClient</span> object’s <span class="code">getEventManager</span> method. This method returns an <span class="code">EventManager</span> object.</p></li> 
     <li><p>Create an <span class="code">EventSearchFilter</span> object by invoking its constructor. </p></li> 
     <li><p>Specify the event for which to search by invoking the <span class="code">EventSearchFilter</span> object’s <span class="code">setEventCode</span> method and passing a static data member that belongs to the <span class="code">EventManager</span> class that represents the event for which to search. For example, to search for the policy create event, pass <span class="code">EventManager.POLICY_CREATE_EVENT</span>.</p></li> 
    </ul> 
    <note> 
     <p>You can define additional search criteria by invoking <span class="code">EventSearchFilter</span> object methods. For example, invoke the <span class="code">setUserName</span> method to specify a user associated with the event.</p> 
    </note></li> 
   <li><p>Search for the event </p><p>Search for the event by invoking the <span class="code">EventManager</span> object’s <span class="code">searchForEvents</span> method and passing the <span class="code">EventSearchFilter</span> object that defines the event search criteria. This method returns an array of <span class="code">Event</span> objects. </p></li> 
  </ol> 
  <p><strong>Code examples</strong></p> 
  <p>For code examples using the Rights Management service, see the following Quick Starts in <i><a href="/programming-with-aem-forms/#java_api_soap_quick_start_code_examples">API Quick Starts (Code Examples)</a></i>:</p> 
  <ul> 
   <li><p>“Quick Start (SOAP): Searching for events using the Java API”</p></li> 
  </ul> 
  <h3 id="search_for_events_using_the_web_service_api">Search for events using the web service API</h3> 
  <p></p> 
  <p>Search for events by using the Rights Management API (web service):</p> 
  <ol> 
   <li><p>Include project files </p><p>Create a Microsoft .NET project that uses MTOM. Ensure that you use the following WSDL definition: <span class="code">http://localhost:8080/soap/services/RightsManagementService?WSDL&amp;lc_version=9.0.1</span>. </p> 
    <note> 
     <p>Replace <span class="code">localhost</span> with the IP address of the server hosting AEM Forms. </p> 
    </note></li> 
   <li><p>Create a Rights Management Client API object </p> 
    <ul> 
     <li><p>Create a <span class="code">DocumentSecurityServiceClient</span> object by using its default constructor. </p></li> 
     <li><p>Create a <span class="code">DocumentSecurityServiceClient.Endpoint.Address</span> object by using the <span class="code">System.ServiceModel.EndpointAddress</span> constructor. Pass a string value that specifies the WSDL to the AEM Forms service (for example, <span class="code">http://localhost:8080/soap/services/RightsManagementService?WSDL</span>.) You do not need to use the <span class="code">lc_version</span> attribute. This attribute is used when you create a service reference.) </p></li> 
     <li><p>Create a <span class="code">System.ServiceModel.BasicHttpBinding</span> object by getting the value of the <span class="code">DocumentSecurityServiceClient.Endpoint.Binding</span> field. Cast the return value to <span class="code">BasicHttpBinding</span>. </p></li> 
     <li><p>Set the <span class="code">System.ServiceModel.BasicHttpBinding</span> object’s <span class="code">MessageEncoding</span> field to <span class="code">WSMessageEncoding.Mtom</span>. This value ensures that MTOM is used. </p></li> 
     <li><p>Enable basic HTTP authentication by performing the following tasks:</p> 
      <ul> 
       <li><p>Assign the AEM forms user name to the field <span class="code">DocumentSecurityServiceClient.ClientCredentials.UserName.UserName</span>.</p></li> 
       <li><p>Assign the corresponding password value to the field <span class="code">DocumentSecurityServiceClient.ClientCredentials.UserName.Password</span>.</p></li> 
       <li><p>Assign the constant value <span class="code">HttpClientCredentialType.Basic</span> to the field <span class="code">BasicHttpBindingSecurity.Transport.ClientCredentialType</span>. </p></li> 
      </ul></li> 
     <li><p>Assign the constant value <span class="code">BasicHttpSecurityMode.TransportCredentialOnly</span> to the field <span class="code">BasicHttpBindingSecurity.Security.Mode</span>. </p></li> 
    </ul></li> 
   <li><p>Specify the events to search for </p> 
    <ul> 
     <li><p>Create an <span class="code">EventSpec</span> object by using its constructor. </p></li> 
     <li><p>Specify the start of the time period during which the event occurred by setting the <span class="code">EventSpec</span> object’s <span class="code">firstTime.date</span> data member with <span class="code">DataTime</span> instance that represents the start of the date range when the event occurred. </p></li> 
     <li><p>Assign the value <span class="code">true</span> to the <span class="code">EventSpec</span> object’s <span class="code">firstTime.dateSpecified</span> data member.</p></li> 
     <li><p>Specify the end of the time period during which the event occurred by setting the <span class="code">EventSpec</span> object’s <span class="code">lastTime.date</span> data member with <span class="code">DataTime</span> instance that represents the end of the date range when the event occurred. </p></li> 
     <li><p>Assign the value <span class="code">true</span> to the <span class="code">EventSpec</span> object’s <span class="code">lastTime.dateSpecified</span> data member.</p></li> 
     <li><p>Set the event to search for by assigning a string value to the <span class="code">EventSpec</span> object’s <span class="code">eventCode</span> data member. The following table lists the numeric values that you can assign to this property:</p> 
      <div class="tablenoborder"> 
       <table border="1" cellpadding="4" cellspacing="0" frame="border" rules="all" summary=""> 
        <thead align="left"> 
         <tr> 
          <th class="cellrowborder" id="d19e50725" valign="top" width="NaN%"><p>Event type</p></th> 
          <th class="cellrowborder" id="d19e50728" valign="top" width="NaN%"><p>Value</p></th> 
         </tr> 
        </thead> 
        <tbody> 
         <tr> 
          <td class="cellrowborder" headers="d19e50725 " valign="top" width="NaN%"><p><span class="code">ALL_EVENTS</span></p></td> 
          <td class="cellrowborder" headers="d19e50728 " valign="top" width="NaN%"><p>999</p></td> 
         </tr> 
         <tr> 
          <td class="cellrowborder" headers="d19e50725 " valign="top" width="NaN%"><p><span class="code">USER_CHANGE_PASSWORD_EVENT</span></p></td> 
          <td class="cellrowborder" headers="d19e50728 " valign="top" width="NaN%"><p>1000</p></td> 
         </tr> 
         <tr> 
          <td class="cellrowborder" headers="d19e50725 " valign="top" width="NaN%"><p><span class="code">USER_REGISTER_EVENT</span></p></td> 
          <td class="cellrowborder" headers="d19e50728 " valign="top" width="NaN%"><p>1001</p></td> 
         </tr> 
         <tr> 
          <td class="cellrowborder" headers="d19e50725 " valign="top" width="NaN%"><p><span class="code">USER_PREREGISTER_EVENT</span></p></td> 
          <td class="cellrowborder" headers="d19e50728 " valign="top" width="NaN%"><p>1002</p></td> 
         </tr> 
         <tr> 
          <td class="cellrowborder" headers="d19e50725 " valign="top" width="NaN%"><p><span class="code">USER_ACTIVATE_EVENT</span></p></td> 
          <td class="cellrowborder" headers="d19e50728 " valign="top" width="NaN%"><p>1003</p></td> 
         </tr> 
         <tr> 
          <td class="cellrowborder" headers="d19e50725 " valign="top" width="NaN%"><p><span class="code">USER_DEACTIVATE_EVENT</span></p></td> 
          <td class="cellrowborder" headers="d19e50728 " valign="top" width="NaN%"><p>1004</p></td> 
         </tr> 
         <tr> 
          <td class="cellrowborder" headers="d19e50725 " valign="top" width="NaN%"><p><span class="code">USER_AUTHENTICATE_EVENT</span></p></td> 
          <td class="cellrowborder" headers="d19e50728 " valign="top" width="NaN%"><p>1005</p></td> 
         </tr> 
         <tr> 
          <td class="cellrowborder" headers="d19e50725 " valign="top" width="NaN%"><p><span class="code">USER_AUTHENTICATE_DENY_EVENT </span></p></td> 
          <td class="cellrowborder" headers="d19e50728 " valign="top" width="NaN%"><p>1006</p></td> 
         </tr> 
         <tr> 
          <td class="cellrowborder" headers="d19e50725 " valign="top" width="NaN%"><p><span class="code">USER_ACCOUNT_LOCK_EVENT</span></p></td> 
          <td class="cellrowborder" headers="d19e50728 " valign="top" width="NaN%"><p>1007</p></td> 
         </tr> 
         <tr> 
          <td class="cellrowborder" headers="d19e50725 " valign="top" width="NaN%"><p><span class="code">USER_DELETE_EVENT </span></p></td> 
          <td class="cellrowborder" headers="d19e50728 " valign="top" width="NaN%"><p>1008</p></td> 
         </tr> 
         <tr> 
          <td class="cellrowborder" headers="d19e50725 " valign="top" width="NaN%"><p><span class="code">USER_UPDATE_PROFILE_EVENT </span></p></td> 
          <td class="cellrowborder" headers="d19e50728 " valign="top" width="NaN%"><p>1009</p></td> 
         </tr> 
         <tr> 
          <td class="cellrowborder" headers="d19e50725 " valign="top" width="NaN%"><p><span class="code">DOCUMENT_VIEW_EVENT </span></p></td> 
          <td class="cellrowborder" headers="d19e50728 " valign="top" width="NaN%"><p>2000</p></td> 
         </tr> 
         <tr> 
          <td class="cellrowborder" headers="d19e50725 " valign="top" width="NaN%"><p><span class="code">DOCUMENT_PRINT_LOW_EVENT </span></p></td> 
          <td class="cellrowborder" headers="d19e50728 " valign="top" width="NaN%"><p>2001</p></td> 
         </tr> 
         <tr> 
          <td class="cellrowborder" headers="d19e50725 " valign="top" width="NaN%"><p><span class="code">DOCUMENT_PRINT_HIGH_EVENT </span></p></td> 
          <td class="cellrowborder" headers="d19e50728 " valign="top" width="NaN%"><p>2002</p></td> 
         </tr> 
         <tr> 
          <td class="cellrowborder" headers="d19e50725 " valign="top" width="NaN%"><p><span class="code">DOCUMENT_SIGN_EVENT </span></p></td> 
          <td class="cellrowborder" headers="d19e50728 " valign="top" width="NaN%"><p>2003</p></td> 
         </tr> 
         <tr> 
          <td class="cellrowborder" headers="d19e50725 " valign="top" width="NaN%"><p><span class="code">DOCUMENT_ADD_ANNOTATION_EVENT </span></p></td> 
          <td class="cellrowborder" headers="d19e50728 " valign="top" width="NaN%"><p>2004</p></td> 
         </tr> 
         <tr> 
          <td class="cellrowborder" headers="d19e50725 " valign="top" width="NaN%"><p><span class="code">DOCUMENT_FORM_FILL_EVENT </span></p></td> 
          <td class="cellrowborder" headers="d19e50728 " valign="top" width="NaN%"><p>2005</p></td> 
         </tr> 
         <tr> 
          <td class="cellrowborder" headers="d19e50725 " valign="top" width="NaN%"><p><span class="code">DOCUMENT_CLOSE_EVENT </span></p></td> 
          <td class="cellrowborder" headers="d19e50728 " valign="top" width="NaN%"><p>2006</p></td> 
         </tr> 
         <tr> 
          <td class="cellrowborder" headers="d19e50725 " valign="top" width="NaN%"><p><span class="code">DOCUMENT_MODIFY_EVENT </span></p></td> 
          <td class="cellrowborder" headers="d19e50728 " valign="top" width="NaN%"><p>2007</p></td> 
         </tr> 
         <tr> 
          <td class="cellrowborder" headers="d19e50725 " valign="top" width="NaN%"><p><span class="code">DOCUMENT_CHANGE_SECURITY_HANDLER_EVENT </span></p></td> 
          <td class="cellrowborder" headers="d19e50728 " valign="top" width="NaN%"><p>2008</p></td> 
         </tr> 
         <tr> 
          <td class="cellrowborder" headers="d19e50725 " valign="top" width="NaN%"><p><span class="code">DOCUMENT_SWITCH_POLICY_EVENT </span></p></td> 
          <td class="cellrowborder" headers="d19e50728 " valign="top" width="NaN%"><p>2009</p></td> 
         </tr> 
         <tr> 
          <td class="cellrowborder" headers="d19e50725 " valign="top" width="NaN%"><p><span class="code">DOCUMENT_REVOKE_EVENT </span></p></td> 
          <td class="cellrowborder" headers="d19e50728 " valign="top" width="NaN%"><p>2010</p></td> 
         </tr> 
         <tr> 
          <td class="cellrowborder" headers="d19e50725 " valign="top" width="NaN%"><p><span class="code">DOCUMENT_UNREVOKE_EVENT </span></p></td> 
          <td class="cellrowborder" headers="d19e50728 " valign="top" width="NaN%"><p>2011</p></td> 
         </tr> 
         <tr> 
          <td class="cellrowborder" headers="d19e50725 " valign="top" width="NaN%"><p><span class="code">DOCUMENT_SECURE_EVENT </span></p></td> 
          <td class="cellrowborder" headers="d19e50728 " valign="top" width="NaN%"><p>2012</p></td> 
         </tr> 
         <tr> 
          <td class="cellrowborder" headers="d19e50725 " valign="top" width="NaN%"><p><span class="code">DOCUMENT_UNKNOWN_CLIENT_EVENT </span></p></td> 
          <td class="cellrowborder" headers="d19e50728 " valign="top" width="NaN%"><p>2013</p></td> 
         </tr> 
         <tr> 
          <td class="cellrowborder" headers="d19e50725 " valign="top" width="NaN%"><p><span class="code">DOCUMENT_CHANGE_REVOKE_URL_EVENT </span></p></td> 
          <td class="cellrowborder" headers="d19e50728 " valign="top" width="NaN%"><p>2014</p></td> 
         </tr> 
         <tr> 
          <td class="cellrowborder" headers="d19e50725 " valign="top" width="NaN%"><p><span class="code">POLICY_CHANGE_EVENT </span></p></td> 
          <td class="cellrowborder" headers="d19e50728 " valign="top" width="NaN%"><p>3000</p></td> 
         </tr> 
         <tr> 
          <td class="cellrowborder" headers="d19e50725 " valign="top" width="NaN%"><p><span class="code">POLICY_ENABLE_EVENT </span></p></td> 
          <td class="cellrowborder" headers="d19e50728 " valign="top" width="NaN%"><p>3001</p></td> 
         </tr> 
         <tr> 
          <td class="cellrowborder" headers="d19e50725 " valign="top" width="NaN%"><p><span class="code">POLICY_DISABLE_EVENT </span></p></td> 
          <td class="cellrowborder" headers="d19e50728 " valign="top" width="NaN%"><p>3002</p></td> 
         </tr> 
         <tr> 
          <td class="cellrowborder" headers="d19e50725 " valign="top" width="NaN%"><p><span class="code">POLICY_CREATE_EVENT </span></p></td> 
          <td class="cellrowborder" headers="d19e50728 " valign="top" width="NaN%"><p>3003</p></td> 
         </tr> 
         <tr> 
          <td class="cellrowborder" headers="d19e50725 " valign="top" width="NaN%"><p><span class="code">POLICY_DELETE_EVENT </span></p></td> 
          <td class="cellrowborder" headers="d19e50728 " valign="top" width="NaN%"><p>3004</p></td> 
         </tr> 
         <tr> 
          <td class="cellrowborder" headers="d19e50725 " valign="top" width="NaN%"><p><span class="code">POLICY_CHANGE_OWNER_EVENT </span></p></td> 
          <td class="cellrowborder" headers="d19e50728 " valign="top" width="NaN%"><p>3005</p></td> 
         </tr> 
         <tr> 
          <td class="cellrowborder" headers="d19e50725 " valign="top" width="NaN%"><p><span class="code">SERVER_CLIENT_SYNC_EVENT </span></p></td> 
          <td class="cellrowborder" headers="d19e50728 " valign="top" width="NaN%"><p>4000</p></td> 
         </tr> 
         <tr> 
          <td class="cellrowborder" headers="d19e50725 " valign="top" width="NaN%"><p><span class="code">SERVER_SYNC_DIR_INFO_EVENT </span></p></td> 
          <td class="cellrowborder" headers="d19e50728 " valign="top" width="NaN%"><p>4001</p></td> 
         </tr> 
         <tr> 
          <td class="cellrowborder" headers="d19e50725 " valign="top" width="NaN%"><p><span class="code">SERVER_SYNC_DIR_COMPLETE_EVENT </span></p></td> 
          <td class="cellrowborder" headers="d19e50728 " valign="top" width="NaN%"><p>4002</p></td> 
         </tr> 
         <tr> 
          <td class="cellrowborder" headers="d19e50725 " valign="top" width="NaN%"><p><span class="code">SERVER_VERSION_MISMATCH_EVENT </span></p></td> 
          <td class="cellrowborder" headers="d19e50728 " valign="top" width="NaN%"><p>4003</p></td> 
         </tr> 
         <tr> 
          <td class="cellrowborder" headers="d19e50725 " valign="top" width="NaN%"><p><span class="code">SERVER_CONFIG_CHANGE_EVENT </span></p></td> 
          <td class="cellrowborder" headers="d19e50728 " valign="top" width="NaN%"><p>4004</p></td> 
         </tr> 
         <tr> 
          <td class="cellrowborder" headers="d19e50725 " valign="top" width="NaN%"><p><span class="code">SERVER_ENABLE_OFFLINE_ACCESS_EVENT </span></p></td> 
          <td class="cellrowborder" headers="d19e50728 " valign="top" width="NaN%"><p>4005</p></td> 
         </tr> 
         <tr> 
          <td class="cellrowborder" headers="d19e50725 " valign="top" width="NaN%"><p><span class="code">ADMIN_ADD_EVENT </span></p></td> 
          <td class="cellrowborder" headers="d19e50728 " valign="top" width="NaN%"><p>5000</p></td> 
         </tr> 
         <tr> 
          <td class="cellrowborder" headers="d19e50725 " valign="top" width="NaN%"><p><span class="code">ADMIN_DELETE_EVENT </span></p></td> 
          <td class="cellrowborder" headers="d19e50728 " valign="top" width="NaN%"><p>5001</p></td> 
         </tr> 
         <tr> 
          <td class="cellrowborder" headers="d19e50725 " valign="top" width="NaN%"><p><span class="code">ADMIN_EDIT_EVENT </span></p></td> 
          <td class="cellrowborder" headers="d19e50728 " valign="top" width="NaN%"><p>5002</p></td> 
         </tr> 
         <tr> 
          <td class="cellrowborder" headers="d19e50725 " valign="top" width="NaN%"><p><span class="code">ADMIN_ACTIVATE_EVENT </span></p></td> 
          <td class="cellrowborder" headers="d19e50728 " valign="top" width="NaN%"><p>5003</p></td> 
         </tr> 
         <tr> 
          <td class="cellrowborder" headers="d19e50725 " valign="top" width="NaN%"><p><span class="code">ADMIN_DEACTIVATE_EVENT </span></p></td> 
          <td class="cellrowborder" headers="d19e50728 " valign="top" width="NaN%"><p>5004</p></td> 
         </tr> 
         <tr> 
          <td class="cellrowborder" headers="d19e50725 " valign="top" width="NaN%"><p><span class="code">ERROR_DIRECTORY_SERVICE_EVENT </span></p></td> 
          <td class="cellrowborder" headers="d19e50728 " valign="top" width="NaN%"><p>6000</p></td> 
         </tr> 
         <tr> 
          <td class="cellrowborder" headers="d19e50725 " valign="top" width="NaN%"><p><span class="code">CREATED_POLICYSET_EVENT</span></p></td> 
          <td class="cellrowborder" headers="d19e50728 " valign="top" width="NaN%"><p>7000</p></td> 
         </tr> 
         <tr> 
          <td class="cellrowborder" headers="d19e50725 " valign="top" width="NaN%"><p><span class="code">DELETED_POLICYSET_EVENT</span></p></td> 
          <td class="cellrowborder" headers="d19e50728 " valign="top" width="NaN%"><p>7001</p></td> 
         </tr> 
         <tr> 
          <td class="cellrowborder" headers="d19e50725 " valign="top" width="NaN%"><p><span class="code">MODIFIED_POLICYSET_EVENT</span></p></td> 
          <td class="cellrowborder" headers="d19e50728 " valign="top" width="NaN%"><p>7002</p></td> 
         </tr> 
        </tbody> 
       </table> 
      </div> </li> 
    </ul></li> 
   <li><p>Search for the event </p><p>Search for the event by invoking the <span class="code">DocumentSecurityServiceClient</span> object’s <span class="code">searchForEvents</span> method and passing the <span class="code">EventSpec</span> object that represents the event for which to search and the maximum number of results. This method returns a <span class="code">MyArrayOf_xsd_anyType</span> collection where each element is an <span class="code">AuditSpec</span> instance. Using an <span class="code">AuditSpec</span> instance, you can obtain information about the event such as the time that it occurred. The <span class="code">AuditSpec</span> instance contains a <span class="code">timestamp</span> data member that specifies this information. </p></li> 
  </ol> 
  <p><strong>Code examples</strong></p> 
  <p>For code examples using the Rights Management service, see the following Quick Starts in <i><a href="/programming-with-aem-forms/#java_api_soap_quick_start_code_examples">API Quick Starts (Code Examples)</a></i>:</p> 
  <ul> 
   <li><p>“Quick Start (MTOM): Searching for events using the web service API”</p></li> 
   <li><p>“Quick Start (SwaRef): Searching for events using the web service API”</p></li> 
  </ul> 
  <p><strong>See also</strong></p> 
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-web#invoking_aem_forms_using_mtom">Invoking AEM Forms using MTOM</a></p> 
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-web#invoking_aem_forms_using_swaref">Invoking AEM Forms using SwaRef</a></p> 
  <draft-comment type="remark">
    Content Referenced from lc_po_apply_policies_word_ap.xml#WS624e3cba99b79e12e69a9941333732bac8-7fef.2_ver6.1 
  </draft-comment> 
  <h2 id="applying_policies_to_word_documents">Applying Policies to Word Documents</h2> 
  <p></p> 
  <p>In addition to PDF documents, the Rights Mangement service supports additional document formats such as a Microsoft Word document (DOC file) and other Micosoft office file formats. For example, you can apply a policy to a Word document in order to secure it. By applying a policy to a Word document, you restrict access to the document. You cannot apply a policy to a document if the document is already secured with a policy. </p> 
  <p>You can monitor the use of a policy-protected Word document after you distribute it. That is, you can see how the document is being used and who is using it. For example, you can find out when somebody has opened the document.</p> 
  <note> 
   <p>For more information about the Document Security service, see <a href="http://www.adobe.com/go/learn_aemforms_services_63">Services Reference for AEM Forms</a>.</p> 
  </note> 
  <h3 id="summary_of_steps">Summary of steps</h3> 
  <p></p> 
  <p>To apply a policy to a Word document, perform the following steps:</p> 
  <ol> 
   <li><p>Include project files.</p></li> 
   <li><p>Create a Document Security Client API object.</p></li> 
   <li><p>Retrieve a Word document to which a policy is applied.</p></li> 
   <li><p>Apply an existing policy to the Word document.</p></li> 
   <li><p>Save the policy-protected Word document.</p></li> 
  </ol> 
  <p><strong>Include project files</strong></p> 
  <p>Include necessary files into your development project. If you are creating a client application using Java, then include the necessary JAR files. If you are using web services, then make sure that you include the proxy files.</p> 
  <p><strong>Create a Document Security Client APIobject</strong></p> 
  <p>Before you can programmatically perform a Document Security service operation, you must create a Document Security service client object.</p> 
  <p><strong>Retrieve a Word document</strong></p> 
  <p>You must retrieve a Word document in order to apply a policy. After you apply a policy to the Word document, users are restricted when using the document. For example, if the policy does not enable the document to be opened while offline, then users must be online to open the document.</p> 
  <p><strong>Apply an existing policy to the Word document</strong></p> 
  <p>To apply a policy to a Word document, you must reference an existing policy and specify which policy set the policy belongs to. The user who is setting the connection properties must have access to the specified policy. If not, an exception occurs. </p> 
  <p><strong>Save the Word document </strong></p> 
  <p>After the Document Security service applies a policy to a Word document, you can save the policy-protected Word document as a DOC file.</p> 
  <p><strong>See also</strong></p> 
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-java#including_aem_forms_java_library_files">Including AEM Forms Java library files</a></p> 
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-java#setting_connection_properties">Setting connection properties</a></p> 
  <p><a href="protecting-documents-policies#revoking_access_to_documents">Revoking Access to Documents</a></p> 
  <h3 id="apply_a_policy_to_a_word_document_using_the_java_api">Apply a policy to a Word document using the Java API</h3> 
  <p></p> 
  <p>Apply a policy to a Word document by using the Document Security API (Java):</p> 
  <ol> 
   <li><p>Include project files. </p><p>Include client JAR files, such as adobe-rightsmanagement-client.jar, in your Java project’s class path. </p></li> 
   <li><p>Create a Document Security Client API object. </p> 
    <ul> 
     <li><p>Create a <span class="code">ServiceClientFactory</span> object that contains connection properties.</p></li> 
     <li><p>Create a <span class="code">DocumentSecurityClient</span> object by using its constructor and passing the <span class="code">ServiceClientFactory</span> object.</p></li> 
    </ul></li> 
   <li><p>Retrieve a Word document. </p> 
    <ul> 
     <li><p>Create a <span class="code">java.io.FileInputStream</span> object that represents the Word document by using its constructor and passing a string value that specifies the location of the Word document. </p></li> 
     <li><p>Create a <span class="code">com.adobe.idp.Document</span> object by using its constructor and passing the <span class="code">java.io.FileInputStream</span> object.</p></li> 
    </ul></li> 
   <li><p>Apply an existing policy to the Word document. </p> 
    <ul> 
     <li><p>Create a <span class="code">DocumentManager</span> object by invoking the <span class="code">DocumentSecurityClient</span> object’s <span class="code">getDocumentManager</span> method.</p></li> 
     <li><p>Apply a policy to the Word document by invoking the <span class="code">DocumentManager</span> object’s <span class="code">protectDocument</span> method and passing the following values:</p> 
      <ul> 
       <li><p>The <span class="code">com.adobe.idp.Document</span> object that contains the Word document to which the policy is applied. </p></li> 
       <li><p>A string value that specifies the name of the document.</p></li> 
       <li><p>A string value that specifies the name of the policy set to which the policy belongs. You can specify a <span class="code">null</span> value that results in the <span class="code">MyPolicies</span> policy set being used. </p></li> 
       <li><p>A string value that specifies the policy name.</p></li> 
       <li><p>A string value that represents the name of the user manager domain of the user who is the publisher of the document. This parameter value is optional and can be null (if this parameter is null, then the next parameter value must be null).</p></li> 
       <li><p>A string value that represents the name of the canonical name of the user manager user who is the publisher of the document. This parameter value is optional and can be <span class="code">null</span> (if this parameter is <span class="code">null</span>, then the previous parameter value must be <span class="code">null</span>).</p></li> 
       <li><p>A <span class="code">com.adobe.livecycle.rightsmanagement.Locale</span> that represents the locale that is used for selecting the MS Office template. This parameter value is optional and you can specify <span class="code">null</span>. </p></li> 
      </ul><p>The <span class="code">protectDocument</span> method returns a <span class="code">RMSecureDocumentResult</span> object that contains the policy-protected Word document.</p></li> 
    </ul></li> 
   <li><p>Save the Word document. </p> 
    <ul> 
     <li><p>Invoke the <span class="code">RMSecureDocumentResult</span> object’s <span class="code">getProtectedDoc</span> method to get the policy-protected Word document. This method returns a <span class="code">com.adobe.idp.Document</span> object. </p></li> 
     <li><p>Create a <span class="code">java.io.File</span> object and ensure that the file extension is DOC.</p></li> 
     <li><p>Invoke the <span class="code">com.adobe.idp.Document</span> object’s <span class="code">copyToFile</span> method to copy the contents of the <span class="code">Document</span> object to the file (ensure that you use the <span class="code">Document</span> object that was returned by the <span class="code">getProtectedDoc</span> method).</p></li> 
    </ul></li> 
  </ol> 
  <p><strong>Code examples</strong></p> 
  <p>For code examples using the Document Security service, see the following Quick Start in <i><a href="/programming-with-aem-forms/#java_api_soap_quick_start_code_examples">API Quick Starts (Code Examples)</a></i>:</p> 
  <ul> 
   <li><p>“Quick Start (SOAP mode): Applying a policy to a Word document using the Java API”</p></li> 
  </ul> 
  <h3 id="apply_a_policy_to_a_word_document_using_the_web_service_api">Apply a policy to a Word document using the web service API</h3> 
  <p></p> 
  <p>Apply a policy to a Word document by using the Document Security API (web service):</p> 
  <ol> 
   <li><p>Include project files. </p><p>Create a Microsoft .NET project that uses MTOM. Ensure that you use the following WSDL definition: <span class="code">http://localhost:8080/soap/services/DocumentSecurityService?WSDL&amp;lc_version=9.0.1</span>. </p> 
    <note> 
     <p>Replace <span class="code">localhost</span> with the IP address of the server hosting AEM Forms. </p> 
    </note></li> 
   <li><p>Create a Document Security Client API object. </p> 
    <ul> 
     <li><p>Create a <span class="code">DocumentSecurityServiceClient</span> object by using its default constructor. </p></li> 
     <li><p>Create a <span class="code">DocumentSecurityServiceClient.Endpoint.Address</span> object by using the <span class="code">System.ServiceModel.EndpointAddress</span> constructor. Pass a string value that specifies the WSDL to the AEM Forms service (for example, <span class="code">http://localhost:8080/soap/services/DocumentSecurityService?WSDL</span>.) You do not need to use the <span class="code">lc_version</span> attribute. This attribute is used when you create a service reference.) </p></li> 
     <li><p>Create a <span class="code">System.ServiceModel.BasicHttpBinding</span> object by getting the value of the <span class="code">DocumentSecurityServiceClient.Endpoint.Binding</span> field. Cast the return value to <span class="code">BasicHttpBinding</span>. </p></li> 
     <li><p>Set the <span class="code">System.ServiceModel.BasicHttpBinding</span> object’s <span class="code">MessageEncoding</span> field to <span class="code">WSMessageEncoding.Mtom</span>. This value ensures that MTOM is used. </p></li> 
     <li><p>Enable basic HTTP authentication by performing the following tasks:</p> 
      <ul> 
       <li><p>Assign the AEM forms user name to the field <span class="code">DocumentSecurityServiceClient.ClientCredentials.UserName.UserName</span>.</p></li> 
       <li><p>Assign the corresponding password value to the field <span class="code">DocumentSecurityServiceClient.ClientCredentials.UserName.Password</span>.</p></li> 
       <li><p>Assign the constant value <span class="code">HttpClientCredentialType.Basic</span> to the field <span class="code">BasicHttpBindingSecurity.Transport.ClientCredentialType</span>. </p></li> 
      </ul></li> 
     <li><p>Assign the constant value <span class="code">BasicHttpSecurityMode.TransportCredentialOnly</span> to the field <span class="code">BasicHttpBindingSecurity.Security.Mode</span>. </p></li> 
    </ul></li> 
   <li><p>Retrieve a Word document. </p> 
    <ul> 
     <li><p>Create a <span class="code">BLOB</span> object by using its constructor. The <span class="code">BLOB</span> object is used to store a Word document to which a policy is applied.</p></li> 
     <li><p>Create a <span class="code">System.IO.FileStream</span> object by invoking its constructor and passing a string value that represents the file location of the Word document and the mode in which to open the file.</p></li> 
     <li><p>Create a byte array that stores the content of the <span class="code">System.IO.FileStream</span> object. Determine the byte array size by getting the <span class="code">System.IO.FileStream</span> object’s <span class="code">Length</span> property.</p></li> 
     <li><p>Populate the byte array with stream data by invoking the <span class="code">System.IO.FileStream</span> object’s <span class="code">Read</span> method. Pass the byte array, the starting position, and the stream length to read.</p></li> 
     <li><p>Populate the <span class="code">BLOB</span> object by assigning its <span class="code">MTOM</span> field with the contents of the byte array.</p></li> 
    </ul></li> 
   <li><p>Apply an existing policy to the Word document. </p><p>Apply a policy to the Word document by invoking the <span class="code">DocumentSecurityServiceClient</span> object’s <span class="code">protectDocument</span> method and passing the following values:</p> 
    <ul> 
     <li><p>The <span class="code">BLOB</span> object that contains the Word document to which the policy is applied.</p></li> 
     <li><p>A string value that specifies the name of the document.</p></li> 
     <li><p>A string value that specifies the name of the policy set to which the policy belongs. You can specify a <span class="code">null</span> value that results in the <span class="code">MyPolicies</span> policy set being used. </p></li> 
     <li><p>A string value that specifies the policy name.</p></li> 
     <li><p>A string value that represents the name of the user manager domain of the user who is the publisher of the document. This parameter value is optional and can be null (if this parameter is null, then the next parameter value must be <span class="code">null</span>).</p></li> 
     <li><p>A string value that represents the name of the canonical name of the user manager user who is the publisher of the document. This parameter value is optional and can be null (if this parameter is null, then the previous parameter value must be <span class="code">null</span>).</p></li> 
     <li><p>A <span class="code">RMLocale</span> value that specifies the locale value (for example, <span class="code">RMLocale.en</span>).</p></li> 
     <li><p>A string output parameter that is used to store the policy identifier value. </p></li> 
     <li><p>A string output parameter that is used to store the policy-protected identifier value. </p></li> 
     <li><p>A string output parameter that is used to store the mime type (for example, <span class="code">application/doc</span>). </p></li> 
    </ul><p>The <span class="code">protectDocument</span> method returns a <span class="code">BLOB</span> object that contains the policy-protected Word document.</p></li> 
   <li><p>Save the Word document. </p> 
    <ul> 
     <li><p>Create a <span class="code">System.IO.FileStream</span> object by invoking its constructor and passing a string value that represents the file location of the policy-protected Word document.</p></li> 
     <li><p>Create a byte array that stores the data content of the <span class="code">BLOB</span> object that was returned by the <span class="code">protectDocument</span> method. Populate the byte array by getting the value of the <span class="code">BLOB</span> object’s <span class="code">MTOM</span> data member.</p></li> 
     <li><p>Create a <span class="code">System.IO.BinaryWriter</span> object by invoking its constructor and passing the <span class="code">System.IO.FileStream</span> object.</p></li> 
     <li><p>Write the contents of the byte array to a Word file by invoking the <span class="code">System.IO.BinaryWriter</span> object’s <span class="code">Write</span> method and passing the byte array.</p></li> 
    </ul></li> 
  </ol> 
  <p><strong>Code examples</strong></p> 
  <p>For code examples using the Document Security service, see the following Quick Start in <i><a href="/programming-with-aem-forms/#java_api_soap_quick_start_code_examples">API Quick Starts (Code Examples)</a></i>:</p> 
  <ul> 
   <li><p>“Quick Start (MTOM): Applying a policy to a Word document using the web service API ”</p></li> 
  </ul> 
  <draft-comment type="remark">
    Content Referenced from lc_po_remove_policies_word_rp.xml#WS624e3cba99b79e12e69a9941333732bac8-7fee.2_ver6.1 
  </draft-comment> 
  <h2 id="removing_policies_from_word_documents">Removing Policies from Word Documents</h2> 
  <p></p> 
  <p>You can remove a policy from a policy-protected Word document in order to remove security from the document. That is, if you no longer want the document to be protected by a policy. If you want to update a policy-protected Word document with a newer policy, then instead of removing the policy and adding the updated policy, it is more efficient to switch the policy.</p> 
  <note> 
   <p>For more information about the Document Security service, see <a href="http://www.adobe.com/go/learn_aemforms_services_63">Services Reference for AEM Forms</a>.</p> 
  </note> 
  <h3 id="summary_of_steps">Summary of steps</h3> 
  <p></p> 
  <p>To remove a policy from a policy-protected Word document, perform the following steps:</p> 
  <ol> 
   <li><p>Include project files</p></li> 
   <li><p>Create a Document Security Client API object.</p></li> 
   <li><p>Retrieve a policy-protected Word document.</p></li> 
   <li><p>Remove the policy from the Word document.</p></li> 
   <li><p>Save the unsecured Word document.s</p></li> 
  </ol> 
  <p><strong>Include project files</strong></p> 
  <p>Include necessary files into your development project. If you are creating a client application using Java, then include the necessary JAR files. If you are using web services, then make sure that you include the proxy files.</p> 
  <p><strong>Create a Document Security Client API object</strong></p> 
  <p>Before you can programmatically perform a Document Security service operation, create a Document Security service client object.</p> 
  <p><strong>Retrieve a policy-protected Word document</strong></p> 
  <p>You must retrieve a policy-protected Word document in order to remove a policy. If you attempt to remove a policy from a Word document that is not protected by a policy, you will cause an exception. </p> 
  <p><strong>Remove the policy from the Word document</strong></p> 
  <p>You can remove a policy from a policy-protected Word document provided that an administrator is specified in the connection settings. If not, then the policy used to secure a document must contain the <span class="code">SWITCH_POLICY</span> permission in order to remove a policy from a Word document. Also, the user specified in the AEM Forms connection settings must also have that permission. Otherwise, an exception is thrown. </p> 
  <p><strong>Save the unsecured Word document </strong></p> 
  <p>After the Document Security service removes a policy from a Word document, you can save the unsecured Word document as a DOC file.</p> 
  <p><strong>See also</strong></p> 
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-java#including_aem_forms_java_library_files">Including AEM Forms Java library files</a></p> 
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-java#setting_connection_properties">Setting connection properties</a></p> 
  <p><a href="protecting-documents-policies#applying_policies_to_word_documents">Applying Policies to Word Documents</a></p> 
  <h3 id="remove_a_policy_from_a_word_document_using_the_java_api">Remove a policy from a Word document using the Java API</h3> 
  <p></p> 
  <p>Remove a policy from a policy-protected Word document by using the Document Security API (Java):</p> 
  <ol> 
   <li><p>Include project files </p><p>Include client JAR files, such as adobe-rightsmanagement-client.jar, in your Java project’s class path. </p></li> 
   <li><p>Create a Document Security Client API object </p> 
    <ul> 
     <li><p>Create a <span class="code">ServiceClientFactory</span> object that contains connection properties.</p></li> 
     <li><p>Create a <span class="code">RightsManagementClient</span> object by using its constructor and passing the <span class="code">ServiceClientFactory</span> object.</p></li> 
    </ul></li> 
   <li><p>Retrieve a policy-protected Word document </p> 
    <ul> 
     <li><p>Create a <span class="code">java.io.FileInputStream</span> object that represents the policy-protected Word document by using its constructor and passing a string value that specifies the location of the Word document. </p></li> 
     <li><p>Create a <span class="code">com.adobe.idp.Document</span> object by using its constructor and passing the <span class="code">java.io.FileInputStream</span> object.</p></li> 
    </ul></li> 
   <li><p>Remove the policy from the Word document </p> 
    <ul> 
     <li><p>Create a <span class="code">DocumentManager</span> object by invoking the <span class="code">RightsManagementClient</span> object’s <span class="code">getDocumentManager</span> method.</p></li> 
     <li><p>Remove a policy from the Word document by invoking the <span class="code">DocumentManager</span> object’s <span class="code">removeSecurity</span> method and passing the <span class="code">com.adobe.idp.Document</span> object that contains the policy-protected Word document. This method returns a <span class="code">com.adobe.idp.Document</span> object that contains an unsecured Word document.</p></li> 
    </ul></li> 
   <li><p>Save the unsecured Word document </p> 
    <ul> 
     <li><p>Create a <span class="code">java.io.File</span> object and ensure that the file extension is DOC.</p></li> 
     <li><p>Invoke the <span class="code">Document</span> object’s <span class="code">copyToFile</span> method to copy the contents of the <span class="code">Document</span> object to the file (ensure that you use the <span class="code">Document</span> object that was returned by the <span class="code">removeSecurity</span> method).</p></li> 
    </ul></li> 
  </ol> 
  <p><strong>Code examples</strong></p> 
  <p>For code examples using the Document Security service, see the following Quick Start in <i><a href="/programming-with-aem-forms/#java_api_soap_quick_start_code_examples">API Quick Starts (Code Examples)</a></i>:</p> 
  <ul> 
   <li><p>“Quick Start (SOAP mode): Removing a policy from a Word document using the Java API ”</p></li> 
  </ul> 
  <h3 id="remove_a_policy_from_a_word_document_using_the_web_service_api">Remove a policy from a Word document using the web service API</h3> 
  <p></p> 
  <p>Remove a policy from a policy-protected Word document by using the Document Security API (web service):</p> 
  <ol> 
   <li><p>Include project files </p><p>Create a Microsoft .NET project that uses MTOM. Ensure that you use the following WSDL definition: <span class="code">http://localhost:8080/soap/services/RightsManagementService?WSDL&amp;lc_version=9.0.1</span>. </p> 
    <note> 
     <p>Replace <span class="code">localhost</span> with the IP address of the server hosting AEM Forms. </p> 
    </note></li> 
   <li><p>Create a Document Security Client API object</p> 
    <ul> 
     <li><p>Create a <span class="code">RightsManagementServiceClient</span> object by using its default constructor. </p></li> 
     <li><p>Create a <span class="code">RightsManagementServiceClient.Endpoint.Address</span> object by using the <span class="code">System.ServiceModel.EndpointAddress</span> constructor. Pass a string value that specifies the WSDL to the AEM Forms service (for example, <span class="code">http://localhost:8080/soap/services/RightsManagementService?WSDL</span>.) You do not need to use the <span class="code">lc_version</span> attribute. This attribute is used when you create a service reference.) </p></li> 
     <li><p>Create a <span class="code">System.ServiceModel.BasicHttpBinding</span> object by getting the value of the <span class="code">RightsManagementServiceClient.Endpoint.Binding</span> field. Cast the return value to <span class="code">BasicHttpBinding</span>. </p></li> 
     <li><p>Set the <span class="code">System.ServiceModel.BasicHttpBinding</span> object’s <span class="code">MessageEncoding</span> field to <span class="code">WSMessageEncoding.Mtom</span>. This value ensures that MTOM is used. </p></li> 
     <li><p>Enable basic HTTP authentication by performing the following tasks:</p> 
      <ul> 
       <li><p>Assign the AEM forms user name to the field <span class="code">RightsManagementServiceClient.ClientCredentials.UserName.UserName</span>.</p></li> 
       <li><p>Assign the corresponding password value to the field <span class="code">RightsManagementServiceClient.ClientCredentials.UserName.Password</span>.</p></li> 
       <li><p>Assign the constant value <span class="code">HttpClientCredentialType.Basic</span> to the field <span class="code">BasicHttpBindingSecurity.Transport.ClientCredentialType</span>. </p></li> 
      </ul></li> 
     <li><p>Assign the constant value <span class="code">BasicHttpSecurityMode.TransportCredentialOnly</span> to the field <span class="code">BasicHttpBindingSecurity.Security.Mode</span>. </p></li> 
    </ul></li> 
   <li><p>Retrieve a policy-protected Word document</p> 
    <ul> 
     <li><p>Create a <span class="code">BLOB</span> object by using its constructor. The <span class="code">BLOB</span> object is used to store the policy-protected Word document from which the policy is removed.</p></li> 
     <li><p>Create a <span class="code">System.IO.FileStream</span> object by invoking its constructor and passing a string value that represents the file location of the Word document and the mode in which to open the file. </p></li> 
     <li><p>Create a byte array that stores the content of the <span class="code">System.IO.FileStream</span> object. You can determine the size of the byte array by getting the <span class="code">System.IO.FileStream</span> object’s <span class="code">Length</span> property. </p></li> 
     <li><p>Populate the byte array with stream data by invoking the <span class="code">System.IO.FileStream</span> object’s <span class="code">Read</span> method and passing the byte array, the starting position, and the stream length to read.</p></li> 
     <li><p>Populate the <span class="code">BLOB</span> object by assigning its <span class="code">MTOM</span> field with the contents of the byte array.</p></li> 
    </ul></li> 
   <li><p>Remove the policy from the Word document</p><p>Remove the policy from the Word document by invoking the <span class="code">RightsManagementServiceClient</span> object’s <span class="code">removePolicySecurity</span> method and passing the <span class="code">BLOB</span> object that contains the policy-protected Word document. This method returns a <span class="code">BLOB</span> object that contains an unsecured Word document.</p></li> 
   <li><p>Save the unsecured Word document</p> 
    <ul> 
     <li><p>Create a <span class="code">System.IO.FileStream</span> object by invoking its constructor and passing a string value that represents the file location of the unsecured Word document.</p></li> 
     <li><p>Create a byte array that stores the data content of the <span class="code">BLOB</span> object that was returned by the <span class="code">removePolicySecurity</span> method. Populate the byte array by getting the value of the <span class="code">BLOB</span> object’s <span class="code">MTOM</span> field.</p></li> 
     <li><p>Create a <span class="code">System.IO.BinaryWriter</span> object by invoking its constructor and passing the <span class="code">System.IO.FileStream</span> object.</p></li> 
    </ul></li> 
  </ol> 
  <p><strong>Code examples</strong></p> 
  <p>For code examples using the Document Security service, see the following Quick Start in <i><a href="/programming-with-aem-forms/#java_api_soap_quick_start_code_examples">API Quick Starts (Code Examples)</a></i>:</p> 
  <ul> 
   <li><p>“Quick Start (MTOM): Removing a policy from a Word document using the web service API”</p></li> 
  </ul> 
  <p><strong>See also</strong></p> 
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-web#invoking_aem_forms_using_mtom">Invoking AEM Forms using MTOM</a></p> 
  <related-links> 
   <a href="/programming-with-aem-forms/invoking-aem-forms-using-web#invoking_aem_forms_using_mtom">Invoking AEM Forms using MTOM</a> 
   <a href="/programming-with-aem-forms/invoking-aem-forms-using-web#invoking_aem_forms_using_swaref">Invoking AEM Forms using SwaRef</a> 
   <a href="http://www.adobe.com/go/learn_aemforms_pdrl_9">PDRL Reference</a> 
   <a href="/programming-with-aem-forms/invoking-aem-forms-using-java#including_aem_forms_java_library_files">Including AEM Forms Java library files</a> 
   <a href="/programming-with-aem-forms/invoking-aem-forms-using-java#setting_connection_properties">Setting connection properties</a> 
   <a href="/programming-with-aem-forms/invoking-aem-forms-using-java#including_aem_forms_java_library_files">Including AEM Forms Java library files</a> 
   <a href="/programming-with-aem-forms/invoking-aem-forms-using-java#setting_connection_properties">Setting connection properties</a> 
   <a href="/programming-with-aem-forms/invoking-aem-forms-using-web#invoking_aem_forms_using_mtom">Invoking AEM Forms using MTOM</a> 
   <a href="/programming-with-aem-forms/invoking-aem-forms-using-web#invoking_aem_forms_using_swaref">Invoking AEM Forms using SwaRef</a> 
  </related-links> 
 </body> 
</html>