<?xml version="1.1" encoding="UTF-8" standalone="yes"?>
<html>
 <head>
  <meta content="2017-07-12T07:03:00.000-0400" name="topicBrowsingSortDate" />
  <meta content="68fa4f66-8112-4a9c-97bb-15ac9d2aa179" name="jcr:predecessors" />
  <meta content="left" name="sideColumn" />
  <meta content="/apps/help/templates/article-3" name="cq:template" />
  <meta content="mix:versionable" name="jcr:mixinTypes" />
  <meta content="/etc/designs/help" name="cq:designPath" />
  <meta content="false" name="doNotLocalize" />
  <meta content="Activate" name="cq:lastReplicationAction" />
  <meta content="Converting PDF to Postscript and&amp;#xA;Image Files" name="navTitle" />
  <meta content="not_checked" name="acrolinxStatus" />
  <meta content="carlino" name="cq:lastModifiedBy" />
  <meta content="admin" name="lr_lastModifiedBy" />
  <meta content="2017-07-12T07:03:00.000-0400" name="sortDate" />
  <meta content="2017-11-21T06:57:28.016-0500" name="cq:lastModified" />
  <meta content="video" name="pageLayout" />
  <meta content="admin" name="lr_creator" />
  <meta content="content_type:reference;products:SG_EXPERIENCEMANAGER/6.4/FORMS;topic_tags:operations" name="cq:tags" />
  <meta content="en_us" name="jcr:language" />
  <meta content="" name="jcr:baseVersion" />
  <meta content="2017-10-03T06:47:08.276-0400" name="publishExternalDate" />
  <meta content="" name="jcr:primaryType" />
  <meta content="Converting PDF to Postscript andImage Files" name="jcr:title" />
  <meta content="help/components/pages/article-3" name="sling:resourceType" />
  <meta content="audience:developing" name="primaryAudienceTag" />
  <meta content="admin" name="contentOwner" />
  <meta content="" name="jcr:versionHistory" />
  <meta content="2017-10-03T06:47:08.276-0400" name="firstPublishExternalDate" />
  <meta content="khsingh@adobe.com" name="lr_lastReplicatedBy" />
  <meta content="https://helpx.adobe.com/aem-forms/6-3/developing/converting-pdf-postscript-image-files.html" name="publishExternalURL" />
  <meta content="4a6ca713-cf11-49dc-8423-eab5d8605cfe" name="jcr:uuid" />
  <meta content="products:SG_EXPERIENCEMANAGER/6.4/FORMS" name="primaryProductTag" />
  <meta content="head1_20111213" name="gep_conversion_script_version" />
  <meta content="2017-11-22T19:06:05.448-0500" name="jcr:created" />
  <meta content="AEMForms/6.1/ProgramLC/WS624e3cba99b79e123c61b3521336a3543b6-8000.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-7f2d.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12-79281f641336a354491-7fff.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-778d.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-778c.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-7f2a.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e124046477d1336a35456c-7fff.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-7773.2,AEMForms/6.1/ProgramLC/WS624e3cba99b79e12e69a9941333732bac8-7772.2" name="cq:gepId" />
  <meta content="2017-07-12T07:03:37.449-0400" name="lr_lastModified" />
  <meta content="carlino" name="cq:lastReplicatedBy" />
  <meta content="2018-04-03T08:17:11.676-0400" name="cq:lastReplicated" />
  <meta content="admin" name="jcr:createdBy" />
  <meta content="2017-10-03T06:47:08.276-0400" name="lastPublishExternalDate" />
  <meta content="true" name="jcr:isCheckedOut" />
  <meta content="light" name="heroGradient" />
 </head>
 <body>
  <p><strong>About the Convert PDF Service</strong></p>
  <p>The Convert PDF service converts PDF documents to PostScript and to a number of image formats (JPEG, JPEG 2000, PNG, and TIFF). Converting a PDF document to PostScript is useful for unattended server-based printing on any PostScript printer. Converting a PDF document to a multipage TIFF file is practical when archiving documents in content management systems that do not support PDF documents.</p>
  <p>You can accomplish these tasks using the Convert PDF service:</p>
  <ul>
   <li><p>Convert PDF documents to PostScript. </p></li>
   <li><p>Convert PDF documents to image formats. </p></li>
  </ul>
  <h2 id="converting_pdf_documents_to_postscript">Converting PDF Documents to PostScript</h2>
  <p></p>
  <p>This topic describes how you can use the Convert PDF Service API (Java and web service) to programmatically convert PDF documents to PostScript files. The PDF document that is converted to a PostScript file must be a non-interactive PDF document. That is, if you attempt to convert an interactive PDF document to a PostScript file, an exception is thrown.</p>
  <note>
   <p>For more information about the Convert PDF service, see <a href="http://www.adobe.com/go/learn_aemforms_services_63">Services Reference for AEM Forms</a>.</p>
  </note>
  <h3 id="summary_of_steps">Summary of steps</h3>
  <p></p>
  <p>To convert a PDF document to a PostScript file, perform the following steps:</p>
  <ol>
   <li><p>Include project files.</p></li>
   <li><p>Create a Convert PDF service client.</p></li>
   <li><p>Reference the PDF document to convert to a PostScript file.</p></li>
   <li><p>Set conversion run-time options.</p></li>
   <li><p>Convert the PDF document to a PostScript file.</p></li>
   <li><p>Save the PostScript file.</p></li>
  </ol>
  <p><strong>Include project files</strong></p>
  <p>Include the necessary files into your development project. If you are creating a client application by using Java, include the necessary JAR files. If you are using web services, make sure you include the proxy files.</p>
  <p><strong>Create a Convert PDF client</strong></p>
  <p>Before you can programmatically perform a Convert PDF service operation, you must create a Convert PDF service client. If you are using the Java API, create a <span class="code">ConvertPdfServiceClient</span> object. If you are using the web service API, create a <span class="code">ConvertPDFServiceService</span> object. </p>
  <p>This section uses web service functionality that is introduced in AEM Forms. To access new functionality, you have to construct your proxy object using the <span class="code">lc_version</span> attribute. (See “Accessing new functionality using web services” in <a href="/programming-with-aem-forms/invoking-aem-forms-using-web#invoking_aem_forms_using_web_services">Invoking AEM Forms using Web Services</a>.)</p>
  <p><strong>Reference the PDF document to convert to a PostScript file</strong></p>
  <p>Reference the PDF document that you want to convert to a PostScript file. As stated earlier in this topic, the PDF document must be a non-interactive PDF document. If you attempt to convert an interactive PDF document to a PostScript file, an exception is thrown.</p>
  <p><strong>Set conversion run-time options</strong></p>
  <p>When converting a PDF document to a PostScript file, you can define run-time options that specify the PostScript type that is created. For example, you can define a level 3 PostScript file. </p>
  <p>Typically, the generated PostScript file will reflect the size of input PDF document. If you select the <span class="code">ShrinkToFit</span> option (which shrinks the output of the PostScript file to fit the page), you will not see a difference between the input PDF document and the generated PostScript file. The <span class="code">ShrinkToFit</span> option takes effect only if you select to print on a smaller page size than the input PDF document. To select a smaller page size, define the <span class="code">PageSize</span> option. In addition, it is recommended that you set the <span class="code">RotateAndCenter</span> option to <span class="code">true</span> to obtain the correct PostScript output.</p>
  <p>Likewise, if you select the <span class="code">ExpandToFit</span> option (which expands the output of the PostScript file to fit the page), it takes effect only if you select to print on a larger page size than the input PDF document. To select a larger page size, define the <span class="code">PageSize</span> option. In addition, it is recommended that you set the <span class="code">RotateAndCenter</span> option to <span class="code">true</span> to obtain the correct PostScript output.</p>
  <note>
   <p>For information about the run-time values that you can set, see the <span class="code">ToPSOptionsSpec</span> class reference in <a href="http://www.adobe.com/go/learn_aemforms_javadocs_63_en">AEM Forms API Reference</a>.</p>
  </note>
  <p><strong>Convert the PDF document to a PostScript file</strong></p>
  <p>After you create the service client and set run-time options, you can invoke the PostScript conversion operation. This operation will need information about the document to convert, including the preferred PostScript level for the target document.</p>
  <p><strong>Save the PostScript file</strong></p>
  <p>After you convert the PDF document to PostScript, you can save the output as a PostScript file. </p>
  <p><strong>See also</strong></p>
  <p><a href="converting-pdf-postscript-image-files#convert_a_pdf_document_to_ps_using_the_java_api">Convert a PDF document to PS using the Java API</a></p>
  <p><a href="converting-pdf-postscript-image-files#convert_a_pdf_document_to_ps_using_the_web_service_api">Convert a PDF document to PS using the web service API</a></p>
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-java#including_aem_forms_java_library_files">Including AEM Forms Java library files</a></p>
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-java#setting_connection_properties">Setting connection properties</a></p>
  <p><a href="/programming-with-aem-forms/convert-pdf-service-java-api#convert_pdf_service_java_api_quick_start_soap">Convert PDF Service API Quick Starts</a></p>
  <h3 id="convert_a_pdf_document_to_ps_using_the_java_api">Convert a PDF document to PS using the Java API</h3>
  <p></p>
  <p>Convert a PDF document to PostScript by using the Convert PDF Service API (Java):</p>
  <ol>
   <li><p>Include project files. </p><p>Include client JAR files, such as adobe-convertpdf-client.jar, in your Java project’s class path. </p></li>
   <li><p>Create a Convert PDF client. </p>
    <ul>
     <li><p>Create a <span class="code">ServiceClientFactory</span> object that contains connection properties. </p></li>
     <li><p>Create a <span class="code">ConvertPdfServiceClient</span> object by using its constructor and passing the <span class="code">ServiceClientFactory</span> object.</p></li>
    </ul></li>
   <li><p>Reference the PDF document to convert to a PostScript file. </p>
    <ul>
     <li><p>Create a <span class="code">java.io.FileInputStream</span> object by using its constructor and pass a string value that specifies the location of the PDF document to convert.</p></li>
     <li><p>Create a <span class="code">com.adobe.idp.Document</span> object that stores the PDF document by using the <span class="code">com.adobe.idp.Document</span> constructor. Pass the <span class="code">java.io.FileInputStream</span> object that contains the PDF document.</p></li>
    </ul></li>
   <li><p>Set conversion run-time options. </p>
    <ul>
     <li><p>Create a <span class="code">ToPSOptionsSpec</span> object by invoking its constructor.</p></li>
     <li><p>Set run-time options by invoking an appropriate method that belongs to the <span class="code">ToPSOptionsSpec</span> object. For example, to define the PostScript level that is created, invoke the <span class="code">ToPSOptionsSpec</span> object’s <span class="code">setPsLevel</span> method and pass a <span class="code">PSLevel</span> enumeration value that specifies the PostScript level. For information about all run-time values that you can set, see the <span class="code">ToPSOptionsSpec</span> class reference in <a href="http://www.adobe.com/go/learn_aemforms_javadocs_63_en">AEM Forms API Reference</a>. </p></li>
    </ul></li>
   <li><p>Convert the PDF document to a PostScript file. </p><p>Invoke the <span class="code">ConvertPdfServiceClient </span>object’s <span class="code">toPS2</span> method and pass the following values:</p>
    <ul>
     <li><p>A <span class="code">com.adobe.idp.Document</span> object that represents the PDF document to convert to a PostScript file. </p></li>
     <li><p>A <span class="code">ToPSOptionsSpec</span> object that specifies PostScript run-time options.</p></li>
    </ul><p>The <span class="code">toPS2</span> method returns a <span class="code">Document</span> object that contains the new PostScript document. </p></li>
   <li><p>Save the PostScript file. </p>
    <ul>
     <li><p>Create a <span class="code">java.io.File</span> object and ensure that the file name extension is .ps.</p></li>
     <li><p>Invoke the <span class="code">Document</span> object’s <span class="code">copyToFile</span> method to copy the contents of the <span class="code">Document</span> object to the file (ensure that you use the <span class="code">Document</span> object that was returned by the <span class="code">toPS2</span> method).</p></li>
    </ul></li>
  </ol>
  <p><strong>See also</strong></p>
  <p><a href="converting-pdf-postscript-image-files#summary_of_steps">Summary of steps</a></p>
  <p><a href="/programming-with-aem-forms/convert-pdf-service-java-api#quick_start_soap_mode_converting_a_pdf_document_to_postscript_using_the_java_api">Quick Start (SOAP mode): Converting a PDF document to PostScript using the Java API</a></p>
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-java#including_aem_forms_java_library_files">Including AEM Forms Java library files</a></p>
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-java#setting_connection_properties">Setting connection properties</a></p>
  <h3 id="convert_a_pdf_document_to_ps_using_the_web_service_api">Convert a PDF document to PS using the web service API</h3>
  <p></p>
  <p>Convert a PDF document to PostScript by using the Convert PDF Service API (web service): </p>
  <ol>
   <li><p>Include project files. </p><p>Create a Microsoft .NET project that uses MTOM. Ensure that you use the following WSDL definition: <span class="code">http://localhost:8080/soap/services/ConvertPDFService?WSDL&amp;lc_version=9.0.1</span>. </p>
    <note>
     <p>Replace <span class="code">localhost</span> with the IP address of the server hosting AEM Forms. </p>
    </note></li>
   <li><p>Create a Convert PDF client. </p>
    <ul>
     <li><p>Create a <span class="code">ConvertPdfServiceClient</span> object by using its default constructor. </p></li>
     <li><p>Create a <span class="code">ConvertPdfServiceClient.Endpoint.Address</span> object by using the <span class="code">System.ServiceModel.EndpointAddress</span> constructor. Pass a string value that specifies the WSDL to the AEM Forms service (for example, <span class="code">http://localhost:8080/soap/services/ConvertPDFService?blob=mtom</span>.) You do not need to use the <span class="code">lc_version</span> attribute. However, specify <span class="code">?blob=mtom</span>. </p></li>
     <li><p>Create a <span class="code">System.ServiceModel.BasicHttpBinding</span> object by getting the value of the <span class="code">ConvertPdfServiceClient.Endpoint.Binding</span> field. Cast the return value to <span class="code">BasicHttpBinding</span>. </p></li>
     <li><p>Set the <span class="code">System.ServiceModel.BasicHttpBinding</span> object’s <span class="code">MessageEncoding</span> field to <span class="code">WSMessageEncoding.Mtom</span>. This value ensures that MTOM is used. </p></li>
     <li><p>Enable basic HTTP authentication by performing the following tasks:</p>
      <ul>
       <li><p>Assign the AEM forms user name to the field <span class="code">ConvertPdfServiceClient.ClientCredentials.UserName.UserName</span>.</p></li>
       <li><p>Assign the corresponding password value to the field <span class="code">ConvertPdfServiceClient.ClientCredentials.UserName.Password</span>.</p></li>
       <li><p>Assign the constant value <span class="code">HttpClientCredentialType.Basic</span> to the field <span class="code">BasicHttpBindingSecurity.Transport.ClientCredentialType</span>. </p></li>
       <li><p>Assign the constant value <span class="code">BasicHttpSecurityMode.TransportCredentialOnly</span> to the field <span class="code">BasicHttpBindingSecurity.Security.Mode</span>. </p></li>
      </ul></li>
    </ul></li>
   <li><p>Reference the PDF document to convert to a PostScript file. </p>
    <ul>
     <li><p>Create a <span class="code">BLOB</span> object by using its constructor. The <span class="code">BLOB</span> object is used to store a PDF document that is converted to a PostScript file.</p></li>
     <li><p>Create a <span class="code">System.IO.FileStream</span> object by invoking its constructor and passing a string value that represents the file location of the PDF document to convert and the mode to open the file in.</p></li>
     <li><p>Create a byte array that stores the content of the <span class="code">System.IO.FileStream</span> object. You can determine the size of the byte array by getting the <span class="code">System.IO.FileStream</span> object’s <span class="code">Length</span> property. </p></li>
     <li><p>Populate the byte array with stream data by invoking the <span class="code">System.IO.FileStream</span> object’s <span class="code">Read</span> method and passing the byte array, starting position, and stream length to read.</p></li>
     <li><p>Populate the <span class="code">BLOB</span> object by assigning its <span class="code">MTOM</span> field with the contents of the byte array.</p></li>
    </ul></li>
   <li><p>Set conversion run-time options. </p>
    <ul>
     <li><p>Create a <span class="code">ToPSOptionsSpec</span> object by invoking its constructor.</p></li>
     <li><p>Set run-time options by assigning a value to the <span class="code">ToPSOptionsSpec</span> object’s data member. For example, to define the PostScript level that is created, assign a <span class="code">PSLevel</span> enumeration value to the <span class="code">ToPSOptionsSpec</span> object’s <span class="code">psLevel</span> data member.</p></li>
    </ul></li>
   <li><p>Convert the PDF document to a PostScript file. </p><p>Invoke the <span class="code">GeneratePDFServiceService</span> object’s <span class="code">toPS2</span> method and pass the following values:</p>
    <ul>
     <li><p>A <span class="code">BLOB</span> object that represents the PDF document to convert to a PostScript file</p></li>
     <li><p>A <span class="code">ToPSOptionsSpec</span> object that specifies run-time options</p></li>
    </ul><p>After the conversion is complete, extract the binary data that represents the PostScript document by accessing its <span class="code">BLOB</span> object’s <span class="code">MTOM</span> property. This returns a byte array that you can write out to a PostScript file. </p></li>
   <li><p>Save the PostScript file. </p>
    <ul>
     <li><p>Create a <span class="code">System.IO.FileStream</span> object by invoking its constructor. Pass a string value that represents the file location of the PS file.</p></li>
     <li><p>Create a byte array that stores the data content of the <span class="code">BLOB</span> object that was returned by the <span class="code">encryptPDFUsingPassword</span> method. Populate the byte array by getting the value of the <span class="code">BLOB</span> object’s <span class="code">MTOM</span> field.</p></li>
     <li><p>Create a <span class="code">System.IO.BinaryWriter</span> object by invoking its constructor and passing the <span class="code">System.IO.FileStream</span> object.</p></li>
     <li><p>Write the contents of the byte array to the PostScript file by invoking the <span class="code">System.IO.BinaryWriter</span> object’s <span class="code">Write</span> method and passing the byte array.</p></li>
    </ul></li>
  </ol>
  <p><strong>See also</strong></p>
  <p><a href="converting-pdf-postscript-image-files#summary_of_steps">Summary of steps</a></p>
  <p><a href="#unresolvedlink-lc-qs-convert-pdf-cp.xml#ws624e3cba99b79e12e69a9941333732bac8-7f2b.2">Quick Start (MTOM): Converting a PDF document to PostScript using the web service API</a></p>
  <p><a href="#unresolvedlink-lc-qs-convert-pdf-cp.xml#ws624e3cba99b79e12e69a9941333732bac8-7f1e.2">Quick Start (SwaRef): Converting a PDF document to PostScript using the web service API</a></p>
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-web#invoking_aem_forms_using_mtom">Invoking AEM Forms using MTOM</a></p>
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-web#invoking_aem_forms_using_swaref">Invoking AEM Forms using SwaRef</a></p>
  <p><strong></strong></p>
  <h2 id="converting_pdf_documents_to_image_formats">Converting PDF Documents to Image Formats</h2>
  <p></p>
  <p>You can use the Convert PDF service to programmatically convert PDF documents to image formats, which include JPEG, JPEG 2000, TIFF, and PNG. By converting a PDF document to an image file, you can use the PDF document as an image file. For example, you can place the image in an enterprise content management system for storage.</p>
  <p>When converting a PDF document to an image, the Convert PDF service creates a separate image for each page in the document. That is, if the document has 20 pages, the Convert PDF service creates 20 image files. When converting a PDF document to an image format, you can create individual images for each page within the PDF document or a single image file for the entire PDF document.</p>
  <note>
   <p>For more information about the Convert PDF service, see <a href="http://www.adobe.com/go/learn_aemforms_services_63">Services Reference for AEM Forms</a>.</p>
  </note>
  <h3 id="summary_of_steps">Summary of steps</h3>
  <p></p>
  <p>To convert a PDF document to any of the supported types, perform the following steps:</p>
  <ol>
   <li><p>Include project files.</p></li>
   <li><p>Create a Convert PDF service client.</p></li>
   <li><p>Retrieve the PDF document to convert.</p></li>
   <li><p>Set run-time options.</p></li>
   <li><p>Convert the PDF to an image.</p></li>
   <li><p>Retrieve the image files from a collection.</p></li>
  </ol>
  <p><strong>Include project files</strong></p>
  <p>Include the necessary files into your development project. If you are creating a client application by using Java, include the necessary JAR files. If you are using web services, make sure you include the proxy files.</p>
  <p><strong>Create a Convert PDF client</strong></p>
  <p>Before you can programmatically perform a Convert PDF service operation, you must create a Convert PDF service client. If you are using the Java API, create a <span class="code">ConvertPdfServiceClient</span> object. If you are using the web service API, create a <span class="code">ConvertPDFServiceService</span> object.</p>
  <p><strong>Retrieve the PDF document to convert</strong></p>
  <p>You must retrieve the PDF document to convert to an image. You cannot convert an interactive PDF document to an image. If you attempt to do so, an exception is thrown. To convert an interactive PDF document to an image file, you must flatten the PDF document before you convert it. (See <a href="/programming-with-aem-forms/creating-document-output-streams#flattening_pdf_documents">Flattening PDF Documents</a>.)</p>
  <p><strong>Set run-time options</strong></p>
  <p>You must set run-time options such as the image format and the resolution values. For information about the run-time values, see the <span class="code">ToImageOptionsSpec</span> class reference in <a href="http://www.adobe.com/go/learn_aemforms_javadocs_63_en">AEM Forms API Reference</a>.</p>
  <p><strong>Convert the PDF to an image </strong></p>
  <p>After you create the service client and set run-time options, you can convert the PDF document to an image. A collection object that contains the images is returned. </p>
  <p><strong>Retrieve the image files from a collection</strong></p>
  <p>You can retrieve image files from a collection object that the Convert PDF service returns. Each element in the collection is a <span class="code">com.adobe.idp.Document</span> instance (or a <span class="code">BLOB</span> instance if you are using web services) that you can save as an image file, such as a JPG file. </p>
  <p>The format of the image file is dependent on the <span class="code">ImageConvertFormat</span> run-time option. That is, if you set the <span class="code">ImageConvertFormat</span> run-time option to <span class="code">ImageConvertFormat.JPEG</span>, you can save image files as JPG files. </p>
  <p><strong>See also</strong></p>
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-java#including_aem_forms_java_library_files">Including AEM Forms Java library files</a></p>
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-java#setting_connection_properties">Setting connection properties</a></p>
  <p><a href="/programming-with-aem-forms/convert-pdf-service-java-api#convert_pdf_service_java_api_quick_start_soap">Convert PDF Service API Quick Starts</a></p>
  <h3 id="convert_a_pdf_document_to_image_files_using_the_java_api">Convert a PDF document to image files using the Java API</h3>
  <p></p>
  <p>Convert a PDF document to an image format by using the Convert PDF service API (Java):</p>
  <ol>
   <li><p>Include project files. </p><p>Include client JAR files, such as adobe-convertpdf-client.jar, in your Java project’s class path.</p></li>
   <li><p>Create a Convert PDF client. </p>
    <ul>
     <li><p>Create a <span class="code">ServiceClientFactory</span> object that contains connection properties. </p></li>
     <li><p>Create a <span class="code">ConvertPdfServiceClient</span> object by using its constructor and passing the <span class="code">ServiceClientFactory</span> object.</p></li>
    </ul></li>
   <li><p>Retrieve the PDF document to convert. </p>
    <ul>
     <li><p>Create a <span class="code">java.io.FileInputStream</span> object that represents the PDF document to convert by using its constructor and passing a string value that specifies the location of the PDF document.</p></li>
     <li><p>Create a <span class="code">com.adobe.idp.Document</span> object by using its constructor and passing the <span class="code">java.io.FileInputStream</span> object.</p></li>
    </ul></li>
   <li><p>Set run-time options. </p>
    <ul>
     <li><p>Create a <span class="code">ToImageOptionsSpec</span> object by using its constructor.</p></li>
     <li><p>Invoke methods that belong to this object as required. For example, set the image type by invoking the <span class="code">setImageConvertFormat</span> method and passing an <span class="code">ImageConvertFormat</span> enum value that specifies the format type. </p></li>
    </ul>
    <note>
     <p>Setting the <span class="code">ImageConvertFormat</span> enumeration value is mandatory.</p>
    </note></li>
   <li><p>Convert the PDF to an image. </p><p>Invoke the <span class="code">ConvertPdfServiceClient</span> object’s <span class="code">toImage2</span> method and pass the following values:</p>
    <ul>
     <li><p>A <span class="code">com.adobe.idp.Document</span> object that represents the PDF file to convert.</p></li>
     <li><p>A <span class="code">com.adobe.livecycle.converpdfservice.client.ToImageOptionsSpec</span> object that contains the various preferences about the target image format.</p></li>
    </ul><p>The <span class="code">toImage2</span> method returns a <span class="code">java.util.List</span> object that contains images. Each element in the collection is a <span class="code">com.adobe.idp.Document</span> instance.</p></li>
   <li><p>Retrieve the image files from a collection. </p><p>Iterate through the <span class="code">java.util.List</span> object to determine whether images are present. Each element is a <span class="code">com.adobe.idp.Document</span> instance. Save the image by invoking the <span class="code">com.adobe.idp.Document</span> object’s <span class="code">copyToFile</span> method and passing a <span class="code">java.io.File</span> object.</p></li>
  </ol>
  <p><strong>See also</strong></p>
  <p><a href="/programming-with-aem-forms/convert-pdf-service-java-api#quick_start_soap_mode_converting_a_pdf_document_to_jpeg_files_using_the_java_api">Quick Start (SOAP mode): Converting a PDF document to JPEG files using the Java API</a></p>
  <h3 id="convert_a_pdf_document_to_image_files_using_the_web_service_api">Convert a PDF document to image files using the web service API</h3>
  <p></p>
  <p>Convert a PDF document to an image format by using the Convert PDF Service API (web service): </p>
  <ol>
   <li><p>Include project files. </p><p>Create a Microsoft .NET project that uses MTOM. Ensure that you use the following WSDL definition: <span class="code">http://localhost:8080/soap/services/ConvertPDFService?WSDL&amp;lc_version=9.0.1</span>. </p>
    <note>
     <p>Replace <span class="code">localhost</span> with the IP address of the server hosting AEM Forms. </p>
    </note></li>
   <li><p>Create a convert PDF client. </p>
    <ul>
     <li><p>Create a <span class="code">ConvertPdfServiceClient</span> object by using its default constructor. </p></li>
     <li><p>Create a <span class="code">ConvertPdfServiceClient.Endpoint.Address</span> object by using the <span class="code">System.ServiceModel.EndpointAddress</span> constructor. Pass a string value that specifies the WSDL to the AEM Forms service (for example, <span class="code">http://localhost:8080/soap/services/ConvertPDFService?blob=mtom</span>.) You do not need to use the <span class="code">lc_version</span> attribute. However, specify <span class="code">?blob=mtom</span>. </p></li>
     <li><p>Create a <span class="code">System.ServiceModel.BasicHttpBinding</span> object by getting the value of the <span class="code">ConvertPdfServiceClient.Endpoint.Binding</span> field. Cast the return value to <span class="code">BasicHttpBinding</span>. </p></li>
     <li><p>Set the <span class="code">System.ServiceModel.BasicHttpBinding</span> object’s <span class="code">MessageEncoding</span> field to <span class="code">WSMessageEncoding.Mtom</span>. This value ensures that MTOM is used. </p></li>
     <li><p>Enable basic HTTP authentication by performing the following tasks:</p>
      <ul>
       <li><p>Assign the AEM forms user name to the field <span class="code">ConvertPdfServiceClient.ClientCredentials.UserName.UserName</span>.</p></li>
       <li><p>Assign the corresponding password value to the field <span class="code">ConvertPdfServiceClient.ClientCredentials.UserName.Password</span>.</p></li>
       <li><p>Assign the constant value <span class="code">HttpClientCredentialType.Basic</span> to the field <span class="code">BasicHttpBindingSecurity.Transport.ClientCredentialType</span>. </p></li>
       <li><p>Assign the constant value <span class="code">BasicHttpSecurityMode.TransportCredentialOnly</span> to the field <span class="code">BasicHttpBindingSecurity.Security.Mode</span>. </p></li>
      </ul></li>
    </ul></li>
   <li><p>Retrieve the PDF document to convert. </p>
    <ul>
     <li><p>Create a <span class="code">BLOB</span> object by using its constructor. This <span class="code">BLOB</span> object is used to store the PDF form.</p></li>
     <li><p>Create a <span class="code">System.IO.FileStream</span> object by invoking its constructor. Pass a string value that specifies the location of the PDF form and the mode to open the file in.</p></li>
     <li><p>Create a byte array that stores the content of the <span class="code">System.IO.FileStream</span> object. Determine the size of the byte array by getting the <span class="code">System.IO.FileStream</span> object’s <span class="code">Length</span> property. </p></li>
     <li><p>Populate the byte array with stream data by invoking the <span class="code">System.IO.FileStream</span> object’s <span class="code">Read</span> method. Pass the byte array, the starting position, and the stream length to read.</p></li>
     <li><p>Populate the <span class="code">BLOB</span> object by assigning its <span class="code">MTOM</span> field with the contents of the byte array.</p></li>
    </ul></li>
   <li><p>Set run-time options. </p>
    <ul>
     <li><p>Create a <span class="code">ToImageOptionsSpec</span> object by using its constructor.</p></li>
     <li><p>Invoke methods that belong to this object as required. For example, set the image type by invoking the <span class="code">setImageConvertFormat</span> method and passing an <span class="code">ImageConvertFormat</span> enumeration value that specifies the format type.</p></li>
    </ul>
    <note>
     <p>Setting the <span class="code">ImageConvertFormat</span> enumeration value is mandatory.</p>
    </note></li>
   <li><p>Convert the PDF to an image. </p><p>Invoke the <span class="code">ConvertPDFServiceService</span> object’s <span class="code">toImage2</span> method and pass the following values:</p>
    <ul>
     <li><p>A <span class="code">BLOB</span> object that represents the file to be converted</p></li>
     <li><p>A <span class="code">ToImageOptionsSpec</span> object that contains the various preferences about the target image format</p></li>
    </ul><p>The <span class="code">toImage2</span> method returns a <span class="code">MyArrayOfBLOB</span> object that contains the newly created image files. </p></li>
   <li><p>Retrieve the image files from a collection. </p>
    <ul>
     <li><p>Determine the number of elements in the <span class="code">MyArrayOfBLOB</span> object by getting the value of its <span class="code">Count</span> field. Each element is a <span class="code">BLOB</span> object that contains the image. </p></li>
     <li><p>Iterate through the <span class="code">MyArrayOfBLOB</span> object and save each image file. </p></li>
    </ul></li>
  </ol>
  <p><strong>See also</strong></p>
  <p><a href="#unresolvedlink-lc-qs-convert-pdf-cp.xml#ws624e3cba99b79e12e69a9941333732bac8-7f28.2">Quick Start (MTOM): Converting a PDF document to a set of JPEG files using the web service API</a></p>
  <p><a href="#unresolvedlink-lc-qs-convert-pdf-cp.xml#ws624e3cba99b79e12e69a9941333732bac8-7f1a.2">Quick Start (SwaRef): Converting a PDF document to a set of JPEG files using the web service API</a></p>
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-web#invoking_aem_forms_using_mtom">Invoking AEM Forms using MTOM</a></p>
  <p><a href="/programming-with-aem-forms/invoking-aem-forms-using-web#invoking_aem_forms_using_swaref">Invoking AEM Forms using SwaRef</a></p>
 </body>
</html>