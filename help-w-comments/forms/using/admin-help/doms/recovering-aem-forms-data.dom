<?xml version="1.1" encoding="UTF-8" standalone="yes"?>
<html>
 <head>
  <meta content="" name="jcr:versionHistory" />
  <meta content="2016-02-05T03:27:00.000-0500" name="topicBrowsingSortDate" />
  <meta content="Activate" name="cq:lastReplicationAction" />
  <meta content="admin" name="lr_lastModifiedBy" />
  <meta content="red" name="acrolinxPageStatus" />
  <meta content="2016-02-05T03:27:00.000-0500" name="sortDate" />
  <meta content="admin" name="lr_creator" />
  <meta content="59" name="acrolinxSentences" />
  <meta content="2016-05-31T07:02:49.314-0400" name="acrolinxDate" />
  <meta content="2016-04-20T10:07:48.596-0400" name="firstPublishExternalDate" />
  <meta content="admin" name="jcr:createdBy" />
  <meta content="vishgupt" name="acrolinxLastCheckedBy" />
  <meta content="en_us" name="jcr:language" />
  <meta content="video" name="pageLayout" />
  <meta content="true" name="jcr:isCheckedOut" />
  <meta content="false" name="isReadyForLocalization" />
  <meta content="https://helpx.adobe.com/experience-manager/6-3/forms/using/admin-help/recovering-aem-forms-data.html" name="publishExternalURL" />
  <meta content="admin" name="contentOwner" />
  <meta content="2018-04-03T09:10:30.574-0400" name="cq:lastReplicated" />
  <meta content="Recovering the AEM forms data" name="jcr:title" />
  <meta content="" name="jcr:baseVersion" />
  <meta content="Recovering the AEM forms data" name="navTitle" />
  <meta content="" name="jcr:primaryType" />
  <meta content="2018-01-18T11:24:27.603-0500" name="publishExternalDate" />
  <meta content="head1_20111213" name="gep_conversion_script_version" />
  <meta content="2018-04-26T04:22:54.611-0400" name="locHandOffDate" />
  <meta content="false" name="doNotLocalize" />
  <meta content="2018-01-19T19:05:26.495-0500" name="jcr:created" />
  <meta content="content_type:reference;geptopics:SG_AEMFORMS/categories/aem_forms_backup_and_recovery;products:SG_EXPERIENCEMANAGER/6.4/FORMS" name="cq:tags" />
  <meta content="/content/help/en/experience-manager/6-4/forms/morehelp/aem_forms_backup_and_recovery;/content/help/en/experience-manager/6-4/forms/morehelp/aem_forms_backup_and_recovery" name="moreHelpPaths" />
  <meta content="help/components/pages/article-3" name="sling:resourceType" />
  <meta content="2016-02-05T03:27:29.842-0500" name="lr_lastModified" />
  <meta content="AEMForms/6.1/AdminHelp/WS92d06802c76abadb-5145d5d12905ce07e7-7c74.2,AEMForms/6.1/AdminHelp/WS92d06802c76abadb-1b40940a12905ce0596-7fec.2,AEMForms/6.1/AdminHelp/WS92d06802c76abadb-5145d5d12905ce07e7-7c7f.2,AEMForms/6.1/AdminHelp/WS92d06802c76abadb-1b40940a12905ce0596-7fe6.2" name="cq:gepId" />
  <meta content="This document describes the steps required to recover the AEM forms data." name="seoDescription" />
  <meta content="carlino" name="cq:lastReplicatedBy" />
  <meta content="1171" name="acrolinxWords" />
  <meta content="70c5e70d-6b40-444d-b098-e3a2dad62d6a" name="jcr:uuid" />
  <meta content="/apps/help/templates/article-3" name="cq:template" />
  <meta content="light" name="heroGradient" />
  <meta content="products:SG_EXPERIENCEMANAGER/6.4/FORMS" name="primaryProductTag" />
  <meta content="mix:versionable" name="jcr:mixinTypes" />
  <meta content="http://checkstyle.corp.adobe.com:8031/output/en/recovering_aem_forms_data_admin_5e12de0b318c6865_2357_report.xml" name="acrolinxReportURL" />
  <meta content="2018-01-18T11:24:27.603-0500" name="lastPublishExternalDate" />
  <meta content="not_checked" name="acrolinxStatus" />
  <meta content="carlino@adobe.com" name="lr_lastReplicatedBy" />
  <meta content="6b80e669-8966-4f78-b936-887a7c312ee4" name="jcr:predecessors" />
  <meta content="/etc/designs/help" name="cq:designPath" />
  <meta content="msm-service" name="cq:lastModifiedBy" />
  <meta content="2018-04-26T04:22:54.612-0400" name="cq:lastModified" />
  <meta content="left" name="sideColumn" />
 </head>
 <body>
  <p>This section describes the steps required to recover the AEM forms data. Also see <a href="../../../forms/using/admin-help/backup-recovery-strategy-aem-forms.md#special-considerations-for-backup-and-recovery">Special considerations for backup and recovery</a>.</p>
  <draft-comment lastModifiedBy="" prevFirstName="unknown" prevLastName="unknown" type="remark">
   <p>Bug 1675335:</p>
  </draft-comment>
  <note>
   <p>The database, GDS, AEM repository, and Content Storage Root directories must be restored to a computer with the same DNS name as the original.</p>
  </note>
  <p>AEM forms should recover reliably from the following failures: </p>
  <p><strong>Disk Failure: </strong>The latest backup media is required to recover the database content.</p>
  <p><strong>Data Corruption: </strong>File systems do not record past transactions, and systems may accidentally overwrite required process data.</p>
  <p><strong>User Error: </strong>Recovery is limited to the data that is made available by the database. If the data was stored and is available, recovery is simplified.</p>
  <p><strong>Power Outage, System Crash: </strong>File system APIs are often not designed or used in a robust manner that guards against unexpected system failures. If a power outage or system crash occurs, document content that is stored in the database is more likely to be up to date than content that is stored on a file system.</p>
  <p>If you are using rolling backup mode, you are still in backup mode after recovery. If you are using snapshot backup mode, you are not in backup mode after recovery.</p>
  <p>When restoring from backup to a new system, the following configurations may be different. This difference should not affect a successful recovery of the AEM forms application:</p>
  <ul>
   <li><p>IP address</p></li>
   <li><p>Physical system configuration (CPUs, disk, memory)</p></li>
   <li><p>GDS location</p></li>
  </ul>
  <note>
   <p>The backup of the Content Storage Root directory must be restored to the location of that directory as it was set during Content Services configuration.</p>
  </note>
  <p>If a single node of a multinode cluster failed and the remaining nodes of the cluster are operating properly, perform the cluster single-node recovery procedure. </p>
  <h2 id="recover_the_aem_forms_data">Recover the AEM forms data</h2>
  <p></p>
  <ol>
   <li><p>Stop the AEM forms services and application server if running. </p></li>
   <li><p>If necessary, re-create the physical system from a system image. For example, this step may not be necessary if the reason for recovery is a faulty database server.</p></li>
   <li><p>Apply patches or updates to AEM forms that were applied since the image was made. This information was recorded in the backup procedure. AEM forms must be patched to the same patch level as it was when the system was backed up.</p></li>
   <li><p>(WebSphere Application Server) If you are recovering to a new instance of WebSphere Application Server, run the restoreConfig.bat/sh command.</p></li>
   <li><p>Recover the AEM forms database by first running a database restore operation using the database backup files and then applying the transaction redo logs to the recovered database. (See <a href="../../../forms/using/admin-help/files-back-recover.md#aem-forms-database">AEM forms database</a>.) For more information, see one of these knowledge base articles:</p>
    <ul>
     <li></li>
     <li></li>
     <li></li>
     <li></li>
    </ul></li>
   <li><p>Recover the GDS directory by first deleting the contents of the GDS directory on the existing installation of AEM forms and then copying the contents of the GDS directory from the backed-up GDS. If you changed the GDS directory location, see <a href="recovering-aem-forms-data#changing_the_gds_location_during_recovery">Changing the GDS location during recovery</a>.</p></li>
   <li><p>Rename the GDS backup directory to be restored as shown in these examples:</p>
    <note>
     <p>If the /restore directory already exists, back it up and then delete it before you rename the /backup directory that contains the latest data.</p>
    </note>
    <ul>
     <li><p>(JBoss) Rename <i>[appserver root]</i>/server/<i>[server]</i>/svcnative/DocumentStorage/backup to:</p><p><i>[appserver root]</i>/server/<i>[server]</i>/svcnative/DocumentStorage/restore.</p></li>
     <li><p>(WebLogic) Rename <i>[appserverdomain]</i>/<i>[server]</i>/adobe/AEMformsserver/DocumentStorage/backup to:</p><p><i>[appserverdomain]</i>/<i>[server]</i>/adobe/AEMformsserver/DocumentStorage/restore.</p></li>
     <li><p>(WebSphere) Rename <i>[appserver root]</i>/installedApps/adobe/<i>[server]</i>/DocumentStorage/backup to:</p><p><i>[appserver root]</i>/installedApps/adobe/<i>[server]</i>/DocumentStorage/restore.</p></li>
    </ul>
    <draft-comment lastModifiedBy="" prevFirstName="unknown" prevLastName="unknown" type="remark">
     <p>Check paths in bullets above</p>
    </draft-comment></li>
   <li><p>Recover the Content Storage Root directory by first deleting the contents of the Content Storage Root directory on the existing installation of AEM forms and then recovering the contents by following the tasks for either stand-alone or clustered environments:</p>
    <note>
     <p>The backup of the Content Storage Root directory must be restored to the location of the Content Storage Root directory as it was set during Content Services (Deprecated) configuration.</p>
    </note><p><strong>Standalone: </strong>During the recovery process, restore all the directories that were backed up. When these directories are restored, if the /backup-lucene-indexes directory is present, rename it to /lucene-indexes. Otherwise, the lucene-indexes directory should already exist and no action is required.</p><p><strong>Clustered: </strong>During the recovery process, restore all the directories that were backed up. To restore the Index Root directory, perform the following steps on each node of the cluster:</p>
    <ul>
     <li><p>Delete all content in the Index Root directory.</p></li>
     <li><p>If the /backup-lucene-indexes directory is present, copy the contents of the <i>Content Storage Root directory</i>/backup-lucene-indexes directory to the Index Root directory and delete the <i>Content Storage Root directory</i>/backup-lucene-indexes directory.</p></li>
     <li><p>If the /lucene-indexes directory is present, copy the contents of the <i>Content Storage Root directory</i>/lucene-indexes directory to the Index Root directory.</p></li>
    </ul></li>
   <li><p>Restore/recover the CRX-repository.</p>
    <ul>
     <li><p><i>Restore author and publish instances</i>: If a disaster occurs, you can restore the repository to the last backed up state by performing the steps described in <a href="http://docs.adobe.com/docs/en/crx/current/administering/backup_and_restore.html">Backup and Restore. </a></p><p>The complete restoration of Author node ascertains the restoration of Forms Manager and AEM Forms Workspace data as well.</p></li>
     <li><p>For restoration in a clustered environment, see <a href="../../../forms/using/admin-help/strategy-backup-restore-clustered-environment.md#strategy-for-backup-and-restore-in-a-clustered-environment">Strategy for backup and restore in a clustered environment</a>.</p></li>
    </ul></li>
   <li><p>Delete any AEM forms temporary files that were created in the java.io.temp directory or in the Adobe temp directory.</p></li>
   <li><p>Start AEM forms (see <a href="../../../forms/using/admin-help/starting-stopping-services.md#starting-and-stopping-services">Starting and stopping services</a>) and the application server(s) (see <a href="/forms/using/admin-help/topics/maintaining-the-application-server" target="_blank">Maintaining the Application Server</a>).</p> </li>
  </ol>
  <h2 id="changing_the_gds_location_during_recovery">Changing the GDS location during recovery</h2>
  <p></p>
  <p>If your GDS is restored to a location other than where it was originally, run the LCSetGDS script to set the GDS to the new location. The script is in the <span class="code">[<i>aem-forms root]</i>\sdk\misc\Foundation\SetGDSCommandline</span> folder. The script takes two parameters, <span class="code">defaultGDS</span> and <span class="code">newGDS</span>. See the <span class="code">ReadMe.txt</span> file in the same folder for instructions on how to run the script.</p>
  <note>
   <p>If you had enabled document storage in database, you don’t need to change the GDS location.</p>
  </note>
  <note>
   <p>This circumstance is the only one under which you should use this script to change the GDS location. To change the GDS location while AEM forms is running, use Administration Console. (See <a href="../../../forms/using/admin-help/configure-general-aem-forms-settings.md#configure-general-aem-forms-settings">Configure general AEM forms settings</a><i>.) </i></p>
  </note>
  <draft-comment lastModifiedBy="" prevFirstName="unknown" prevLastName="unknown" type="remark">
   <p>Bug 1851233:</p>
  </draft-comment>
  <note>
   <p>Component deployment will fail on Windows if the GDS directory is at the drive root (for example, D:\). For GDS, you must make sure that the directory is not located at the root of the drive but is located in a subdirectory. For example, the directory should be D:\GDS and not simply D:\.</p>
  </note>
  <h2 id="recovering_the_gds_to_a_clustered_environment">Recovering the GDS to a clustered environment</h2>
  <p></p>
  <draft-comment lastModifiedBy="" prevFirstName="unknown" prevLastName="unknown" type="remark">
   <p>Bug 1721373</p>
  </draft-comment>
  <p>To change the GDS location in a clustered environment, shut down the entire cluster and run the LCSetGDS script on a single node of the cluster. (See <a href="recovering-aem-forms-data#changing_the_gds_location_during_recovery">Changing the GDS location during recovery</a>.) Start only that node. When that node is fully started, other nodes in the cluster may be started safely and will correctly point at the new GDS.</p>
  <note>
   <p>If you cannot ensure starting one node completely before starting other nodes, you must run the LCSetGDS script on every node in the cluster before you start the cluster.</p>
  </note>
 </body>
</html>