<?xml version="1.1" encoding="UTF-8" standalone="yes"?>
<html>
 <head>
  <meta content="help/components/pages/article-3" name="sling:resourceType" />
  <meta content="Configuring Messaging" name="navTitle" />
  <meta content="Configuring Messaging" name="seoTitle" />
  <meta content="2018-05-17T05:54:19.252-0400" name="locHandOffDate" />
  <meta content="/apps/help/templates/article-3" name="cq:template" />
  <meta content="2017-10-12T21:46:58.665-0400" name="mwpw_migration_script_version" />
  <meta content="0a64b0d2-abec-4988-b7b2-fdd825b9c0fb" name="jcr:predecessors" />
  <meta content="2018-05-17T05:54:19.252-0400" name="cq:lastModified" />
  <meta content="en_us" name="jcr:language" />
  <meta content="" name="jcr:baseVersion" />
  <meta content="/content/help/en/experience-manager/6-4/communities/morehelp/administering;/content/help/en/experience-manager/6-4/communities/morehelp/administering" name="moreHelpPaths" />
  <meta content="2017-12-01T19:02:48.128-0500" name="jcr:created" />
  <meta content="products:SG_EXPERIENCEMANAGER/6.4/COMMUNITIES" name="primaryProductTag" />
  <meta content="carlino@adobe.com" name="lr_lastReplicatedBy" />
  <meta content="d50197bb-726e-4e31-9039-22bd5ae9a0e7" name="jcr:uuid" />
  <meta content="false" name="isReadyForLocalization" />
  <meta content="" name="jcr:primaryType" />
  <meta content="2017-10-31T16:33:31.947-0400" name="firstPublishExternalDate" />
  <meta content="2017-10-12T21:46:58.665-0400" name="qaDate" />
  <meta content="2018-04-03T07:48:56.523-0400" name="topicBrowsingSortDate" />
  <meta content="2018-04-03T07:48:56.523-0400" name="lastPublishExternalDate" />
  <meta content="carlino" name="cq:lastModifiedBy" />
  <meta content="Activate" name="cq:lastReplicationAction" />
  <meta content="/etc/designs/help" name="cq:designPath" />
  <meta content="carlino" name="cq:lastReplicatedBy" />
  <meta content="mix:versionable" name="jcr:mixinTypes" />
  <meta content="Communities messaging" name="seoDescription" />
  <meta content="https://helpx.adobe.com/experience-manager/6-4/communities/using/messaging.html" name="publishExternalURL" />
  <meta content="true" name="jcr:isCheckedOut" />
  <meta content="2018-04-03T07:48:56.523-0400" name="publishExternalDate" />
  <meta content="2018-04-03T07:48:57.574-0400" name="cq:lastReplicated" />
  <meta content="products:SG_EXPERIENCEMANAGER/6.4/COMMUNITIES;topic_tags:administering;content_type:reference" name="cq:tags" />
  <meta content="Janice Kendall" name="contentOwner" />
  <meta content="" name="jcr:versionHistory" />
  <meta content="/content/docs/en/aem/6-3/administer/communities/messaging" name="qaNotes" />
  <meta content="Configuring Messaging" name="jcr:title" />
  <meta content="admin" name="jcr:createdBy" />
 </head>
 <body>
  <h2>Overview</h2>
  <p>The messaging feature for AEM Communities provides the ability for signed-in site visitors (members) to send messages to one another that are accessible when signed into the site.</p> 
  <p>Messaging is enabled for a community site by checking a box during <a href="../../communities/using/sites-console.md">community site creation</a>.</p> 
  <p>On this page is information on the default configuration and possible adjustments.</p> 
  <p>For additional information for developers, see <a href="../../communities/using/essentials-messaging.md">Messaging Essentials</a>.</p> 
  <h2>Messaging Operations Service</h2>
  <p>The <a href="http://localhost:4502/system/console/configMgr/com.adobe.cq.social.messaging.client.endpoints.impl.MessagingOperationsServiceImpl">AEM Communities Messaging Operations Service</a> identifies the endpoint which handles messaging related requests, the folders the service should use for storing messages, and if messages may include file attachments, what file types are allowed.</p> 
  <p>For community sites created using the <a href="../../communities/using/sites-console.md">Communities Sites console</a>, an instance of the service already exists, with the inbox set to <span class="code">/mail/community/inbox</span>.</p> 
  <h3>Community Messaging Operations Service</h3>
  <p>As shown below, a configuration of the service exists for sites created with the <a href="../../communities/using/sites-console.md">site creation wizard</a>. The configuration can be viewed or edited by selecting the pencil icon next to the configuration :</p> 
  <img imageRotate="0" src="assets/chlimage_1-63.png" />
  <h3>New Configuration</h3>
  <p>To add a new configuration, select the plus '<strong>+</strong>' icon next to the service's name :</p> 
  <img imageRotate="0" src="assets/chlimage_1-64.png" />
  <ul> 
   <li><strong>Message Fields Whitelist</strong><br /> Specifies the properties of the Compose Message component users can edit and persist. If new form elements are added, then the element id would need to be added if desired to be stored in SRP. Default is two entries : <i>subject</i> and <i>content</i>.</li> 
   <li><strong>message box size limit</strong><br /> The maximum number of bytes in each user's message box. Default is <i>1073741824 </i>(1 GB).</li> 
   <li><strong>message count limit</strong><br /> The total number of messages allowed per user. A value of -1 indicates an unlimited number of messages is allowed, subject to the message box size limit. Default is <i>10000</i> (10k).</li> 
   <li><strong>notify delivery failure</strong><br /> If checked, notify sender if message delivery fails to some recipients. Default is <i>checked</i>.</li> 
   <li><strong>failure delivery sender id</strong><br /> Name of sender which appears in delivery failed message. Default is <i>failureNotifier</i>.</li> 
   <li><strong>failure message template path</strong><br /> Absolute path to the delivery failed message template root. Default is <i>/etc/notification/messaging/default</i>.</li> 
   <li><strong>maxRetries.name</strong><br /> Number of times to try resending message which fails to be delivered. Default is <i>3</i>.</li> 
   <li><strong>minWaitBetweenRetries.name</strong><br /> Number of seconds to wait between attempts to resend message upon failure to send. Default is <i>100 </i>(seconds).</li> 
   <li><strong>count update pool size</strong><br /> Number of concurrent threads used for count update. Default is <i>10</i>.</li> 
   <li><strong>inbox.path.name</strong><br /> (<i>Required</i>) The path, relative to the user's node (/home/users/<i>username</i>), to use for the <strong><span class="code">inbox</span></strong> folder. The path must NOT end with a trailing forward slash '/'. Default is <i>/mail/inbox</i> .</li> 
   <li><strong>sentitems.path.name</strong><br /> (<i>Required</i>) The path, relative to the user's node (/home/users/<i>username</i>), to use for the <strong><span class="code">senditems</span></strong> folder. The path must NOT end with a trailing forward slash '/'. Default is <i>/mail/sentitems</i> .</li> 
   <li><strong>supportAttachments.name</strong><br /> If checked, users are able to add attachments to their messages. Default is <i>checked</i>.</li> 
   <li><strong>batchSize.name</strong><br /> Number of messages to batch together for a send when sending to a large group of recipients. Default is <i>100</i>.</li> 
   <li><strong>maxTotalAttachmentSize.name</strong><br /> If supportAttachments is checked, this value specifies the maximum allowed total size (in bytes) of all attachments. Default is <i>104857600</i> (100 MB).</li> 
   <li><strong>attachmentTypeBlacklist.name</strong><br /> A blacklist of file extensions, prefixed with '<strong>.</strong>', that will be rejected by the system. If not blacklisted, then the extension is allowed. Extensions may be added or removed using the '<strong>+</strong>' and '<strong>-</strong>' icons. Default is <i>DEFAULT</i>.</li> 
   <li><strong>allowedAttachmentTypes.name</strong><br /> <strong>(<i>Action Required</i>)</strong> A whitelist of file extensions, the opposite of the blacklist. To allow all file extensions, except for those blacklisted, use the '<strong>-</strong>' icon to remove the single empty entry.</li> 
   <li><strong>serviceSelector.name</strong><br /> (<i>Required</i>) An absolute path (endpoint) through which the service is invoked (a virtual resource). The root of the path chosen must be one included in the <i>Execution Paths</i> configuration setting of OSGi config <a href="http://localhost:4502/system/console/configMgr/org.apache.sling.servlets.resolver.SlingServletResolver"> <span class="code">Apache Sling Servlet/Script Resolver and Error Handler</span></a>, such as<span class="code"> /bin/</span>, <span class="code">/apps/</span>, and <span class="code">/services/</span>. To select this configuration for a site's messaging feature, this endpoint is provided as the <strong><span class="code">Service selector</span></strong> value for the <span class="code">Message List and Compose Message components</span> (see <a href="../../communities/using/configure-messaging.md">Message Feature</a>).<br /> The default is <i>/bin/messaging</i> .</li> 
   <li><strong>fieldWhitelist.name</strong><br /> Use <strong>Message Fields Whitelist</strong>.</li> 
  </ul> 
  <note>
   <p>Each time a <span class="code">Messaging Operations Service</span> configuration is opened for edit, if <span class="code">allowedAttachmentTypes.name</span> had been removed, an empty entry is re-added to make the property configurable. A single empty entry effectively disables file attachments.</p> 
   <p>To allow all file extensions, except for those blacklisted, use the '<strong>-</strong>' icon to (again) remove the single empty entry before clicking <strong>Save</strong>.</p> 
  </note>
  <h2>Troubleshooting</h2>
  <p>One way to troubleshoot problems is to enable <a href="../../sites/administering/using/troubleshooting.md">debugging messages in the log.</a> </p> 
  <p>See also <a href="../../sites/deploying/using/configure-logging.md#loggersandwritersforindividualservices">Loggers and Writers for Individual Services</a>.</p> 
  <p>The package to monitor is <span class="code">com.adobe.cq.social.messaging</span>. </p> 
 </body>
</html>